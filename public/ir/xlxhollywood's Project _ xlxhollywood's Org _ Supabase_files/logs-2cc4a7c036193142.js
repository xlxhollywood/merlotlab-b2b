!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="a4895358-8c8d-4ff6-94c5-2ab451f06f3e",e._sentryDebugIdIdentifier="sentry-dbid-a4895358-8c8d-4ff6-94c5-2ab451f06f3e")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4986,9857],{3434:(e,t,a)=>{"use strict";a.d(t,{A0:()=>o,BF:()=>i,Gg:()=>d,Hj:()=>c,XI:()=>l,nA:()=>m,nd:()=>u,r6:()=>g});var n=a(80263),s=a(53239),r=a(51500);let l=s.forwardRef((e,t)=>{let{className:a,containerProps:s,...l}=e;return(0,n.jsx)("div",{className:(0,r.cn)("w-full overflow-auto"),...s,children:(0,n.jsx)("table",{ref:t,className:(0,r.cn)("w-full caption-bottom text-sm",a),...l})})});l.displayName="Table";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("thead",{ref:t,className:(0,r.cn)("[&_tr]:border-b",a),...s})});o.displayName="TableHeader";let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("tbody",{ref:t,className:(0,r.cn)("[&_tr:last-child]:border-0",a),...s})});i.displayName="TableBody";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("tfoot",{ref:t,className:(0,r.cn)("bg-primary font-medium text-primary-foreground",a),...s})});d.displayName="TableFooter";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("tr",{ref:t,className:(0,r.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...s})});c.displayName="TableRow";let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("th",{ref:t,className:(0,r.cn)("h-12 px-4 text-left align-middle font-medium text-foreground-muted [&:has([role=checkbox])]:pr-0",a),...s})});u.displayName="TableHead";let m=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("td",{ref:t,className:(0,r.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...s})});m.displayName="TableCell";let g=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)("caption",{ref:t,className:(0,r.cn)("mt-4 text-sm text-foreground-muted",a),...s})});g.displayName="TableCaption"},12150:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/logs",function(){return a(52758)}])},14861:(e,t,a)=>{"use strict";a.d(t,{K:()=>x,T:()=>y});var n=a(80263),s=a(53239),r=a(52647),l=a(51500),o=a(78721),i=a(53434),d=a.n(i),c=a(27344),u=a.n(c),m=a(37361),g=a.n(m);d().extend(u()),d().extend(g());let p=e=>d().unix(Number(e)/1e3/1e3).toISOString(),f=e=>{let t=16===String(e).length;return!Number.isNaN(Number(e))&&t},x=e=>{let{utcTimestamp:t,format:a}=e,n=f(t)?p(t):t;return d().utc(n).local().format(a)},h=e=>{let{utcTimestamp:t,format:a}=e,n=f(t)?p(t):t;return d().utc(n).format(a)},_=e=>{let{utcTimestamp:t}=e,a=f(t)?p(t):t;return d().utc(a).fromNow()},y=e=>{let{utcTimestamp:t,className:a,displayAs:i="local",format:d="DD MMM  HH:mm:ss",labelFormat:c="DD MMM HH:mm:ss"}=e,u=x({utcTimestamp:t,format:d}),m=h({utcTimestamp:t,format:d}),g=_({utcTimestamp:t}),[p,f]=(0,s.useState)("start"),y=(0,s.useRef)(null),v=Intl.DateTimeFormat().resolvedOptions().timeZone;(0,s.useEffect)(()=>{let e=()=>{if(y.current){let e=y.current.getBoundingClientRect(),t=window.innerHeight;f(e.top<t/2?"start":"end")}};return e(),window.addEventListener("scroll",e),window.addEventListener("resize",e),()=>{window.removeEventListener("scroll",e),window.removeEventListener("resize",e)}},[]);let b=e=>{let{label:t,value:a}=e,[o,i]=(0,s.useState)(!1);return(0,n.jsxs)("div",{onPointerDown:e=>{e.stopPropagation()},onMouseDown:e=>{e.stopPropagation()},onClick:e=>{e.stopPropagation(),e.preventDefault(),(0,r.l)(a,()=>{i(!0),setTimeout(()=>{i(!1)},1e3)})},className:(0,l.cn)("relative cursor-pointer flex gap-y-2 gap-x-0.5 hover:bg-surface-100 px-2 py-1 group",{"bg-surface-100":o}),"data-sentry-component":"TooltipRow","data-sentry-source-file":"index.tsx",children:[(0,n.jsxs)("div",{className:"flex items-center gap-x-2 text-left truncate",children:[(0,n.jsx)("p",{children:t}),(0,n.jsx)("div",{className:"border-t w-full border-dashed"})]}),(0,n.jsxs)("div",{className:"relative flex items-center gap-x-2 flex-grow",children:[(0,n.jsx)("div",{className:"border-t w-full border-dashed z-10"}),o&&(0,n.jsx)("span",{className:"flex items-center justify-end w-full absolute inset-0 flex items-right text-brand-600 bg-surface-100",children:"Copied!"}),(0,n.jsx)("span",{className:"flex items-center gap-x-2 justify-end whitespace-nowrap",children:a})]})]})};return(0,n.jsxs)(o.m_,{"data-sentry-element":"Tooltip","data-sentry-component":"TimestampInfo","data-sentry-source-file":"index.tsx",children:[(0,n.jsx)(o.k$,{asChild:!0,ref:y,className:"text-xs ".concat(a," border-b border-transparent hover:border-dashed hover:border-foreground-light"),"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"index.tsx",children:(0,n.jsx)("span",{children:"local"===i?x({utcTimestamp:t,format:c}):h({utcTimestamp:t,format:c})})}),(0,n.jsxs)(o.ZI,{align:p,side:"right",className:"font-mono p-0 py-1 min-w-80","data-sentry-element":"TooltipContent","data-sentry-source-file":"index.tsx",children:[(0,n.jsx)(b,{label:"UTC",value:m,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(b,{label:v,value:u,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(b,{label:"Relative",value:g,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(b,{label:"Timestamp",value:String(t),"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"})]})]})}},17904:(e,t,a)=>{"use strict";a.d(t,{$m:()=>c,As:()=>d,nD:()=>i,ub:()=>u});var n=a(80263),s=a(69751),r=a(72259),l=a(53239),o=a(51500);let i=s.bL,d=l.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(s.q7,{ref:t,className:(0,o.cn)("border-b",a),...r})});d.displayName="AccordionItem";let c=l.forwardRef((e,t)=>{let{className:a,children:l,hideIcon:i,...d}=e;return(0,n.jsx)(s.Y9,{className:"flex",children:(0,n.jsxs)(s.l9,{ref:t,className:(0,o.cn)("flex flex-1 gap-2 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180 text-left",a),...d,children:[l,!i&&(0,n.jsx)(r.A,{className:"h-4 w-4 transition-transform duration-200 shrink-0"})]})})});c.displayName=s.l9.displayName;let u=l.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,n.jsx)(s.UC,{ref:t,className:(0,o.cn)("overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",a),...l,children:(0,n.jsx)("div",{className:"pb-4 pt-0",children:r})})});u.displayName=s.UC.displayName},31808:(e,t,a)=>{"use strict";a.d(t,{N:()=>n});var n=function(e){return e.API="api",e.STORAGE="storage",e.AUTH="auth",e.QUERY_PERFORMANCE="query_performance",e.DATABASE="database",e}({})},38069:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var n=a(80263),s=a(15601),r=a.n(s),l=a(23385),o=a(67120),i=a(40022),d=a(58946);let c=e=>{let{show:t,setShowUpgradePrompt:a,title:s="Log retention",description:c="Logs can be retained up to a duration of 3 months depending on the plan that your project is on.",source:u="logsRetentionUpgradePrompt"}=e,m=(0,l.a)();return(0,n.jsxs)(o.A,{hideFooter:!0,visible:t,size:"medium",header:s,onCancel:()=>a(!1),"data-sentry-element":"Modal","data-sentry-component":"UpgradePrompt","data-sentry-source-file":"UpgradePrompt.tsx",children:[(0,n.jsx)(o.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"UpgradePrompt.tsx",children:(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("p",{className:"text-sm",children:c}),(0,n.jsxs)("div",{className:"border-control bg-surface-300 rounded border",children:[(0,n.jsxs)("div",{className:"flex items-center px-4 pt-2 pb-1",children:[(0,n.jsx)("p",{className:"text-foreground-light w-[40%] text-sm",children:"Plan"}),(0,n.jsx)("p",{className:"text-foreground-light w-[60%] text-sm",children:"Retention duration"})]}),(0,n.jsxs)("div",{className:"py-1",children:[(0,n.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,n.jsx)("p",{className:"w-[40%] text-sm",children:"Free"}),(0,n.jsx)("p",{className:"w-[60%] text-sm",children:d.rU.FREE.text})]}),(0,n.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,n.jsx)("p",{className:"w-[40%] text-sm",children:"Pro"}),(0,n.jsx)("p",{className:"w-[60%] text-sm",children:d.rU.PRO.text})]}),(0,n.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,n.jsx)("p",{className:"w-[40%] text-sm",children:"Team"}),(0,n.jsx)("p",{className:"w-[60%] text-sm",children:d.rU.TEAM.text})]}),(0,n.jsxs)("div",{className:"flex items-center px-4 py-1",children:[(0,n.jsx)("p",{className:"w-[40%] text-sm",children:"Enterprise"}),(0,n.jsx)("p",{className:"w-[60%] text-sm",children:d.rU.ENTERPRISE.text})]})]})]})]})}),(0,n.jsx)(o.A.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"UpgradePrompt.tsx"}),(0,n.jsxs)(o.A.Content,{className:"flex justify-end gap-3","data-sentry-element":"unknown","data-sentry-source-file":"UpgradePrompt.tsx",children:[(0,n.jsx)(i.$,{type:"default",onClick:()=>a(!1),"data-sentry-element":"Button","data-sentry-source-file":"UpgradePrompt.tsx",children:"Close"}),(0,n.jsx)(i.$,{asChild:!0,size:"tiny","data-sentry-element":"Button","data-sentry-source-file":"UpgradePrompt.tsx",children:(0,n.jsx)(r(),{href:"/org/".concat(null==m?void 0:m.slug,"/billing?panel=subscriptionPlan&source=").concat(u),"data-sentry-element":"Link","data-sentry-source-file":"UpgradePrompt.tsx",children:"Upgrade"})})]})]})}},52758:(e,t,a)=>{"use strict";a.r(t),a.d(t,{LogPage:()=>nH,default:()=>nP});var n=a(80263),s=a(24400),r=a(53239),l=a(90478),o=a(72035),i=a(15095),d=a(48172),c=a(32466),u=a(66309),m=a(4395),g=a(7286);function p(e){return e>=100&&e<1e3?e.toString():e>=1e3&&e<1e6?(e/1e3).toFixed(1)+"k":e>=1e6?(e/1e6).toFixed(1)+"M":e.toString()}function f(e){return!!Array.isArray(e)&&e.every(e=>e instanceof Date)}let x=(e,t,a)=>{let n=new Date(e.getValue(t)),[s,r]=a;return!isNaN(n.getTime())&&(r?(0,m.default)(n,s)&&(0,g.default)(n,r):(0,u.default)(n,s))};x.autoRemove=e=>!Array.isArray(e)||!e.length||!f(e);let h=(e,t,a)=>!!Array.isArray(a)&&a.some(a=>e.getValue(t)===a);function _(e){switch(e){case"success":return{text:"text-muted",bg:"bg-muted",border:"border-muted"};case"warning":return{text:"text-warning",bg:"bg-warning",border:"border-warning"};case"error":return{text:"text-destructive",bg:"bg-destructive",border:"border-destructive"};default:return{text:"text-info",bg:"bg-info",border:"border-info"}}}h.autoRemove=e=>!Array.isArray(e)||!(null==e?void 0:e.length);var y=a(62414),v=a(28881),b=a(75189),j=a(25643),N=a(65303),w=a(51500),E=a(61965),S=a(77635);let D=(0,w.cn)("select-none rounded border px-1.5 py-px font-mono text-[0.7rem] font-normal font-mono shadow-sm disabled:opacity-50","bg-background text-foreground"),T=(0,r.forwardRef)((e,t)=>{let{children:a,className:s,...r}=e;return(0,n.jsx)("kbd",{className:(0,w.cn)(D,s),ref:t,...r,children:a})});T.displayName="Kbd";let C=(0,r.createContext)(null);function k(e){let{children:t}=e,[a,s]=(0,N.M)("data-table-controls",!0);return(0,n.jsx)(C.Provider,{value:{open:a,setOpen:s},"data-sentry-element":"unknown","data-sentry-component":"ControlsProvider","data-sentry-source-file":"ControlsProvider.tsx",children:(0,n.jsx)("div",{className:"group/controls h-full","data-expanded":a,children:t})})}let A=(0,r.createContext)(null);function L(e){let{children:t,...a}=e,s=(0,r.useMemo)(()=>{var e,t,n,s,r,l,o,i;return{...a,columnFilters:null!=(e=a.columnFilters)?e:[],sorting:null!=(t=a.sorting)?t:[],rowSelection:null!=(n=a.rowSelection)?n:{},columnOrder:null!=(s=a.columnOrder)?s:[],columnVisibility:null!=(r=a.columnVisibility)?r:{},pagination:null!=(l=a.pagination)?l:{pageIndex:0,pageSize:10},enableColumnOrdering:null!=(o=a.enableColumnOrdering)&&o,searchParameters:null!=(i=a.searchParameters)?i:{}}},[a]);return(0,n.jsx)(A.Provider,{value:s,"data-sentry-element":"unknown","data-sentry-component":"DataTableProvider","data-sentry-source-file":"DataTableProvider.tsx",children:(0,n.jsx)(k,{"data-sentry-element":"ControlsProvider","data-sentry-source-file":"DataTableProvider.tsx",children:t})})}function I(){let e=(0,r.useContext)(A);if(!e)throw Error("useDataTable must be used within a DataTableProvider");return e}var R=a(94240),F=a(41787),q=a(99157),H=a(94387);let P=["success","warning","error"];function O(e){return null!=e}function V(e){let{searchParamsParser:t,placeholder:a="Search data table..."}=e,{table:s,isLoading:l,filterFields:o,getFacetedUniqueValues:i}=I(),d=s.getState().columnFilters,c=(0,r.useRef)(null),[u,m]=(0,r.useState)(!1),[g,f]=(0,r.useState)(""),x=(0,r.useMemo)(()=>null==o?void 0:o.filter(e=>!e.commandDisabled),[o]),h=(0,r.useMemo)(()=>(function(e){let{searchParamsParser:t,filterFields:a}=e;return{parse:e=>{let a,n={},s=/(\w+):([^]*?)(?=\s+\w+:|$)/g;for(;null!==(a=s.exec(e));){let[e,t,s]=a;t&&s&&(n[t]=s.trim())}return Object.entries(n).reduce((e,a)=>{let[n,s]=a,r=t[n];return r&&(e[n]=r.parse(s)),e},{})},serialize:e=>e.reduce((e,n)=>{let{commandDisabled:s}=(null==a?void 0:a.find(e=>n.id===e.value))||{commandDisabled:!0},r=t[n.id];return s||!r?e:"".concat(e).concat(n.id,":").concat(r.serialize(n.value)," ")},"")}})({searchParamsParser:t,filterFields:x}),[t,x]),[_,D]=(0,r.useState)(h.serialize(d)),[C,k]=(0,N.M)("data-table-command",[]),A=_.trim(),L=x.filter(e=>"string"==typeof e.value&&g.includes("".concat(e.value,":")));return(0,r.useEffect)(()=>{var e,t;if(""!==g&&u||(""===g||u||f(""),""===A&&!u))return;let a=h.parse(_),n=s.getState().columnFilters.filter(e=>{let t=null==o?void 0:o.find(t=>t.value===e.id);return!(null==t?void 0:t.commandDisabled)});for(let t of Object.keys(a)){let n=a[t];null==(e=s.getColumn(t))||e.setFilterValue(n)}for(let e of n.filter(e=>!(e.id in a)))null==(t=s.getColumn(e.id))||t.setFilterValue(void 0)},[_,u,g]),(0,r.useEffect)(()=>{u||D(h.serialize(d))},[d,x,u]),(0,r.useEffect)(()=>{if(u){var e;null==c||null==(e=c.current)||e.focus()}},[u]),(0,n.jsxs)("div",{"data-sentry-component":"DataTableFilterCommand","data-sentry-source-file":"DataTableFilterCommand.tsx",children:[(0,n.jsxs)("button",{type:"button",className:(0,w.cn)("group flex w-full items-center rounded-lg border border-input bg-background px-3 text-muted-foreground ring-offset-background focus-within:outline-none focus-within:ring-2 focus-within:ring-ring focus-within:ring-offset-2 hover:bg-accent/50 hover:text-accent-foreground",u?"hidden":"visible"),onClick:()=>m(!0),children:[l?(0,n.jsx)(v.A,{className:"mr-2 h-4 w-4 shrink-0 animate-spin text-muted-foreground opacity-50 group-hover:text-popover-foreground"}):(0,n.jsx)(b.A,{className:"mr-2 h-4 w-4 shrink-0 text-muted-foreground opacity-50 group-hover:text-popover-foreground"}),(0,n.jsx)("span",{className:(0,w.cn)("h-9 w-full max-w-sm truncate py-3 text-left text-sm outline-none disabled:cursor-not-allowed disabled:opacity-50","flex items-center md:max-w-xl lg:max-w-4xl xl:max-w-5xl",A?"text-foreground":"text-foreground-light"),children:A?_:a})]}),(0,n.jsxs)(E.uB,{className:(0,w.cn)("overflow-visible rounded-lg border border-border shadow-md [&>div]:border-none bg",u?"visible":"hidden"),filter:(e,t,a)=>(function(e){let{value:t,search:a,currentWord:n}=e;if(t.startsWith("suggestion:"))return+!!t.toLowerCase().replace("suggestion:","").includes(a);if(t.toLowerCase().includes(n.toLowerCase()))return 1;let[s,r]=n.toLowerCase().split(":");if(r&&t.startsWith("".concat(s,":"))){if(r.includes(",")){let e=r.split(","),a=t.toLowerCase().replace("".concat(s,":"),"");if(e.some((t,n)=>t===a&&n!==e.length-1))return 0;if(e.some(e=>a.includes(e)))return 1}if(r.includes("-")){let e=r.split("-"),a=t.toLowerCase().replace("".concat(s,":"),""),n=Number.parseInt(a);return Number.parseInt(e[0])<n&&a.includes(e[1])?1:0}if(t.toLowerCase().replace("".concat(s,":"),"").includes(r))return 1}return 0})({value:e,search:t,keywords:a,currentWord:g}),onKeyDown:e=>{("ArrowUp"===e.key||"ArrowDown"===e.key)&&e.stopPropagation()},"data-sentry-element":"Command","data-sentry-source-file":"DataTableFilterCommand.tsx",children:[(0,n.jsx)(E.G7,{ref:c,value:_,onValueChange:D,onKeyDown:e=>{var t;"Escape"===e.key&&(null==c||null==(t=c.current)||t.blur())},onBlur:()=>{m(!1);let e=_.trim();if(!e)return;let t=Date.now(),a=C.findIndex(t=>t.search===e);if(-1!==a){C[a].timestamp=t,k(C);return}k([...C,{search:e,timestamp:t}])},onInput:e=>{var t,a;let n=(null==(t=e.currentTarget)?void 0:t.selectionStart)||-1;f(function(e){let{value:t,caretPosition:a}=e,n=a,s=a;for(;n>0&&" "!==t[n-1];)n--;for(;s<t.length&&" "!==t[s];)s++;return t.substring(n,s)}({value:(null==(a=e.currentTarget)?void 0:a.value)||"",caretPosition:n}))},placeholder:a,className:"text-foreground","data-sentry-element":"CommandInput","data-sentry-source-file":"DataTableFilterCommand.tsx"}),(0,n.jsx)("div",{className:"relative",children:(0,n.jsxs)("div",{className:"absolute top-2 z-50 w-full overflow-hidden rounded-lg border border-border bg-popover text-popover-foreground shadow-md outline-none animate-in",children:[(0,n.jsxs)(E.oI,{className:"max-h-[310px] bg-surface-100","data-sentry-element":"CommandList","data-sentry-source-file":"DataTableFilterCommand.tsx",children:[(0,n.jsx)(E.xL,{"data-sentry-element":"CommandEmpty","data-sentry-source-file":"DataTableFilterCommand.tsx",children:"No results found."}),(0,n.jsx)(E.L$,{heading:"Filter","data-sentry-element":"CommandGroup","data-sentry-source-file":"DataTableFilterCommand.tsx",children:x.map(e=>"string"!=typeof e.value||_.includes("".concat(e.value,":"))?null:(0,n.jsxs)(E.h_,{value:e.value,onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onSelect:e=>{D(t=>{if(""===g.trim()){let a="".concat(t).concat(e);return"".concat(a,":")}let a=g===t?"":" ",n=t.replace("".concat(a).concat(g),"".concat(a).concat(e));return"".concat(n,":")}),f("".concat(e,":"))},className:"group",children:[e.label,(0,n.jsx)(M,{field:e})]},e.value))}),(0,n.jsx)(E.fx,{"data-sentry-element":"CommandSeparator","data-sentry-source-file":"DataTableFilterCommand.tsx"}),L.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(E.L$,{heading:"Query",children:L.map(e=>{let t=s.getColumn(e.value),a=(null==i?void 0:i(s,e.value))||(null==t?void 0:t.getFacetedUniqueValues());return(function(e){var t,a;let{field:n}=e;return"slider"===n.type?(null==(t=n.options)?void 0:t.length)?n.options.map(e=>{let{value:t}=e;return t}).sort((e,t)=>Number(e)-Number(t)).filter(O):Array.from({length:n.max-n.min+1},(e,t)=>n.min+t)||[]:(null==(a=n.options)?void 0:a.map(e=>{let{value:t}=e;return t}).filter(O))||[]})({field:e}).map(t=>(0,n.jsxs)(E.h_,{value:"".concat(String(e.value),":").concat(t),onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onSelect:a=>{D(n=>(function(e){let{prev:t,currentWord:a,optionValue:n,value:s,field:r}=e;switch(r.type){case"checkbox":if(a.includes(",")){let e=a.split(",");e[e.length-1]="".concat(n);let s=t.replace(a,e.join(","));return"".concat(s.trim()," ")}case"slider":if(a.includes("-")){let e=a.split("-");e[e.length-1]="".concat(n);let s=t.replace(a,e.join("-"));return"".concat(s.trim()," ")}case"timerange":if(a.includes("-")){let e=a.split("-");e[e.length-1]="".concat(n);let s=t.replace(a,e.join("-"));return"".concat(s.trim()," ")}default:{let e=t.replace(a,s);return"".concat(e.trim()," ")}}})({prev:n,currentWord:g,optionValue:t,value:a,field:e})),f("")},children:["".concat(t),(null==a?void 0:a.has(t))?(0,n.jsx)("span",{className:"ml-auto font-mono text-muted-foreground",children:p(a.get(t)||0)}):null]},"".concat(String(e.value),":").concat(t)))})}),(0,n.jsx)(E.fx,{})]}),C.length>0&&(0,n.jsx)(E.L$,{heading:"Suggestions",children:C.sort((e,t)=>t.timestamp-e.timestamp).slice(0,5).map(e=>(0,n.jsxs)(E.h_,{value:"suggestion:".concat(e.search),onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onSelect:e=>{let t=e.replace("suggestion:","");D("".concat(t," ")),f("")},className:"group",children:[e.search,(0,n.jsx)("span",{className:"ml-auto truncate text-muted-foreground/80 group-aria-[selected=true]:block",children:(0,y.A)(e.timestamp,{addSuffix:!0})}),(0,n.jsx)("button",{type:"button",onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onClick:t=>{t.preventDefault(),t.stopPropagation(),k(C.filter(t=>t.search!==e.search))},className:"ml-1 hidden rounded-md p-0.5 hover:bg-background group-aria-[selected=true]:block",children:(0,n.jsx)(j.A,{className:"h-4 w-4"})})]},"suggestion:".concat(e.search)))})]}),(0,n.jsxs)("div",{className:"bg-surface-100 flex flex-wrap justify-between gap-3 border-t bg-accent/50 px-2 py-1.5 text-sm text-accent-foreground",children:[(0,n.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,n.jsxs)("span",{children:["Use ",(0,n.jsx)(T,{"data-sentry-element":"Kbd","data-sentry-source-file":"DataTableFilterCommand.tsx",children:"↑"})," ",(0,n.jsx)(T,{"data-sentry-element":"Kbd","data-sentry-source-file":"DataTableFilterCommand.tsx",children:"↓"})," to navigate"]}),(0,n.jsxs)("span",{children:[(0,n.jsx)(T,{"data-sentry-element":"Kbd","data-sentry-source-file":"DataTableFilterCommand.tsx",children:"Enter"})," to query"]}),(0,n.jsxs)("span",{children:[(0,n.jsx)(T,{"data-sentry-element":"Kbd","data-sentry-source-file":"DataTableFilterCommand.tsx",children:"Esc"})," to close"]}),(0,n.jsx)(S.w,{orientation:"vertical",className:"my-auto h-3","data-sentry-element":"Separator","data-sentry-source-file":"DataTableFilterCommand.tsx"}),(0,n.jsxs)("span",{children:["Union: ",(0,n.jsx)(T,{"data-sentry-element":"Kbd","data-sentry-source-file":"DataTableFilterCommand.tsx",children:"regions:a,b"})]}),(0,n.jsxs)("span",{children:["Range: ",(0,n.jsx)(T,{"data-sentry-element":"Kbd","data-sentry-source-file":"DataTableFilterCommand.tsx",children:"p95:59-340"})]})]}),C.length?(0,n.jsx)("button",{type:"button",className:"text-muted-foreground hover:text-accent-foreground",onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onClick:()=>k([]),children:"Clear suggestions"}):null]})]})})]})]})}function M(e){let{field:t}=e,{table:a,getFacetedMinMaxValues:s,getFacetedUniqueValues:r}=I(),l=t.value,o="ml-2 hidden truncate text-foreground-lighter group-aria-[selected=true]:block";switch(t.type){case"checkbox":var i,d;return(0,n.jsx)("span",{className:(0,w.cn)(o),children:r?Array.from((null==(i=r(a,l))?void 0:i.keys())||[]).map(e=>"[".concat(e,"]")).join(" "):null==(d=t.options)?void 0:d.map(e=>{let{value:t}=e;return"[".concat(t,"]")}).join(" ")});case"slider":{let[e,r]=(null==s?void 0:s(a,l))||[t.min,t.max];return(0,n.jsxs)("span",{className:(0,w.cn)(o),children:["[",e," - ",r,"]"]})}case"input":return(0,n.jsxs)("span",{className:(0,w.cn)(o),children:["[","".concat(String(t.value))," input]"]});default:return null}}(0,R.default)(new Date),(0,F.default)(new Date),(0,R.default)((0,q.default)(new Date,-1)),(0,F.default)((0,q.default)(new Date,-1)),(0,H.default)(new Date,-1),(0,R.default)((0,q.default)(new Date,-7)),(0,F.default)(new Date),(0,R.default)((0,q.default)(new Date,-14)),(0,F.default)(new Date),(0,R.default)((0,q.default)(new Date,-30)),(0,F.default)(new Date);let z=(0,r.forwardRef)((e,t)=>{let{setTopBarHeight:a,...s}=e,l=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let e=new ResizeObserver(()=>{var e;let t=null==(e=l.current)?void 0:e.getBoundingClientRect();t&&a(t.height)}),t=l.current;if(t)return e.observe(t),()=>e.unobserve(t)},[l]),(0,n.jsx)("div",{ref:l,className:(0,w.cn)("flex flex-col gap-4 bg-background p-2","top-0 z-10 pb-4"),...s})});function W(e,t){(0,r.useEffect)(()=>{function a(a){a.key===t&&(a.metaKey||a.ctrlKey)&&e()}return window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}},[t])}z.displayName="DataTableHeaderLayout";var B=a(40022),U=a(3434);let G=(0,r.forwardRef)((e,t)=>{let{className:a,onScroll:s,...r}=e;return(0,n.jsx)(U.XI,{ref:t,...r,className:(0,w.cn)(a),containerProps:{onScroll:s,className:"h-full w-full overflow-auto table-fixed min-w-max caption-bottom text-sm"}})});G.displayName="Table";let K=(0,r.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(U.A0,{ref:t,className:(0,w.cn)("sticky top-0 z-[1]",a),...s})});K.displayName="TableHeader";let Y=(0,r.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(U.BF,{ref:t,...s,className:(0,w.cn)("outline-1 -outline-offset-1 outline-primary transition-colors focus-visible:outline")})});Y.displayName="TableBody",(0,r.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(U.Gg,{ref:t,className:(0,w.cn)("text-primary-foreground",a),...s})}).displayName="TableFooter";let $=(0,r.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(U.Hj,{ref:t,className:(0,w.cn)("bg-background hover:bg-surface-100 border-b-0",a),...s})});$.displayName="TableRow";let Q=(0,r.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(U.nd,{ref:t,className:(0,w.cn)("!text-xs !font-normal text-foreground-lighter font-mono","relative select-none truncate [&>.cursor-col-resize]:last:opacity-0","text-muted-foreground h-8 px-2 text-left align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...s})});Q.displayName="TableHead";let J=(0,r.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(U.nA,{ref:t,className:(0,w.cn)("text-xs !py-1 p-2 [&>[role=checkbox]]:translate-y-[2px] truncate",a),...s})});function X(e){var t;let{columns:a,defaultColumnVisibility:s={},fetchNextPage:l,hasNextPage:o,totalRows:d=0,filterRows:c=0,totalRowsFetched:u=0,renderLiveRow:m,setColumnOrder:g,setColumnVisibility:f,searchParamsParser:x}=e,{table:h,isLoading:_,isFetching:y}=I(),b=(0,r.useRef)(null),j=h.getHeaderGroups()[0].headers,N=null!=(t=h.getRowModel().rows)?t:[],E=(0,r.useCallback)(e=>{Math.ceil(e.currentTarget.scrollTop+e.currentTarget.clientHeight)>=e.currentTarget.scrollHeight&&!y&&d>u&&l()},[l,y,d,u]);return W(()=>{g([]),f(s)},"u"),(0,n.jsxs)(G,{ref:b,onScroll:E,"data-sentry-element":"Table","data-sentry-component":"DataTableInfinite","data-sentry-source-file":"DataTableInfinite.tsx",children:[(0,n.jsx)(K,{"data-sentry-element":"TableHeader","data-sentry-source-file":"DataTableInfinite.tsx",children:(0,n.jsx)($,{className:"bg-surface-75","data-sentry-element":"TableRow","data-sentry-source-file":"DataTableInfinite.tsx",children:j.map(e=>{var t;let a=e.column.getIsSorted(),s=e.column.getCanResize(),r=e.getResizeHandler(),l=null==(t=e.column.columnDef.meta)?void 0:t.headerClassName;return(0,n.jsxs)(Q,{className:l,"aria-sort":"asc"===a?"ascending":"desc"===a?"descending":"none",children:[e.isPlaceholder?null:(0,i.Kv)(e.column.columnDef.header,e.getContext()),s&&(0,n.jsx)("div",{onDoubleClick:()=>e.column.resetSize(),onMouseDown:r,onTouchStart:r,className:(0,w.cn)("user-select-none absolute -right-2 top-0 z-10 flex h-full w-4 cursor-col-resize touch-none justify-center","before:absolute before:inset-y-0 before:w-px before:translate-x-px before:bg-border")})]},e.id)})})}),(0,n.jsxs)(Y,{id:"content",tabIndex:-1,style:{scrollMarginTop:"calc(var(--top-bar-height))"},"data-sentry-element":"TableBody","data-sentry-source-file":"DataTableInfinite.tsx",children:[N.length?N.map(e=>(0,n.jsxs)(r.Fragment,{children:[null==m?void 0:m({row:e}),(0,n.jsx)(Z,{row:e,table:h,searchParamsParser:x,selected:e.getIsSelected()})]},e.id)):(0,n.jsxs)(r.Fragment,{children:[null==m?void 0:m(),(0,n.jsx)($,{children:(0,n.jsx)(J,{colSpan:a.length,className:"h-[32vh] text-center",children:(0,n.jsx)("div",{className:"flex flex-col items-center justify-center h-full gap-3",children:_?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.A,{className:"h-6 w-6 animate-spin text-foreground-muted"}),(0,n.jsx)("p",{className:"text-foreground-light text-sm",children:"Retrieving logs..."})]}):(0,n.jsx)("p",{className:"text-foreground-light text-sm",children:"No results found"})})})})]}),(N.length>0||!_&&!N.length)&&(0,n.jsx)($,{className:"hover:bg-transparent data-[state=selected]:bg-transparent",children:(0,n.jsx)(J,{colSpan:a.length,className:"text-center !py-2",children:o||y?(0,n.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,n.jsx)(B.$,{disabled:y,onClick:()=>l(),size:"small",type:"outline",icon:y?(0,n.jsx)(v.A,{className:"mr-2 h-4 w-4 animate-spin"}):null,children:"Load more"}),(0,n.jsxs)("p",{className:"text-xs text-foreground-lighter",children:["Showing"," ",(0,n.jsx)("span",{className:"font-mono font-medium",children:p(u)})," ","of"," ",(0,n.jsx)("span",{className:"font-mono font-medium",children:p(d)})," ","rows"]})]}):(0,n.jsxs)("p",{className:"text-xs text-foreground-lighter",children:["No more data to load (",(0,n.jsx)("span",{className:"font-mono font-medium",children:p(c)})," ","of ",(0,n.jsx)("span",{className:"font-mono font-medium",children:p(d)})," ","rows)"]})})})]})]})}function Z(e){var t,a;let{row:s,table:r,selected:l,searchParamsParser:o}=e;(0,c.ZA)("live",o.live);let d=null==(a=r.options.meta)||null==(t=a.getRowClassName)?void 0:t.call(a,s),u=s.getVisibleCells();return(0,n.jsx)($,{id:s.id,tabIndex:0,"data-state":l&&"selected",onClick:()=>s.toggleSelected(),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),s.toggleSelected())},className:(0,w.cn)(d),"data-sentry-element":"TableRow","data-sentry-component":"DataTableRow","data-sentry-source-file":"DataTableInfinite.tsx",children:u.map(e=>{var t;let a=null==(t=e.column.columnDef.meta)?void 0:t.cellClassName;return(0,n.jsx)(J,{className:(0,w.cn)(a),children:(0,i.Kv)(e.column.columnDef.cell,e.getContext())},e.id)})})}function ee(e){let{children:t,className:a,topBarHeight:s=0}=e,{table:l}=I(),o=(0,r.useMemo)(()=>{let e=l.getFlatHeaders(),t={};for(let a=0;a<e.length;a++){let n=e[a];t["--header-".concat(n.id.replace(".","-"),"-size")]="".concat(n.getSize(),"px"),t["--col-".concat(n.column.id.replace(".","-"),"-size")]="".concat(n.column.getSize(),"px")}return t},[l.getState().columnSizingInfo,l.getState().columnSizing,l.getState().columnVisibility]);return(0,n.jsx)("div",{className:(0,w.cn)("flex flex-row w-full h-full",a),style:{"--top-bar-height":"".concat(s+64,"px"),...o},"data-sentry-component":"DataTableSideBarLayout","data-sentry-source-file":"DataTableSideBarLayout.tsx",children:t})}J.displayName="TableCell",(0,r.forwardRef)((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(U.r6,{ref:t,className:(0,w.cn)("text-sm",a),...s})}).displayName="TableCaption";var et=a(83124),ea=a(16592),en=a(78721),es=a(43813),er=a(51935),el=a(16147);let eo=e=>{let{shouldScaleBackground:t=!0,...a}=e;return(0,n.jsx)(el._.Root,{shouldScaleBackground:t,...a,"data-sentry-element":"unknown","data-sentry-component":"Drawer","data-sentry-source-file":"drawer.tsx"})};eo.displayName="Drawer";let ei=el._.Trigger,ed=el._.Portal,ec=el._.Close,eu=r.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(el._.Overlay,{ref:t,className:(0,w.cn)("fixed inset-0 z-50 bg-black/80",a),...s})});eu.displayName=el._.Overlay.displayName;let em=r.forwardRef((e,t)=>{let{className:a,children:s,showHandle:r=!0,...l}=e;return(0,n.jsxs)(ed,{children:[(0,n.jsx)(eu,{}),(0,n.jsxs)(el._.Content,{ref:t,className:(0,w.cn)("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",!r&&"pt-4",a),...l,children:[r&&(0,n.jsx)("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),s]})]})});em.displayName="DrawerContent";let eg=e=>{let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,w.cn)("grid gap-1.5 p-4 text-center sm:text-left",t),...a,"data-sentry-component":"DrawerHeader","data-sentry-source-file":"drawer.tsx"})};eg.displayName="DrawerHeader";let ep=e=>{let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,w.cn)("mt-auto flex flex-col gap-2 p-4",t),...a,"data-sentry-component":"DrawerFooter","data-sentry-source-file":"drawer.tsx"})};ep.displayName="DrawerFooter";let ef=r.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(el._.Title,{ref:t,className:(0,w.cn)("text-lg font-semibold leading-none tracking-tight",a),...s})});ef.displayName=el._.Title.displayName;let ex=r.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,n.jsx)(el._.Description,{ref:t,className:(0,w.cn)("text-sm text-muted-foreground",a),...s})});ex.displayName=el._.Description.displayName;var eh=a(17904),e_=a(74245),ey=a(19428),ev=a(53555);let eb=(0,r.forwardRef)((e,t)=>{let{leading:a,trailing:s,containerClassName:r,className:l,...o}=e;return(0,n.jsxs)("div",{className:(0,w.cn)("group border-input ring-offset-background flex h-10 w-full rounded border bg-transparent text-sm overflow-hidden","focus-within:ring-ring focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2",r),children:[a?(0,n.jsx)("div",{className:"border-input px-2 flex items-center justify-center",children:a}):null,(0,n.jsx)("input",{className:(0,w.cn)("bg-transparent w-full px-0 py-2 focus:outline-none border-0 placeholder:text-foreground-lighter ","disabled:cursor-not-allowed disabled:opacity-50 text-[0.75rem]",l),ref:t,...o}),s?(0,n.jsx)("div",{className:"border-input bg-muted/50 border-l px-3 py-2 flex items-center justify-center",children:s}):null]})});eb.displayName="InputWithAddons";let ej=()=>(0,n.jsx)("div",{className:"grid divide-y rounded border border-border","data-sentry-component":"DataTableFilterCheckboxLoader","data-sentry-source-file":"DataTableFilterCheckboxLoader.tsx",children:Array.from({length:3}).map((e,t)=>(0,n.jsxs)("div",{className:"flex items-center justify-between gap-2 px-2 py-2.5",children:[(0,n.jsx)(ev.E,{className:"h-4 w-4 rounded-sm"}),(0,n.jsx)(ev.E,{className:"h-4 w-full rounded-sm"})]},t))});function eN(e){var t;let{value:a,options:s,component:l}=e,[o,i]=(0,r.useState)(""),{table:d,columnFilters:c,isLoading:u,isLoadingCounts:m,getFacetedUniqueValues:g}=I(),f=d.getColumn(a),x=null==(t=c.find(e=>e.id===a))?void 0:t.value,h=(null==g?void 0:g(d,a))||(null==f?void 0:f.getFacetedUniqueValues()),_=(null==s?void 0:s.filter(e=>""===o||e.label.toLowerCase().includes(o.toLowerCase())))||[],y=x?Array.isArray(x)?x:[x]:[];return!u||(null==_?void 0:_.length)?(null==s?void 0:s.length)?(0,n.jsxs)("div",{className:"grid gap-2","data-sentry-component":"DataTableFilterCheckbox","data-sentry-source-file":"DataTableFilterCheckbox.tsx",children:[s&&s.length>4?(0,n.jsx)(eb,{placeholder:"Search",leading:(0,n.jsx)(b.A,{size:14,className:"text-foreground-lighter"}),containerClassName:"h-8 rounded",value:o,onChange:e=>i(e.target.value)}):null,(0,n.jsx)("div",{className:"max-h-[200px] overflow-y-auto rounded border border-border empty:border-none",children:0===_.length&&""!==o?(0,n.jsx)("div",{className:"flex items-center justify-center px-2 py-4 text-center",children:(0,n.jsxs)("div",{className:"space-y-0.5",children:[(0,n.jsx)("p",{className:"text-xs text-foreground",children:"No results found"}),(0,n.jsx)("p",{className:"text-xs text-foreground-lighter",children:"Try a different search term"})]})}):_.map((e,t)=>{let s=y.includes(e.value);return(0,n.jsxs)("div",{className:(0,w.cn)("group relative flex items-center space-x-2 px-2 py-2 hover:bg-accent/50",t!==_.length-1?"border-b":void 0),children:[(0,n.jsx)(e_.S,{id:"".concat(a,"-").concat(e.value),checked:s,onCheckedChange:t=>{let a=t?[...y||[],e.value]:null==y?void 0:y.filter(t=>e.value!==t);null==f||f.setFilterValue((null==a?void 0:a.length)?a:void 0)}}),(0,n.jsxs)(ey.J,{htmlFor:"".concat(a,"-").concat(e.value),className:"flex w-full items-center justify-between gap-2 text-foreground/70 group-hover:text-accent-foreground text-[0.8rem] min-w-0",children:[(0,n.jsx)("div",{className:"flex-1 min-w-0 overflow-hidden",children:l?(0,n.jsx)(l,{...e}):(0,n.jsx)("span",{className:"truncate font-normal block",children:e.label})}),(0,n.jsx)("span",{className:"flex-shrink-0 flex items-center justify-center font-mono text-xs",children:m?(0,n.jsx)(ev.E,{className:"h-4 w-4"}):(null==h?void 0:h.has(e.value))?p(h.get(e.value)||0):["log_type","method","level"].includes(a)?"0":null}),(0,n.jsx)("button",{type:"button",onClick:()=>null==f?void 0:f.setFilterValue([e.value]),className:(0,w.cn)("absolute inset-y-0 right-0 hidden font-normal text-muted-foreground backdrop-blur-sm hover:text-foreground group-hover:block","rounded-md ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"),children:(0,n.jsx)("span",{className:"px-2",children:"only"})})]})]},String(e.value))})})]}):(0,n.jsx)("div",{className:"flex items-center justify-center px-2 py-4 text-center border border-border rounded",children:(0,n.jsx)("p",{className:"text-xs text-foreground-light",children:"No options available"})}):(0,n.jsx)(ej,{})}function ew(e,t){let[a,n]=(0,r.useState)(e);return(0,r.useEffect)(()=>{let a=setTimeout(()=>n(e),null!=t?t:500);return()=>{clearTimeout(a)}},[e,t]),a}function eE(e){var t,a;let{value:s}=e,{table:l,columnFilters:o}=I(),i=l.getColumn(s),d="string"==typeof(a=null==(t=o.find(e=>e.id===s))?void 0:t.value)?a:null,[c,u]=(0,r.useState)(d),m=ew(c,500);return(0,r.useEffect)(()=>{let e=(null==m?void 0:m.trim())===""?null:m;null!==m&&(null==i||i.setFilterValue(e))},[m]),(0,r.useEffect)(()=>{(null==m?void 0:m.trim())!==d&&u(d)},[d]),(0,n.jsxs)("div",{className:"grid w-full gap-1.5","data-sentry-component":"DataTableFilterInput","data-sentry-source-file":"DataTableFilterInput.tsx",children:[(0,n.jsx)(ey.J,{htmlFor:s,className:"sr-only px-2 text-muted-foreground","data-sentry-element":"Label","data-sentry-source-file":"DataTableFilterInput.tsx",children:s}),(0,n.jsx)(eb,{placeholder:"Search",leading:(0,n.jsx)(b.A,{className:"h-4 w-4"}),containerClassName:"h-9 rounded",name:s,id:s,value:c||"",onChange:e=>u(e.target.value),"data-sentry-element":"InputWithAddons","data-sentry-source-file":"DataTableFilterInput.tsx"})]})}function eS(e){var t;let{value:a}=e,{columnFilters:s,table:r}=I(),l=r.getColumn(a),o=null==(t=s.find(e=>e.id===a))?void 0:t.value,i=o?Array.isArray(o)?o:[o]:[];return 0===i.length?null:(0,n.jsx)(B.$,{type:"outline",icon:(0,n.jsx)(j.A,{}),className:"h-5 rounded-full px-1.5 py-1 font-mono text-[10px] [&>span]:-translate-y-[0.6px] space-x-1",onClick:e=>{e.stopPropagation(),null==l||l.setFilterValue(void 0)},onKeyDown:e=>{e.stopPropagation(),"Enter"===e.code&&(null==l||l.setFilterValue(void 0))},"data-sentry-element":"Button","data-sentry-component":"DataTableFilterResetButton","data-sentry-source-file":"DataTableFilterResetButton.tsx",children:i.length})}var eD=a(90533);let eT=(0,r.forwardRef)((e,t)=>{let{className:a,...s}=e,l=Array.isArray(s.value)?s.value:[s.min,s.max];return(0,n.jsxs)(eD.bL,{ref:t,className:(0,w.cn)("relative flex w-full touch-none select-none items-center",a),...s,children:[(0,n.jsx)(eD.CC,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,n.jsx)(eD.Q6,{className:"absolute h-full bg-primary"})}),l.map((e,t)=>(0,n.jsx)(r.Fragment,{children:(0,n.jsx)(eD.zi,{className:"block h-4 w-4 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})},t))]})});function eC(e){var t,a,s,l;let{value:o,min:i,max:d}=e,{table:c,columnFilters:u,getFacetedMinMaxValues:m}=I(),g=c.getColumn(o),p="number"==typeof(l=null==(t=u.find(e=>e.id===o))?void 0:t.value)?[l,l]:Array.isArray(l)&&Array.isArray(l)&&l.every(e=>"number"==typeof e)?1===l.length?[l[0],l[0]]:l:null,[f,x]=(0,r.useState)(p),[h,_]=(null==m?void 0:m(c,o))||(null==g?void 0:g.getFacetedMinMaxValues())||[i,d],y=ew(f,500);return(0,r.useEffect)(()=>{(null==y?void 0:y.length)===2&&(null==g||g.setFilterValue(y))},[y]),(0,r.useEffect)(()=>{(null==y?void 0:y.length)!==2||(p?(y[0]!==p[0]||y[1]!==p[1])&&x(p):x(null))},[p]),(0,n.jsxs)("div",{className:"grid gap-2","data-sentry-component":"DataTableFilterSlider","data-sentry-source-file":"DataTableFilterSlider.tsx",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsxs)("div",{className:"grid w-full gap-1.5",children:[(0,n.jsx)(ey.J,{htmlFor:"min-".concat(o),className:"px-2 text-muted-foreground","data-sentry-element":"Label","data-sentry-source-file":"DataTableFilterSlider.tsx",children:"Min."}),(0,n.jsx)(eb,{placeholder:"from",trailing:"ms",containerClassName:"mb-2 h-9 rounded",type:"number",name:"min-".concat(o),id:"min-".concat(o),value:"".concat(null!=(a=null==f?void 0:f[0])?a:h),min:h,max:_,onChange:e=>x(t=>[Number(e.target.value),(null==t?void 0:t[1])||_]),"data-sentry-element":"InputWithAddons","data-sentry-source-file":"DataTableFilterSlider.tsx"})]}),(0,n.jsxs)("div",{className:"grid w-full gap-1.5",children:[(0,n.jsx)(ey.J,{htmlFor:"max-".concat(o),className:"px-2 text-muted-foreground","data-sentry-element":"Label","data-sentry-source-file":"DataTableFilterSlider.tsx",children:"Max."}),(0,n.jsx)(eb,{placeholder:"to",trailing:"ms",containerClassName:"mb-2 h-9 rounded",type:"number",name:"max-".concat(o),id:"max-".concat(o),value:"".concat(null!=(s=null==f?void 0:f[1])?s:_),min:h,max:_,onChange:e=>x(t=>[(null==t?void 0:t[0])||h,Number(e.target.value)]),"data-sentry-element":"InputWithAddons","data-sentry-source-file":"DataTableFilterSlider.tsx"})]})]}),(0,n.jsx)(eT,{min:h,max:_,value:(null==f?void 0:f.length)===2?f:[h,_],onValueChange:e=>x(e),"data-sentry-element":"Slider","data-sentry-source-file":"DataTableFilterSlider.tsx"})]})}eT.displayName=eD.bL.displayName;var ek=a(95567),eA=a(76188),eL=a(11366),eI=a(38069),eR=a(44053);function eF(e){var t;let{value:a,presets:s,dateRangeDisabled:l}=e,{table:o,columnFilters:i}=I(),d=o.getColumn(a),c=null==(t=i.find(e=>e.id===a))?void 0:t.value,{plan:u}=(0,eR.c)(),[m,g]=(0,r.useState)(!1),p=(0,r.useMemo)(()=>c instanceof Date?{from:c,to:void 0}:Array.isArray(c)&&f(c)?{from:null==c?void 0:c[0],to:null==c?void 0:c[1]}:void 0,[c]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ek.O,{buttonTriggerProps:{block:!0,className:"h-8"},popoverContentProps:{side:"bottom",align:"start"},onSubmit:e=>{if((0,eL.eu)(e.from,null==u?void 0:u.id))return void g(!0);let t=new Date(e.from),a=new Date(e.to);null==d||d.setFilterValue([t,a])},value:(()=>{if(!(null==p?void 0:p.from)||!(null==p?void 0:p.to)){let e=eA.xm.find(e=>e.default)||eA.xm[0];return{from:e.calcFrom(),to:e.calcTo(),text:e.text,isHelper:!0}}let e=eA.xm.find(e=>{let t=new Date(e.calcFrom()),a=new Date(e.calcTo());return 6e4>Math.abs(p.from.getTime()-t.getTime())&&6e4>Math.abs(p.to.getTime()-a.getTime())});return e?{from:e.calcFrom(),to:e.calcTo(),text:e.text,isHelper:!0}:{from:p.from.toISOString(),to:p.to.toISOString(),text:"".concat(p.from.toLocaleDateString()," - ").concat(p.to.toLocaleDateString()),isHelper:!1}})(),helpers:eA.xm,"data-sentry-element":"LogsDatePicker","data-sentry-source-file":"DataTableFilterTimerange.tsx"}),(0,n.jsx)(eI.A,{show:m,setShowUpgradePrompt:g,title:"Log date range",description:"Log data can be retained for a maximum of 3 months depending on the plan that your project is on.",source:"unifiedLogsDateRange","data-sentry-element":"UpgradePrompt","data-sentry-source-file":"DataTableFilterTimerange.tsx"})]})}var eq=a(56404),eH=a(56947),eP=a(53434),eO=a.n(eP);let eV=["sort","start","size","uuid","cursor","direction","live"],eM=[...eV,"date"];[...eV];let ez=e=>{let t=[];Object.entries(e).forEach(e=>{let[a,n]=e;if(!eM.includes(a)){if(Array.isArray(n)&&n.length>0)return void t.push("".concat(a," IN (").concat(n.map(e=>"'".concat(e,"'")).join(","),")"));null!=n&&(["host","pathname"].includes(a)?t.push("".concat(a," LIKE '%").concat(n,"%'")):t.push("".concat(a," = '").concat(n,"'")))}});let a=t.length>0?"WHERE ".concat(t.join(" AND ")):"";return{whereConditions:t,finalWhere:a}},eW=e=>{let t=e.date||[],a=e=>e?e instanceof Date?e.getTime():"string"==typeof e?eO()(e).valueOf():"number"==typeof e?e.toString().length>=16?Math.floor(e/1e3):e:null:null,n=a(t[0]),s=a(t[1]);n||(n=eO()().subtract(1,"hour").valueOf()),s||(s=eO()().valueOf());let r=eO()(n),l=eO()(s),o="MINUTE",i=l.diff(r,"minute"),d=l.diff(r,"hour"),c=l.diff(r,"day");return console.log("Time difference: ".concat(i," minutes, ").concat(d," hours, ").concat(c," days")),c>=2?"DAY":d>=12?"HOUR":"MINUTE"},eB=()=>"\n    select \n      id,\n      el.timestamp as timestamp,\n      'postgrest' as log_type,\n      CAST(edge_logs_response.status_code AS STRING) as status,\n      CASE\n          WHEN edge_logs_response.status_code BETWEEN 200 AND 299 THEN 'success'\n          WHEN edge_logs_response.status_code BETWEEN 400 AND 499 THEN 'warning'\n          WHEN edge_logs_response.status_code >= 500 THEN 'error'\n          ELSE 'success'\n      END as level,\n      edge_logs_request.path as pathname,\n      null as event_message,\n      edge_logs_request.method as method,\n      null as log_count,\n      null as logs\n    from edge_logs as el\n    cross join unnest(metadata) as edge_logs_metadata\n    cross join unnest(edge_logs_metadata.request) as edge_logs_request\n    cross join unnest(edge_logs_metadata.response) as edge_logs_response\n\n    -- ONLY include logs where the path includes /rest/\n    WHERE edge_logs_request.path LIKE '%/rest/%'\n  ",eU=()=>"\n    select \n      id,\n      pgl.timestamp as timestamp,\n      'postgres' as log_type,\n      CAST(pgl_parsed.sql_state_code AS STRING) as status,\n      CASE\n          WHEN pgl_parsed.error_severity = 'LOG' THEN 'success'\n          WHEN pgl_parsed.error_severity = 'WARNING' THEN 'warning'\n          WHEN pgl_parsed.error_severity = 'FATAL' THEN 'error'\n          WHEN pgl_parsed.error_severity = 'ERROR' THEN 'error'\n          ELSE null\n      END as level,\n      null as pathname,\n      event_message as event_message,\n      null as method,\n      null as log_count,\n      null as logs\n    from postgres_logs as pgl\n    cross join unnest(pgl.metadata) as pgl_metadata\n    cross join unnest(pgl_metadata.parsed) as pgl_parsed\n  ",eG=()=>"\n    select \n      id, \n      fel.timestamp as timestamp,\n      'edge function' as log_type,\n      CAST(fel_response.status_code AS STRING) as status,\n      CASE\n          WHEN fel_response.status_code BETWEEN 200 AND 299 THEN 'success'\n          WHEN fel_response.status_code BETWEEN 400 AND 499 THEN 'warning'\n          WHEN fel_response.status_code >= 500 THEN 'error'\n          ELSE 'success'\n      END as level,\n      fel_request.pathname as pathname,\n      COALESCE(function_logs_agg.last_event_message, '') as event_message,\n      fel_request.method as method,\n      function_logs_agg.function_log_count as log_count,\n      function_logs_agg.logs as logs\n    from function_edge_logs as fel\n    cross join unnest(metadata) as fel_metadata\n    cross join unnest(fel_metadata.response) as fel_response\n    cross join unnest(fel_metadata.request) as fel_request\n    left join (\n    SELECT\n        fl_metadata.execution_id,\n        COUNT(fl.id) as function_log_count,\n        ANY_VALUE(fl.event_message) as last_event_message,\n        ARRAY_AGG(STRUCT(fl.id, fl.timestamp, fl.event_message, fl_metadata.level, fl_metadata.event_type)) as logs\n    FROM function_logs as fl\n    CROSS JOIN UNNEST(fl.metadata) as fl_metadata\n    WHERE fl_metadata.execution_id IS NOT NULL\n    GROUP BY fl_metadata.execution_id\n    ) as function_logs_agg on fel_metadata.execution_id = function_logs_agg.execution_id\n  ",eK=()=>"\n    select\n      al.id as id, \n      el_in_al.timestamp as timestamp, \n      'auth' as log_type,\n      CAST(el_in_al_response.status_code AS STRING) as status,\n      CASE\n          WHEN el_in_al_response.status_code BETWEEN 200 AND 299 THEN 'success'\n          WHEN el_in_al_response.status_code BETWEEN 400 AND 499 THEN 'warning'\n          WHEN el_in_al_response.status_code >= 500 THEN 'error'\n          ELSE 'success'\n      END as level,\n      el_in_al_request.path as pathname,\n      null as event_message,\n      el_in_al_request.method as method,\n      null as log_count,\n      null as logs\n    from auth_logs as al\n    cross join unnest(metadata) as al_metadata \n    left join (\n    edge_logs as el_in_al\n        cross join unnest (metadata) as el_in_al_metadata \n        cross join unnest (el_in_al_metadata.response) as el_in_al_response \n        cross join unnest (el_in_al_response.headers) as el_in_al_response_headers \n        cross join unnest (el_in_al_metadata.request) as el_in_al_request\n    )\n    on al_metadata.request_id = el_in_al_response_headers.cf_ray\n    WHERE al_metadata.request_id is not null\n  ",eY=()=>"\n    select \n      id,\n      el.timestamp as timestamp,\n      'storage' as log_type,\n      CAST(edge_logs_response.status_code AS STRING) as status,\n      CASE\n          WHEN edge_logs_response.status_code BETWEEN 200 AND 299 THEN 'success'\n          WHEN edge_logs_response.status_code BETWEEN 400 AND 499 THEN 'warning'\n          WHEN edge_logs_response.status_code >= 500 THEN 'error'\n          ELSE 'success'\n      END as level,\n      edge_logs_request.path as pathname,\n      null as event_message,\n      edge_logs_request.method as method,\n      null as log_count,\n      null as logs\n    from edge_logs as el\n    cross join unnest(metadata) as edge_logs_metadata\n    cross join unnest(edge_logs_metadata.request) as edge_logs_request\n    cross join unnest(edge_logs_metadata.response) as edge_logs_response\n    -- ONLY include logs where the path includes /storage/\n    WHERE edge_logs_request.path LIKE '%/storage/%'\n  ",e$=()=>"\nWITH unified_logs AS (\n    ".concat(eB(),"\n    union all\n    ").concat(eU(),"\n    union all \n    ").concat(eG(),"\n    union all\n    ").concat(eK(),"\n    union all\n    ").concat(eY(),"\n)\n  "),eQ=e=>{let{finalWhere:t}=ez(e);return"\n".concat(e$(),"\nSELECT\n    id,\n    timestamp,\n    log_type,\n    status,\n    level,\n    pathname,\n    event_message,\n    method,\n    log_count,\n    logs\nFROM unified_logs\n").concat(t,"\n")},eJ=(e,t)=>{let a=[];return Object.entries(e).forEach(e=>{let[n,s]=e;if(n!==t&&!eM.includes(n)){if(Array.isArray(s)&&s.length>0)return void a.push("".concat(n," IN (").concat(s.map(e=>"'".concat(e,"'")).join(","),")"));null!=s&&(["host","pathname"].includes(n)?a.push("".concat(n," LIKE '%").concat(s,"%'")):a.push("".concat(n," = '").concat(s,"'")))}}),a.length>0?"WHERE ".concat(a.join(" AND ")):""},eX=e=>{let{search:t,facet:a,facetSearch:n}=e;return"\n".concat(a,"_count AS (\n  SELECT '").concat(a,"' as dimension, ").concat(a," as value, COUNT(*) as count\n  FROM unified_logs\n  ").concat(eJ(t,"".concat(a))||"WHERE ".concat(a," IS NOT NULL"),"\n  ").concat(eJ(t,"".concat(a))?" AND ".concat(a," IS NOT NULL"):"","\n  ").concat(n?"AND ".concat(a," LIKE '%").concat(n,"%'"):"","\n  GROUP BY ").concat(a,"\n  LIMIT ").concat(20,"\n)\n").trim()},eZ=()=>"\nWITH unified_logs AS (\n    -- Edge logs (non-rest, non-storage)\n    select \n      id,\n      'edge' as log_type,\n      CAST(edge_logs_response.status_code AS STRING) as status,\n      CASE\n          WHEN edge_logs_response.status_code BETWEEN 200 AND 299 THEN 'success'\n          WHEN edge_logs_response.status_code BETWEEN 400 AND 499 THEN 'warning'\n          WHEN edge_logs_response.status_code >= 500 THEN 'error'\n          ELSE 'success'\n      END as level,\n      edge_logs_request.path as pathname,\n      edge_logs_request.method as method\n    from edge_logs as el\n    cross join unnest(metadata) as edge_logs_metadata\n    cross join unnest(edge_logs_metadata.request) as edge_logs_request\n    cross join unnest(edge_logs_metadata.response) as edge_logs_response\n    WHERE edge_logs_request.path NOT LIKE '%/rest/%'\n    AND edge_logs_request.path NOT LIKE '%/storage/%'\n    \n    union all\n    \n    -- Postgrest logs\n    select \n      id,\n      'postgrest' as log_type,\n      CAST(edge_logs_response.status_code AS STRING) as status,\n      CASE\n          WHEN edge_logs_response.status_code BETWEEN 200 AND 299 THEN 'success'\n          WHEN edge_logs_response.status_code BETWEEN 400 AND 499 THEN 'warning'\n          WHEN edge_logs_response.status_code >= 500 THEN 'error'\n          ELSE 'success'\n      END as level,\n      edge_logs_request.path as pathname,\n      edge_logs_request.method as method\n    from edge_logs as el\n    cross join unnest(metadata) as edge_logs_metadata\n    cross join unnest(edge_logs_metadata.request) as edge_logs_request\n    cross join unnest(edge_logs_metadata.response) as edge_logs_response\n    WHERE edge_logs_request.path LIKE '%/rest/%'\n    \n    union all\n    \n    -- Postgres logs\n    select \n      id,\n      'postgres' as log_type,\n      CAST(pgl_parsed.sql_state_code AS STRING) as status,\n      CASE\n          WHEN pgl_parsed.error_severity = 'LOG' THEN 'success'\n          WHEN pgl_parsed.error_severity = 'WARNING' THEN 'warning'\n          WHEN pgl_parsed.error_severity = 'FATAL' THEN 'error'\n          WHEN pgl_parsed.error_severity = 'ERROR' THEN 'error'\n          ELSE null\n      END as level,\n      null as pathname,\n      null as method\n    from postgres_logs as pgl\n    cross join unnest(pgl.metadata) as pgl_metadata\n    cross join unnest(pgl_metadata.parsed) as pgl_parsed\n    \n    union all\n    \n    -- Edge function logs\n    select \n      id,\n      'edge function' as log_type,\n      CAST(fel_response.status_code AS STRING) as status,\n      CASE\n          WHEN fel_response.status_code BETWEEN 200 AND 299 THEN 'success'\n          WHEN fel_response.status_code BETWEEN 400 AND 499 THEN 'warning'\n          WHEN fel_response.status_code >= 500 THEN 'error'\n          ELSE 'success'\n      END as level,\n      fel_request.pathname as pathname,\n      fel_request.method as method\n    from function_edge_logs as fel\n    cross join unnest(metadata) as fel_metadata\n    cross join unnest(fel_metadata.response) as fel_response\n    cross join unnest(fel_metadata.request) as fel_request\n    \n    union all\n    \n    -- Auth logs\n    select\n      al.id as id,\n      'auth' as log_type,\n      CAST(el_in_al_response.status_code AS STRING) as status,\n      CASE\n          WHEN el_in_al_response.status_code BETWEEN 200 AND 299 THEN 'success'\n          WHEN el_in_al_response.status_code BETWEEN 400 AND 499 THEN 'warning'\n          WHEN el_in_al_response.status_code >= 500 THEN 'error'\n          ELSE 'success'\n      END as level,\n      el_in_al_request.path as pathname,\n      el_in_al_request.method as method\n    from auth_logs as al\n    cross join unnest(metadata) as al_metadata \n    left join (\n    edge_logs as el_in_al\n        cross join unnest (metadata) as el_in_al_metadata \n        cross join unnest (el_in_al_metadata.response) as el_in_al_response \n        cross join unnest (el_in_al_response.headers) as el_in_al_response_headers \n        cross join unnest (el_in_al_metadata.request) as el_in_al_request\n    )\n    on al_metadata.request_id = el_in_al_response_headers.cf_ray\n    WHERE al_metadata.request_id is not null\n    \n    union all\n    \n    -- Storage logs\n    select \n      id,\n      'storage' as log_type,\n      CAST(edge_logs_response.status_code AS STRING) as status,\n      CASE\n          WHEN edge_logs_response.status_code BETWEEN 200 AND 299 THEN 'success'\n          WHEN edge_logs_response.status_code BETWEEN 400 AND 499 THEN 'warning'\n          WHEN edge_logs_response.status_code >= 500 THEN 'error'\n          ELSE 'success'\n      END as level,\n      edge_logs_request.path as pathname,\n      edge_logs_request.method as method\n    from edge_logs as el\n    cross join unnest(metadata) as edge_logs_metadata\n    cross join unnest(edge_logs_metadata.request) as edge_logs_request\n    cross join unnest(edge_logs_metadata.response) as edge_logs_response\n    WHERE edge_logs_request.path LIKE '%/storage/%'\n)\n  ",e0=e=>{let{finalWhere:t}=ez(e);return"\n".concat(eZ(),",\n").concat(eX({search:e,facet:"log_type"}),",\n").concat(eX({search:e,facet:"method"}),",\n").concat(eX({search:e,facet:"level"}),",\n").concat(eX({search:e,facet:"status"}),",\n").concat(eX({search:e,facet:"pathname"}),"\n\n-- Get total count\nSELECT 'total' as dimension, 'all' as value, COUNT(*) as count\nFROM unified_logs\n").concat(t,"\n\nUNION ALL\n\n-- Get counts by log_type (exclude log_type filter to avoid self-filtering)\nSELECT dimension, value, count from log_type_count\n\nUNION ALL\n\n-- Get counts by method (exclude method filter to avoid self-filtering)  \nSELECT dimension, value, count from method_count\n\nUNION ALL\n\n-- Get counts by level (exclude level filter to avoid self-filtering)\nSELECT dimension, value, count from level_count\n\nUNION ALL\n\n-- Get counts by status (exclude status filter to avoid self-filtering)\nSELECT dimension, value, count from status_count\n\nUNION ALL\n\n-- Get counts by pathname (exclude pathname filter to avoid self-filtering)\nSELECT dimension, value, count from pathname_count\n\n")},e2=e=>{let{finalWhere:t}=ez(e),a=eW(e);return"\n".concat(e$(),"\nSELECT\n  TIMESTAMP_TRUNC(timestamp, ").concat(a,") as time_bucket,\n  COUNTIF(level = 'success') as success,\n  COUNTIF(level = 'warning') as warning,\n  COUNTIF(level = 'error') as error,\n  COUNT(*) as total_per_bucket\nFROM unified_logs\n").concat(t,"\nGROUP BY time_bucket\nORDER BY time_bucket ASC\n")};var e1=a(65172);let e4={unifiedLogsInfinite:(e,t)=>["projects",e,"unified-logs","logs-data",...t?[t].filter(Boolean):[]],unifiedLogsCount:(e,t)=>["projects",e,"unified-logs","count-data",...t?[t].filter(Boolean):[]],unifiedLogsChart:(e,t)=>["projects",e,"unified-logs","chart-data",...t?[t].filter(Boolean):[]],unifiedLogsFacetCount:(e,t,a,n)=>["projects",e,"unified-logs","count-data",t,a,...n?[n].filter(Boolean):[]],serviceFlow:(e,t,a)=>["projects",e,"unified-logs","service-flow",a,...t?[t].filter(Boolean):[]]};var e5=a(17702);let e3={refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1,refetchInterval:0,staleTime:3e5},e6=function(e){let t,a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(e.date&&2===e.date.length){let n=e=>e instanceof Date?e:new Date(e);t=n(e.date[0]).toISOString(),a=n(e.date[1]).toISOString()}else{let e=new Date;a=e.toISOString(),t=new Date(e.getTime()-1e3*n*3600).toISOString()}return{isoTimestampStart:t,isoTimestampEnd:a}};async function e8(e,t,a){var n;let s,{projectRef:r,search:l,pageParam:o}=e;if(void 0===r)throw Error("projectRef is required for getUnifiedLogs");let{isoTimestampStart:i,isoTimestampEnd:d}=e6(l),c="".concat(eQ(l)," ORDER BY timestamp DESC, id DESC LIMIT ").concat(50),u=null==o?void 0:o.cursor,m=null==o?void 0:o.direction;"prev"===m?(u&&new Date(Number(u)/1e3).toISOString(),s=new Date().toISOString()):s="next"===m&&u?new Date(Number(u)/1e3).toISOString():d;let g=new Headers(a),{data:p,error:f}=await (0,e1.bE)("/platform/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:r}},body:{iso_timestamp_start:i,iso_timestamp_end:s,sql:c},signal:t,headers:g});f&&(0,e1.H4)(f);let x=(null!=(n=null==p?void 0:p.result)?n:[]).map(e=>{let t=new Date(Number(e.timestamp)/1e3);return{id:e.id,date:t,timestamp:e.timestamp,level:e.level,status:e.status||200,method:e.method,host:e.host,pathname:(e.url||"").replace(/^https?:\/\/[^\/]+/,"")||e.pathname||"",event_message:e.event_message||e.body||"",headers:"string"==typeof e.headers?JSON.parse(e.headers||"{}"):e.headers||{},regions:e.region?[e.region]:[],log_type:e.log_type||"",latency:e.latency||0,log_count:e.log_count||null,logs:e.logs||[],auth_user:e.auth_user||null}}),h=x.length>0?x[0]:null,_=x.length>0?x[x.length-1]:null,y=x.length>=49,v=_?_.timestamp:null,b=x.length>0?h.timestamp:1e3*new Date().getTime();return{data:x,nextCursor:y?v:null,prevCursor:b}}let e9=function(e){let{projectRef:t,search:a}=e,{enabled:n=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,e5.q)(e4.unifiedLogsInfinite(t,a),e=>{let{signal:n,pageParam:s}=e;return e8({projectRef:t,search:a,pageParam:s},n)},{enabled:n&&void 0!==t,keepPreviousData:!0,getPreviousPageParam:e=>e.prevCursor?{cursor:e.prevCursor,direction:"prev"}:null,getNextPageParam:e=>e.nextCursor&&0!==e.data.length?{cursor:e.nextCursor,direction:"next"}:null,...e3,...s})};async function e7(e,t){var a;let{projectRef:n,search:s,facet:r,facetSearch:l}=e;if(void 0===n)throw Error("projectRef is required for getUnifiedLogsFacetCount");let{isoTimestampStart:o,isoTimestampEnd:i}=e6(s),d="\n".concat(e$(),",\n").concat(eX({search:s,facet:r,facetSearch:l}),"\nSELECT dimension, value, count from ").concat(r,"_count;\n").trim(),{data:c,error:u}=await (0,e1.bE)("/platform/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:n}},body:{iso_timestamp_start:o,iso_timestamp_end:i,sql:d},signal:t});return u&&(0,e1.H4)(u),null!=(a=c.result)?a:[]}let te=function(e){let{projectRef:t,search:a,facet:n,facetSearch:s}=e,{enabled:r=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,eH.I)(e4.unifiedLogsFacetCount(t,n,s,a),e=>{let{signal:r}=e;return e7({projectRef:t,search:a,facet:n,facetSearch:s},r)},{enabled:r&&void 0!==t,...e3,...l})};function tt(e){var t;let{value:a,options:s,component:o}=e,[i,d]=(0,r.useState)(""),{table:c,searchParameters:u,columnFilters:m,isLoadingCounts:g,getFacetedUniqueValues:f}=I(),{ref:x}=(0,l.g)(),h=(0,eq.d7)(i,700),{data:_=[],isFetching:y}=te({projectRef:x,search:u,facet:a,facetSearch:h},{keepPreviousData:!0,enabled:h.length>0,initialData:0===h.length?s:void 0}),j=c.getColumn(a),N=null==(t=m.find(e=>e.id===a))?void 0:t.value,E=(null==f?void 0:f(c,a))||(null==j?void 0:j.getFacetedUniqueValues()),S=N?Array.isArray(N)?N:[N]:[];return(null==s?void 0:s.length)?(0,n.jsxs)("div",{className:"grid gap-2","data-sentry-component":"DataTableFilterCheckboxAsync","data-sentry-source-file":"DataTableFilterCheckboxAsync.tsx",children:[(0,n.jsx)(eb,{placeholder:"Search",leading:(0,n.jsx)(b.A,{size:14,className:"text-foreground-lighter"}),containerClassName:"h-8 rounded",value:i,trailing:y?(0,n.jsx)(v.A,{size:12,className:"animate-spin"}):void 0,onChange:e=>d(e.target.value),"data-sentry-element":"InputWithAddons","data-sentry-source-file":"DataTableFilterCheckboxAsync.tsx"}),(0,n.jsx)("div",{className:"max-h-[200px] overflow-y-auto rounded border border-border empty:border-none",children:0===_.length?(0,n.jsx)("div",{className:"flex items-center justify-center px-2 py-3 text-center",children:(0,n.jsxs)("div",{className:"space-y-0.5",children:[(0,n.jsx)("p",{className:"text-xs text-foreground",children:"No results found"}),(0,n.jsx)("p",{className:"text-xs text-foreground-lighter",children:"Try a different search term"})]})}):_.map((e,t)=>{let s=S.includes(e.value);return(0,n.jsxs)("div",{className:(0,w.cn)("group relative flex items-center space-x-2 px-2 py-2 hover:bg-accent/50",t!==_.length-1?"border-b":void 0),children:[(0,n.jsx)(e_.S,{id:"".concat(a,"-").concat(e.value),checked:s,onCheckedChange:t=>{let a=t?[...S||[],e.value]:null==S?void 0:S.filter(t=>e.value!==t);null==j||j.setFilterValue((null==a?void 0:a.length)?a:void 0)}}),(0,n.jsxs)(ey.J,{htmlFor:"".concat(a,"-").concat(e.value),className:"flex w-full items-center justify-between gap-2 text-foreground/70 group-hover:text-accent-foreground text-[0.8rem] min-w-0",children:[(0,n.jsx)("div",{className:"flex-1 min-w-0 overflow-hidden",children:o?(0,n.jsx)(o,{...e}):(0,n.jsx)("span",{className:"truncate font-normal block",children:e.label})}),(0,n.jsx)("span",{className:"flex-shrink-0 flex items-center justify-center font-mono text-xs",children:g?(0,n.jsx)(ev.E,{className:"h-4 w-4"}):(null==E?void 0:E.has(e.value))?p(E.get(e.value)||0):["log_type","method","level"].includes(a)?"0":null}),(0,n.jsx)("button",{type:"button",onClick:()=>null==j?void 0:j.setFilterValue([e.value]),className:(0,w.cn)("absolute inset-y-0 right-0 hidden font-normal text-muted-foreground backdrop-blur-sm hover:text-foreground group-hover:block","rounded-md ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"),children:(0,n.jsx)("span",{className:"px-2",children:"only"})})]})]},String(e.value))})})]}):(0,n.jsx)("div",{className:"flex items-center justify-center px-2 py-4 text-center border border-border rounded",children:(0,n.jsx)("p",{className:"text-xs text-foreground-light",children:"No options available"})})}function ta(e){var t;let{dateRangeDisabled:a}=e,{filterFields:s,isLoadingCounts:r}=I();return(0,n.jsx)(eh.nD,{type:"multiple",defaultValue:null==s||null==(t=s.filter(e=>{let{defaultOpen:t}=e;return t}))?void 0:t.map(e=>{let{value:t}=e;return t}),"data-sentry-element":"Accordion","data-sentry-component":"DataTableFilterControls","data-sentry-source-file":"DataTableFilterControls.tsx",children:null==s?void 0:s.map(e=>{let t=e.value;return(0,n.jsxs)(eh.As,{value:t,className:"border-none",children:[(0,n.jsx)(eh.$m,{className:"w-full px-2 py-0 hover:no-underline data-[state=closed]:text-muted-foreground data-[state=open]:text-foreground focus-within:data-[state=closed]:text-foreground hover:data-[state=closed]:text-foreground",children:(0,n.jsxs)("div",{className:"flex w-full items-center justify-between gap-2 truncate py-2 pr-2",children:[(0,n.jsx)("div",{className:"flex items-center gap-2 truncate",children:(0,n.jsx)("p",{className:"text-sm",children:e.label})}),(0,n.jsx)(eS,{...e})]})}),(0,n.jsx)(eh.ub,{children:(0,n.jsx)("div",{className:"p-1",children:(()=>{switch(e.type){case"checkbox":if(e.hasDynamicOptions&&r)return(0,n.jsx)(ej,{});if(e.hasAsyncSearch)return(0,n.jsx)(tt,{...e});return(0,n.jsx)(eN,{...e});case"slider":return(0,n.jsx)(eC,{...e});case"input":return(0,n.jsx)(eE,{...e});case"timerange":return(0,n.jsx)(eF,{dateRangeDisabled:a,...e})}})()})})]},t)})})}function tn(){let e=(0,r.useRef)(null),t=function(e){let[t,a]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{function t(e){a(e.matches)}let n=matchMedia(e);return n.addEventListener("change",t),a(n.matches),()=>n.removeEventListener("change",t)},[e]),t}("(max-width: 640px)");return W(()=>{var t;null==(t=e.current)||t.click()},"b"),(0,n.jsxs)(eo,{"data-sentry-element":"Drawer","data-sentry-component":"DataTableFilterControlsDrawer","data-sentry-source-file":"DataTableFilterControlsDrawer.tsx",children:[(0,n.jsxs)(en.m_,{"data-sentry-element":"Tooltip","data-sentry-source-file":"DataTableFilterControlsDrawer.tsx",children:[(0,n.jsx)(en.k$,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"DataTableFilterControlsDrawer.tsx",children:(0,n.jsx)(ei,{asChild:!0,"data-sentry-element":"DrawerTrigger","data-sentry-source-file":"DataTableFilterControlsDrawer.tsx",children:(0,n.jsx)(B.$,{className:"h-9 w-9",ref:t?e:null,"data-sentry-element":"Button","data-sentry-source-file":"DataTableFilterControlsDrawer.tsx",children:(0,n.jsx)(er.A,{className:"w-4 h-4","data-sentry-element":"FilterIcon","data-sentry-source-file":"DataTableFilterControlsDrawer.tsx"})})})}),(0,n.jsx)(en.ZI,{side:"right","data-sentry-element":"TooltipContent","data-sentry-source-file":"DataTableFilterControlsDrawer.tsx",children:(0,n.jsxs)("p",{children:["Toggle controls with"," ",(0,n.jsxs)(T,{className:"ml-1 text-muted-foreground group-hover:text-accent-foreground","data-sentry-element":"Kbd","data-sentry-source-file":"DataTableFilterControlsDrawer.tsx",children:[(0,n.jsx)("span",{className:"mr-1",children:"⌘"}),(0,n.jsx)("span",{children:"B"})]})]})})]}),(0,n.jsxs)(em,{className:"max-h-[calc(100dvh-4rem)]","data-sentry-element":"DrawerContent","data-sentry-source-file":"DataTableFilterControlsDrawer.tsx",children:[(0,n.jsx)(es.s,{"data-sentry-element":"VisuallyHidden","data-sentry-source-file":"DataTableFilterControlsDrawer.tsx",children:(0,n.jsxs)(eg,{"data-sentry-element":"DrawerHeader","data-sentry-source-file":"DataTableFilterControlsDrawer.tsx",children:[(0,n.jsx)(ef,{"data-sentry-element":"DrawerTitle","data-sentry-source-file":"DataTableFilterControlsDrawer.tsx",children:"Filters"}),(0,n.jsx)(ex,{"data-sentry-element":"DrawerDescription","data-sentry-source-file":"DataTableFilterControlsDrawer.tsx",children:"Adjust your table filters"})]})}),(0,n.jsx)("div",{className:"px-4 flex-1 overflow-y-auto",children:(0,n.jsx)(ta,{"data-sentry-element":"DataTableFilterControls","data-sentry-source-file":"DataTableFilterControlsDrawer.tsx"})}),(0,n.jsx)(ep,{"data-sentry-element":"DrawerFooter","data-sentry-source-file":"DataTableFilterControlsDrawer.tsx",children:(0,n.jsx)(ec,{asChild:!0,"data-sentry-element":"DrawerClose","data-sentry-source-file":"DataTableFilterControlsDrawer.tsx",children:(0,n.jsx)(B.$,{type:"outline",className:"w-full","data-sentry-element":"Button","data-sentry-source-file":"DataTableFilterControlsDrawer.tsx",children:"Close"})})})]})]})}function ts(){let{table:e}=I();return W(e.resetColumnFilters,"Escape"),(0,n.jsxs)(en.m_,{"data-sentry-element":"Tooltip","data-sentry-component":"DataTableResetButton","data-sentry-source-file":"DataTableResetButton.tsx",children:[(0,n.jsx)(en.k$,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"DataTableResetButton.tsx",children:(0,n.jsx)(B.$,{type:"default",size:"tiny",onClick:()=>e.resetColumnFilters(),icon:(0,n.jsx)(j.A,{}),"data-sentry-element":"Button","data-sentry-source-file":"DataTableResetButton.tsx",children:"Reset"})}),(0,n.jsx)(en.ZI,{side:"left","data-sentry-element":"TooltipContent","data-sentry-source-file":"DataTableResetButton.tsx",children:(0,n.jsxs)("p",{children:["Reset filters with"," ",(0,n.jsxs)(T,{className:"ml-1 text-muted-foreground group-hover:text-accent-foreground","data-sentry-element":"Kbd","data-sentry-source-file":"DataTableResetButton.tsx",children:[(0,n.jsx)("span",{className:"mr-1",children:"⌘"}),(0,n.jsx)("span",{children:"Esc"})]})]})})]})}var tr=a(70723),tl=a(11962),to=a(9681),ti=a(88602),td=a(26779),tc=a(46328),tu=a(47625),tm=a(87604),tg=a(79567),tp=a(37034);function tf(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return e=>t.forEach(t=>{"function"==typeof t?t(e):null!=t&&(t.current=e)})}let tx={vertical:{modifiers:[tc.FN,tc.gj],strategy:tu._G},horizontal:{modifiers:[tc.dU,tc.gj],strategy:tu.m$},mixed:{modifiers:[tc.gj],strategy:void 0}};function th(e){let{value:t,onValueChange:a,onDragStart:s,onDragEnd:l,onDragCancel:o,collisionDetection:i=td.fp,modifiers:d,strategy:c,onMove:u,orientation:m="vertical",overlay:g,children:p,...f}=e,[x,h]=(0,r.useState)(null),_=(0,td.FR)((0,td.MS)(td.cA),(0,td.MS)(td.IG),(0,td.MS)(td.uN)),y=tx[m];return(0,n.jsxs)(td.Mp,{modifiers:null!=d?d:y.modifiers,sensors:_,onDragStart:e=>{h(e.active.id),null==s||s(e)},onDragEnd:e=>{let{active:n,over:s}=e;if(s&&n.id!==(null==s?void 0:s.id)){let e=t.findIndex(e=>e.id===n.id),r=t.findIndex(e=>e.id===s.id);u?u({activeIndex:e,overIndex:r}):null==a||a((0,tu.be)(t,e,r))}h(null),null==l||l(e)},onDragCancel:e=>{null==h||h(null),null==o||o(e)},collisionDetection:i,...f,"data-sentry-element":"DndContext","data-sentry-component":"Sortable","data-sentry-source-file":"Sortable.tsx",children:[(0,n.jsx)(tu.gB,{items:t,strategy:null!=c?c:y.strategy,"data-sentry-element":"SortableContext","data-sentry-source-file":"Sortable.tsx",children:p}),g?(0,tp.createPortal)((0,n.jsx)(ty,{activeId:x,children:g}),document.body):null]})}let t_={sideEffects:(0,td.WB)({styles:{active:{opacity:"0.4"}}})},ty=(0,r.forwardRef)((e,t)=>{let{activeId:a,dropAnimation:s=t_,children:r,...l}=e;return(0,n.jsx)(td.Hd,{dropAnimation:s,...l,children:a?(0,n.jsx)(tb,{ref:t,value:a,className:"cursor-grabbing",asChild:!0,children:r}):null})});ty.displayName="SortableOverlay";let tv=(0,r.createContext)({attributes:{},listeners:void 0,isDragging:!1}),tb=(0,r.forwardRef)((e,t)=>{let{value:a,asTrigger:s,asChild:l,className:o,...i}=e,{attributes:d,listeners:c,setNodeRef:u,transform:m,transition:g,isDragging:p}=(0,tu.gl)({id:a}),f=(0,r.useMemo)(()=>({attributes:d,listeners:c,isDragging:p}),[d,c,p]),x={opacity:p?.5:1,transform:tm.Ks.Translate.toString(m),transition:g},h=l?tg.DX:"div";return(0,n.jsx)(tv.Provider,{value:f,children:(0,n.jsx)(h,{"data-state":p?"dragging":void 0,className:(0,w.cn)("data-[state=dragging]:cursor-grabbing",{"cursor-grab":!p&&s},o),ref:tf(t,u),style:x,...s?d:{},...s?c:{},...i})})});tb.displayName="SortableItem";let tj=(0,r.forwardRef)((e,t)=>{let{className:a,...s}=e,{attributes:l,listeners:o,isDragging:i}=function(){let e=(0,r.useContext)(tv);if(!e)throw Error("useSortableItem must be used within a SortableItem");return e}();return(0,n.jsx)(B.$,{ref:tf(t),"data-state":i?"dragging":void 0,className:(0,w.cn)("cursor-grab data-[state=dragging]:cursor-grabbing",a),...l,...o,...s})});function tN(){let{table:e,enableColumnOrdering:t}=I(),[a,s]=(0,r.useState)(!1),[l,o]=(0,r.useState)(!1),[i,d]=(0,r.useState)(""),c=e.getState().columnOrder,u=(0,r.useMemo)(()=>e.getAllColumns().sort((e,t)=>c.indexOf(e.id)-c.indexOf(t.id)),[c]);return(0,n.jsxs)(to.AM,{open:a,onOpenChange:s,"data-sentry-element":"Popover","data-sentry-component":"DataTableViewOptions","data-sentry-source-file":"DataTableViewOptions.tsx",children:[(0,n.jsx)(to.Wv,{asChild:!0,"data-sentry-element":"PopoverTrigger","data-sentry-source-file":"DataTableViewOptions.tsx",children:(0,n.jsx)(ti.G,{type:"outline",size:"tiny",role:"combobox","aria-expanded":a,className:"w-[26px]",icon:(0,n.jsx)(tr.A,{className:"text-foreground"}),tooltip:{content:{side:"bottom",text:"Toggle column visibility"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"DataTableViewOptions.tsx"})}),(0,n.jsx)(to.hl,{portal:!0,side:"bottom",align:"end",className:"w-[200px] p-0","data-sentry-element":"PopoverContent","data-sentry-source-file":"DataTableViewOptions.tsx",children:(0,n.jsxs)(E.uB,{"data-sentry-element":"Command","data-sentry-source-file":"DataTableViewOptions.tsx",children:[(0,n.jsx)(E.G7,{value:i,onValueChange:d,placeholder:"Search columns...","data-sentry-element":"CommandInput","data-sentry-source-file":"DataTableViewOptions.tsx"}),(0,n.jsxs)(E.oI,{"data-sentry-element":"CommandList","data-sentry-source-file":"DataTableViewOptions.tsx",children:[(0,n.jsx)(E.xL,{"data-sentry-element":"CommandEmpty","data-sentry-source-file":"DataTableViewOptions.tsx",children:"No option found."}),(0,n.jsx)(E.L$,{"data-sentry-element":"CommandGroup","data-sentry-source-file":"DataTableViewOptions.tsx",children:(0,n.jsx)(th,{value:u.map(e=>({id:e.id})),onValueChange:t=>e.setColumnOrder(t.map(e=>e.id)),overlay:(0,n.jsx)("div",{className:"h-8 w-full rounded-md bg-muted/60"}),onDragStart:()=>o(!0),onDragEnd:()=>o(!1),onDragCancel:()=>o(!1),"data-sentry-element":"Sortable","data-sentry-source-file":"DataTableViewOptions.tsx",children:u.filter(e=>void 0!==e.accessorFn&&e.getCanHide()).map(e=>{var a;return(0,n.jsx)(tb,{value:e.id,asChild:!0,children:(0,n.jsxs)(E.h_,{value:e.id,onSelect:()=>e.toggleVisibility(!e.getIsVisible()),className:"capitalize p-1",disabled:l,children:[(0,n.jsx)(e_.S,{checked:e.getIsVisible(),className:"mr-2"}),(0,n.jsx)("span",{children:(null==(a=e.columnDef.meta)?void 0:a.label)||e.id}),t&&!i?(0,n.jsx)(tj,{type:"text",size:"tiny",className:"ml-auto size-5 text-muted-foreground hover:text-foreground focus:bg-muted focus:text-foreground",children:(0,n.jsx)(tl.A,{className:"size-4","aria-hidden":"true"})}):null]})},e.id)})})})]})]})})]})}function tw(e){let{renderActions:t}=e,{table:a,isLoading:s,columnFilters:l}=I(),{open:o,setOpen:i}=function(){let e=(0,r.useContext)(C);if(!e)throw Error("useControls must be used within a ControlsProvider");return e}(),d=a.getState().columnFilters;W(()=>i(e=>!e),"b");let c=(0,r.useMemo)(()=>({total:a.getCoreRowModel().rows.length,filtered:a.getFilteredRowModel().rows.length}),[s,l]);return(0,n.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4","data-sentry-component":"DataTableToolbar","data-sentry-source-file":"DataTableToolbar.tsx",children:[(0,n.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,n.jsxs)(en.m_,{"data-sentry-element":"Tooltip","data-sentry-source-file":"DataTableToolbar.tsx",children:[(0,n.jsx)(en.k$,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"DataTableToolbar.tsx",children:(0,n.jsx)(B.$,{size:"tiny",type:"outline",icon:o?(0,n.jsx)(et.A,{}):(0,n.jsx)(ea.A,{}),onClick:()=>i(e=>!e),className:"hidden sm:flex","data-sentry-element":"Button","data-sentry-source-file":"DataTableToolbar.tsx",children:(0,n.jsxs)("span",{className:"hidden md:block",children:[o?"Hide":"Show"," Controls"]})})}),(0,n.jsx)(en.ZI,{side:"right","data-sentry-element":"TooltipContent","data-sentry-source-file":"DataTableToolbar.tsx",children:(0,n.jsxs)("p",{children:["Toggle controls with"," ",(0,n.jsxs)(T,{className:"ml-1 text-muted-foreground group-hover:text-accent-foreground","data-sentry-element":"Kbd","data-sentry-source-file":"DataTableToolbar.tsx",children:[(0,n.jsx)("span",{className:"mr-1",children:"⌘"}),(0,n.jsx)("span",{children:"B"})]})]})})]}),(0,n.jsx)("div",{className:"block sm:hidden",children:(0,n.jsx)(tn,{"data-sentry-element":"DataTableFilterControlsDrawer","data-sentry-source-file":"DataTableToolbar.tsx"})}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{className:"hidden text-sm text-muted-foreground sm:block",children:[(0,n.jsx)("span",{className:"font-mono font-medium",children:p(c.filtered)})," of"," ",(0,n.jsx)("span",{className:"font-mono font-medium",children:p(c.total)})," row(s)"," ",(0,n.jsx)("span",{className:"sr-only sm:not-sr-only",children:"filtered"})]}),(0,n.jsxs)("p",{className:"block text-sm text-muted-foreground sm:hidden",children:[(0,n.jsx)("span",{className:"font-mono font-medium",children:p(c.filtered)})," ","row(s)"]})]})]}),(0,n.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[d.length?(0,n.jsx)(ts,{}):null,null==t?void 0:t(),(0,n.jsx)(tN,{"data-sentry-element":"DataTableViewOptions","data-sentry-source-file":"DataTableToolbar.tsx"})]})]})}tj.displayName="SortableDragHandle";var tE=a(54660),tS=a(65841),tD=a(43373);function tT(e){let{dateRangeDisabled:t}=e,a=(0,s.useRouter)(),{ref:r}=(0,l.g)(),{table:i}=I(),d=(0,tE._P)("unifiedLogs"),{disable:c}=(0,o.nW)();return(0,n.jsxs)(tS.wV,{order:1,maxSize:33,defaultSize:1,id:"panel-left",className:(0,w.cn)("flex flex-col w-full","min-w-64 max-w-[32rem]","group-data-[expanded=false]/controls:hidden","hidden sm:flex"),"data-sentry-element":"ResizablePanel","data-sentry-component":"FilterSideBar","data-sentry-source-file":"FilterSideBar.tsx",children:[(0,n.jsx)("div",{className:"border-b border-border px-4 md:top-0",children:(0,n.jsxs)("div",{className:"flex h-[48px] items-center justify-between gap-3",children:[(0,n.jsx)("p",{className:"text-foreground text-lg",children:"Logs"}),i.getState().columnFilters.length?(0,n.jsx)(ts,{}):null]})}),(0,n.jsxs)("div",{className:"flex-1 p-2 sm:overflow-y-scroll",children:[d&&(0,n.jsx)(tD.V,{className:"mx-2 mt-2 mb-3",title:"Go back to old logs",description:"Use the traditional interface",actions:(0,n.jsx)(B.$,{type:"default",size:"tiny",onClick:()=>{c(),a.push("/project/".concat(r,"/logs/explorer"))},children:"Switch back"})}),(0,n.jsx)(ta,{dateRangeDisabled:t,"data-sentry-element":"DataTableFilterControls","data-sentry-source-file":"FilterSideBar.tsx"})]})]})}var tC=a(7078),tk=a(29262);function tA(e){let{fetchPreviousPage:t,searchParamsParser:a}=e,[{live:s,date:l,sort:o},i]=(0,c.ab)(a),{table:d}=I();function u(){var e;i(e=>({...e,live:!e.live,date:null,sort:null})),null==(e=d.getColumn("date"))||e.setFilterValue(void 0),d.resetSorting()}return W(u,"j"),(0,r.useEffect)(()=>{let e;async function a(){s?(await (null==t?void 0:t()),e=setTimeout(a,1e4)):clearTimeout(e)}return a(),()=>{clearTimeout(e)}},[s,t]),(0,r.useEffect)(()=>{(l||o)&&s&&i(e=>({...e,live:null}))},[l,o]),(0,n.jsx)(B.$,{className:(0,w.cn)(s&&"border-info text-info hover:text-info"),onClick:u,type:s?"primary":"default",size:"tiny",icon:s?(0,n.jsx)(tC.A,{className:"h-4 w-4"}):(0,n.jsx)(tk.A,{className:"h-4 w-4"}),"data-sentry-element":"Button","data-sentry-component":"LiveButton","data-sentry-source-file":"LiveButton.tsx",children:"Live"})}function tL(e){let{colSpan:t}=e;return(0,n.jsxs)(U.Hj,{"data-sentry-element":"TableRow","data-sentry-component":"LiveRow","data-sentry-source-file":"LiveRow.tsx",children:[(0,n.jsx)(U.nA,{className:"relative w-[--header-level-size] min-w-[--header-level-size] max-w-[--header-level-size] border-b border-r border-t border-info","data-sentry-element":"TableCell","data-sentry-source-file":"LiveRow.tsx",children:(0,n.jsxs)("div",{className:"flex items-center justify-center",children:[(0,n.jsx)("span",{className:"absolute inline-flex h-2.5 w-2.5 animate-ping rounded-full bg-brand opacity-75"}),(0,n.jsx)("span",{className:"relative inline-flex h-2.5 w-2.5 rounded-full bg-brand"})]})}),(0,n.jsx)(U.nA,{colSpan:t,className:"border-b border-r border-t text-foreground","data-sentry-element":"TableCell","data-sentry-source-file":"LiveRow.tsx",children:"Live Mode"})]})}var tI=a(72154),tR=a(1801),tF=a(14986),tq=a(38777),tH=a(96293),tP=a(81200),tO=a(44958);function tV(e){let{data:t,className:a,columnId:s,chartConfig:l}=e,{table:o}=I(),[i,d]=(0,r.useState)(null),[c,u]=(0,r.useState)(null),[m,g]=(0,r.useState)(!1),p=(0,r.useMemo)(()=>t.map(e=>({...e,[s]:new Date(e.timestamp).toString()})),[t]),f=(0,r.useMemo)(()=>{var e;if(0===t.length)return{interval:0,period:void 0};let a=Math.abs(t[0].timestamp-t[t.length-1].timestamp);return{interval:a,period:(e=a)<=6e5?"10m":e<=864e5?"1d":e<=6048e5?"1w":"1mo"}},[t]),x=e=>{if(i&&c){var t;let[e,a]=[i,c].sort((e,t)=>new Date(e).getTime()-new Date(t).getTime());null==(t=o.getColumn(s))||t.setFilterValue([new Date(e),new Date(a)])}d(null),u(null),g(!1)};return(0,n.jsx)(tO.at,{config:l,className:(0,w.cn)("aspect-auto h-[60px] w-full","[&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted/50","select-none",a),"data-sentry-element":"ChartContainer","data-sentry-component":"TimelineChart","data-sentry-source-file":"TimelineChart.tsx",children:(0,n.jsxs)(tR.E,{accessibilityLayer:!0,data:p,margin:{top:0,left:0,right:0,bottom:0},onMouseDown:e=>{e.activeLabel&&(d(e.activeLabel),g(!0))},onMouseMove:e=>{m&&e.activeLabel&&u(e.activeLabel)},onMouseUp:x,onMouseLeave:x,style:{cursor:"crosshair"},"data-sentry-element":"BarChart","data-sentry-source-file":"TimelineChart.tsx",children:[(0,n.jsx)(tF.d,{vertical:!1,"data-sentry-element":"CartesianGrid","data-sentry-source-file":"TimelineChart.tsx"}),(0,n.jsx)(tq.W,{dataKey:s,tickLine:!1,minTickGap:32,axisLine:!1,tickFormatter:e=>{let t=new Date(e);return isNaN(t.getTime())?"N/A":"10m"===f.period?(0,tI.default)(t,"HH:mm:ss"):"1d"===f.period?(0,tI.default)(t,"HH:mm"):"1w"===f.period?(0,tI.default)(t,"LLL dd HH:mm"):(0,tI.default)(t,"LLL dd, y")},"data-sentry-element":"XAxis","data-sentry-source-file":"TimelineChart.tsx"}),(0,n.jsx)(tO.II,{content:(0,n.jsx)(tO.Nt,{labelFormatter:e=>{let t=new Date(e);return isNaN(t.getTime())?"N/A":"10m"===f.period?(0,tI.default)(t,"LLL dd, HH:mm:ss"):(0,tI.default)(t,"LLL dd, y HH:mm")}}),"data-sentry-element":"ChartTooltip","data-sentry-source-file":"TimelineChart.tsx"}),(0,n.jsx)(tH.y,{dataKey:"error",stackId:"a",fill:"var(--color-error)","data-sentry-element":"Bar","data-sentry-source-file":"TimelineChart.tsx"}),(0,n.jsx)(tH.y,{dataKey:"warning",stackId:"a",fill:"var(--color-warning)","data-sentry-element":"Bar","data-sentry-source-file":"TimelineChart.tsx"}),(0,n.jsx)(tH.y,{dataKey:"success",stackId:"a",fill:"var(--color-success)","data-sentry-element":"Bar","data-sentry-source-file":"TimelineChart.tsx"}),i&&c&&(0,n.jsx)(tP.T,{x1:i,x2:c,strokeOpacity:.3,fill:"hsl(var(--foreground))",fillOpacity:.08})]})})}async function tM(e,t,a){let n,s,r,l,o,{projectRef:i,search:d}=e;if(void 0===i)throw Error("projectRef is required for getUnifiedLogsChart");if(d.date&&2===d.date.length){let e=e=>e instanceof Date?e:new Date(e);r=e(d.date[0]),l=e(d.date[1]),n=r.toISOString(),s=l.toISOString()}else n=(r=new Date((l=new Date).getTime()-36e5)).toISOString(),s=l.toISOString();let c=e2(d),u=new Headers(a),{data:m,error:g}=await (0,e1.bE)("/platform/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:i}},body:{sql:c,iso_timestamp_start:n,iso_timestamp_end:s},signal:t,headers:u});g&&(0,e1.H4)(g);let p=[],f=new Map;(null==m?void 0:m.result)&&m.result.forEach(e=>{let t=Math.floor(Number(e.time_bucket)/1e3),a={timestamp:t,success:Number(e.success)||0,warning:Number(e.warning)||0,error:Number(e.error)||0},n=d.level;n&&n.length>0&&(n.includes("success")||(a.success=0),n.includes("warning")||(a.warning=0),n.includes("error")||(a.error=0)),f.set(t,a)});let x=r.getTime(),h=l.getTime(),_=(h-x)/36e5;o=_>72?864e5:_>12?36e5:6e4;for(let e=x;e<=h;e+=o){let t=Math.floor(e/o)*o;f.has(t)||f.set(t,{timestamp:t,success:0,warning:0,error:0})}for(let e of f.values())p.push(e);return p.sort((e,t)=>e.timestamp-t.timestamp),p}let tz=function(e){let{projectRef:t,search:a}=e,{enabled:n=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,eH.I)(e4.unifiedLogsChart(t,a),e=>{let{signal:n}=e;return tM({projectRef:t,search:a},n)},{enabled:n&&void 0!==t,keepPreviousData:!0,...e3,...s})};async function tW(e,t){let{projectRef:a,search:n}=e;if(void 0===a)throw Error("projectRef is required for getUnifiedLogsCount");let s=e0(n),{isoTimestampStart:r,isoTimestampEnd:l}=e6(n),{data:o,error:i}=await (0,e1.bE)("/platform/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:a}},body:{iso_timestamp_start:r,iso_timestamp_end:l,sql:s},signal:t});i&&(0,e1.H4)(i);let d={},c={},u=0;return(null==o?void 0:o.result)&&o.result.forEach(e=>{let t=e.dimension,a=e.value,n=Number(e.count||0);"total"===t&&"all"===a&&(u=n),c[t]||(c[t]=new Map),c[t].set(a,n)}),Object.entries(c).forEach(e=>{let[t,a]=e;if("total"===t)return;let n=Array.from(a.values()).reduce((e,t)=>e+t,0);d[t]={total:n,rows:Array.from(a.entries()).map(e=>{let[t,a]=e;return{value:t,total:a}})}}),{totalRowCount:u,facets:d}}let tB=function(e){let{projectRef:t,search:a}=e,{enabled:n=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,eH.I)(e4.unifiedLogsCount(t,a),e=>{let{signal:n}=e;return tW({projectRef:t,search:a},n)},{enabled:n&&void 0!==t,...e3,...s})};var tU=a(14786);let tG=e=>{let{isLoading:t,onRefresh:a}=e;return(0,n.jsx)(ti.G,{size:"tiny",type:"outline",disabled:t,onClick:a,className:"w-[26px]",icon:t?(0,n.jsx)(v.A,{className:"text-foreground animate-spin"}):(0,n.jsx)(tU.A,{className:"text-foreground"}),tooltip:{content:{side:"bottom",text:"Refresh logs"}},"data-sentry-element":"ButtonTooltip","data-sentry-component":"RefreshButton","data-sentry-source-file":"RefreshButton.tsx"})};var tK=a(11462),tY=a(72259);let t$=e=>{let{column:t,title:a,className:s,...r}=e;return t.getCanSort()?(0,n.jsx)(B.$,{type:"text",size:"small",onClick:()=>{t.toggleSorting(void 0)},className:(0,w.cn)("text-xs","py-0 px-0 h-7 hover:bg-transparent flex gap-2 items-center justify-between w-full",s),iconRight:(0,n.jsxs)("span",{className:"flex flex-col",children:[(0,n.jsx)(tK.A,{className:(0,w.cn)("-mb-1 hover:text-foreground-lighter","asc"===t.getIsSorted()?"text-foreground":"text-foreground-muted")}),(0,n.jsx)(tY.A,{className:(0,w.cn)("-mt-1 hover:text-foreground-lighter","desc"===t.getIsSorted()?"text-foreground":"text-foreground-muted")})]}),...r,"data-sentry-element":"Button","data-sentry-component":"DataTableColumnHeader","data-sentry-source-file":"DataTableColumnHeader.tsx",children:(0,n.jsx)("span",{children:a})}):(0,n.jsx)("div",{className:(0,w.cn)(s),children:a})},tQ=e=>{let{value:t,className:a,dotClassName:s}=e;return(0,n.jsx)("div",{className:(0,w.cn)("flex items-center justify-center",a),"data-sentry-component":"DataTableColumnLevelIndicator","data-sentry-source-file":"DataTableColumnLevelIndicator.tsx",children:(0,n.jsx)("div",{className:(0,w.cn)("h-2.5 w-2.5 rounded-[2px]",_(t).bg,_(t).border,s)})})};var tJ=a(26107);let tX=e=>{let{value:t,level:a,className:s}=e,r=function(e){switch(e){case"1":case"info":return{text:"text-blue-500",bg:"",border:"border-blue-200 dark:border-blue-800"};case"2":case"success":return{text:"text-foreground-lighter",bg:"",border:"border-green-200 dark:border-green-800"};case"4":case"warning":case"redirect":return{text:"text-warning-600 dark:text-warning",bg:"bg-warning-300 dark:bg-waning-200",border:"border border-warning-400/50 dark:border-warning-400/50"};case"5":case"error":return{text:"text-destructive",bg:"bg-destructive-300 dark:bg-destructive-300/50",border:"border border-destructive-400/50 dark:border-destructive-400/50"};default:return{text:"text-foreground-lighter",bg:"",border:""}}}(a);return t?(0,n.jsx)("div",{className:(0,w.cn)("flex items-center relative",s),"data-sentry-component":"DataTableColumnStatusCode","data-sentry-source-file":"DataTableColumnStatusCode.tsx",children:(0,n.jsx)("div",{className:(0,w.cn)("px-1 py-[0.03rem] rounded-md","flex items-center justify-center relative font-mono",r.text,r.bg,r.border),children:t})}):(0,n.jsx)(tJ.A,{className:"h-4 w-4 text-muted-foreground/50"})};var tZ=a(14861);function t0(e){let{date:t,className:a}=e;return(0,n.jsx)("div",{className:(0,w.cn)("relative w-fit",a),"data-sentry-component":"HoverCardTimestamp","data-sentry-source-file":"HoverCardTimestamp.tsx",children:(0,n.jsx)(tZ.T,{utcTimestamp:t.getTime(),"data-sentry-element":"TimestampInfo","data-sentry-source-file":"HoverCardTimestamp.tsx"})})}var t2=a(39161),t1=a(33888),t4=a(52542),t5=a(90777);let t3=e=>{let{type:t,size:a=16,strokeWidth:s=1.5,className:r}=e,l={postgrest:()=>(0,n.jsx)(t2.A,{size:a,strokeWidth:s,className:r}),auth:()=>(0,n.jsx)(t5.Nj,{size:a,strokeWidth:s,className:r}),"edge function":()=>(0,n.jsx)(t5.n7,{size:a,strokeWidth:s,className:r}),postgres:()=>(0,n.jsx)(t1.A,{size:a,strokeWidth:s,className:r}),storage:()=>(0,n.jsx)(t5.wc,{size:a,strokeWidth:s,className:r})}[t]||(()=>(0,n.jsx)(t4.A,{size:a,strokeWidth:s,className:r}));return(0,n.jsxs)(en.m_,{"data-sentry-element":"Tooltip","data-sentry-component":"LogTypeIcon","data-sentry-source-file":"LogTypeIcon.tsx",children:[(0,n.jsx)(en.k$,{"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"LogTypeIcon.tsx",children:(0,n.jsx)(l,{"data-sentry-element":"IconComponent","data-sentry-source-file":"LogTypeIcon.tsx"})}),(0,n.jsx)(en.ZI,{side:"left","data-sentry-element":"TooltipContent","data-sentry-source-file":"LogTypeIcon.tsx",children:(0,n.jsx)("div",{className:"text-xs",children:t})})]})};function t6(e){let{text:t,className:a}=e,[s,l]=(0,r.useState)(!1),o=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let e=()=>{if(o.current){let{scrollWidth:e,clientWidth:t}=o.current;l(e>t)}},t=new ResizeObserver(()=>{e()});return o.current&&t.observe(o.current),e(),()=>{t.disconnect()}},[]),(0,n.jsx)(en.Bc,{delayDuration:100,disableHoverableContent:!0,"data-sentry-element":"TooltipProvider","data-sentry-component":"TextWithTooltip","data-sentry-source-file":"TextWithTooltip.tsx",children:(0,n.jsxs)(en.m_,{"data-sentry-element":"Tooltip","data-sentry-source-file":"TextWithTooltip.tsx",children:[(0,n.jsx)(en.k$,{disabled:!s,asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"TextWithTooltip.tsx",children:(0,n.jsx)("div",{ref:o,className:(0,w.cn)("truncate",!s&&"pointer-events-none",a),children:t})}),(0,n.jsx)(en.KL,{"data-sentry-element":"TooltipPortal","data-sentry-source-file":"TextWithTooltip.tsx",children:(0,n.jsx)(en.ZI,{"data-sentry-element":"TooltipContent","data-sentry-source-file":"TextWithTooltip.tsx",children:t})})]})})}function t8(e,t){return!!e&&0!==e.length&&e.every(e=>{let a=e[t];return!a||""===a||null==a})}function t9(e){let t=t8(e,"method"),a=t8(e,"pathname"),s=t8(e,"event_message");return{columns:[{accessorKey:"level",header:"",cell:e=>{let{row:t}=e,a=t.getValue("level");return(0,n.jsx)(tQ,{value:a})},enableHiding:!1,enableResizing:!1,enableSorting:!1,filterFn:(e,t,a)=>!0,size:48,minSize:48,maxSize:48,meta:{cellClassName:"w-[32px]",headerClassName:"w-[32px]"}},{accessorKey:"date",header:e=>{let{column:t}=e;return(0,n.jsx)(t$,{column:t,title:"Date"})},cell:e=>{let{row:t}=e,a=new Date(t.getValue("date"));return(0,n.jsx)(t0,{date:a})},filterFn:(e,t,a)=>!0,enableResizing:!1,enableSorting:!1,size:130,minSize:130,maxSize:130,meta:{cellClassName:"font-mono w-[130px]",headerClassName:"w-[130px]"}},{accessorKey:"log_type",header:"",cell:e=>{let{row:t}=e,a=t.getValue("log_type");return(0,n.jsx)("div",{className:"flex items-center justify-end gap-1",children:(0,n.jsx)(t3,{type:a,size:16,className:"text-foreground/70"})})},enableHiding:!1,filterFn:(e,t,a)=>!0,enableResizing:!1,enableSorting:!1,size:40,minSize:40,maxSize:40,meta:{cellClassName:"w-[32px]",headerClassName:"w-[32px]"}},{accessorKey:"status",header:"",cell:e=>{let{row:t}=e,a=t.getValue("status");return(0,n.jsx)("div",{className:"flex items-center gap-1",children:(0,n.jsx)(tX,{value:a,level:t.getValue("level")})})},filterFn:(e,t,a)=>!0,enableResizing:!1,enableSorting:!1,size:70,minSize:70,maxSize:70,meta:{cellClassName:"w-[70px]",headerClassName:"w-[70px]"}},{accessorKey:"method",header:"Method",filterFn:"arrIncludesSome",cell:e=>{let{row:t}=e,a=t.getValue("method");return(0,n.jsx)("span",{className:"text-foreground-lighter",children:a})},enableResizing:!1,enableSorting:!1,size:70,minSize:70,maxSize:70,meta:{cellClassName:"w-[70px]",headerClassName:"w-[70px]"}},{accessorKey:"pathname",header:"Pathname",cell:e=>{var t;let{row:a}=e,s=null!=(t=a.getValue("pathname"))?t:"";return(0,n.jsx)(t6,{text:s})},enableSorting:!1,enableResizing:!1,size:200,minSize:200,maxSize:200,meta:{cellClassName:"max-w-[320px]",headerClassName:"max-w-[320px]"}},{accessorKey:"event_message",header:e=>{let{column:t}=e;return(0,n.jsx)(t$,{column:t,title:"Event message"})},cell:e=>{let{row:t}=e,a=t.getValue("event_message"),s=t.original.log_count;return(0,n.jsxs)("div",{className:"flex flex-row gap-2 items-center",children:[s&&(0,n.jsxs)(en.m_,{children:[(0,n.jsx)(en.k$,{children:(0,n.jsx)("span",{className:"text-foreground-lighter bg-surface-400 px-[6px] py-[2px] h-fit rounded-md text-[0.8rem] leading-none",children:s})}),(0,n.jsxs)(en.ZI,{children:[s," ",1===s?"log":"logs"," for this execution"]})]}),a&&(0,n.jsx)("span",{className:"text-muted-foreground",children:(0,n.jsx)(t6,{text:a})})]})},enableResizing:!0,enableSorting:!1,size:200,minSize:200,maxSize:400}],columnVisibility:{method:!t,pathname:!a,event_message:!s}}}let t7=t9([]).columns;var ae=a(95137),at=a.n(ae),aa=a(67201),an=a(77191),as=a.n(an),ar=a(73969),al=a(80251);async function ao(e){var t;let{projectRef:a,search:n,limit:s,hoursAgo:r}=e;if(void 0===a)throw Error("projectRef is required for retrieveUnifiedLogs");let{isoTimestampStart:l,isoTimestampEnd:o}=e6(n,r),i="".concat(eQ(n)," ORDER BY timestamp DESC, id DESC LIMIT ").concat(s),{data:d,error:c}=await (0,e1.bE)("/platform/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:a}},body:{iso_timestamp_start:l,iso_timestamp_end:o,sql:i}});return c&&(0,e1.H4)(c),(null!=(t=null==d?void 0:d.result)?t:[]).map(e=>{let t=new Date(Number(e.timestamp)/1e3);return{id:e.id,date:t,timestamp:e.timestamp,level:e.level,status:e.status||200,method:e.method,host:e.host,pathname:(e.url||"").replace(/^https?:\/\/[^\/]+/,"")||e.pathname||"",event_message:e.event_message||e.body||"",headers:"string"==typeof e.headers?JSON.parse(e.headers||"{}"):e.headers||{},regions:e.region?[e.region]:[],log_type:e.log_type||"",latency:e.latency||0,log_count:e.log_count||null,logs:e.logs||[],auth_user:e.auth_user||null}})}let ai=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,al.n)(e=>ao(e),{async onSuccess(t,a,n){await (null==e?void 0:e(t,a,n))},async onError(e,a,n){void 0===t?ar.oR.error("Failed to retrieve logs: ".concat(e.message)):t(e,a,n)},...a})};var ad=a(71139),ac=a(16838),au=a(40990);let am=e=>{let{searchParameters:t}=e,{ref:a}=(0,l.g)(),[s,o]=(0,r.useState)("100"),[i,d]=(0,r.useState)("100"),[c,u]=(0,r.useState)(),{mutate:m,isLoading:g}=ai({onSuccess:e=>{if("json"===c){let t=new Blob([JSON.stringify(e,null,2)],{type:"text/json;charset=utf-8;"});at()(t,"supabase_logs.json"),ar.oR.success("Downloading logs as JSON")}else{if(0===e.length)return;let t=Object.keys(e[0]),a=e.map(e=>{let t={...e};return Object.keys(e).forEach(a=>{"object"==typeof e[a]&&(t[a]=JSON.stringify(e[a]))}),t}),n=new Blob([as().unparse(a,{columns:t})],{type:"text/csv;charset=utf-8;"});at()(n,"supabase_logs.csv"),ar.oR.success("Downloading logs as CSV")}u(void 0)}});return(0,r.useEffect)(()=>{c&&(o("100"),d("1"))},[c]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(ad.rI,{"data-sentry-element":"DropdownMenu","data-sentry-source-file":"DownloadLogsButton.tsx",children:[(0,n.jsx)(ad.ty,{"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"DownloadLogsButton.tsx",children:(0,n.jsx)(ti.G,{type:"outline",className:"w-[26px]",icon:(0,n.jsx)(aa.A,{className:"text-foreground"}),tooltip:{content:{side:"bottom",text:"Download logs"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"DownloadLogsButton.tsx"})}),(0,n.jsxs)(ad.SQ,{align:"end",className:"w-36","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"DownloadLogsButton.tsx",children:[(0,n.jsx)(ad._2,{onClick:()=>u("csv"),"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"DownloadLogsButton.tsx",children:(0,n.jsx)("p",{children:"Download as CSV"})}),(0,n.jsx)(ad._2,{onClick:()=>u("json"),"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"DownloadLogsButton.tsx",children:(0,n.jsx)("p",{children:"Download as JSON"})})]})]}),(0,n.jsx)(ac.lG,{open:!!c,onOpenChange:e=>{e||u(void 0)},"data-sentry-element":"Dialog","data-sentry-source-file":"DownloadLogsButton.tsx",children:(0,n.jsxs)(ac.Cf,{size:"small","data-sentry-element":"DialogContent","data-sentry-source-file":"DownloadLogsButton.tsx",children:[(0,n.jsxs)(ac.c7,{className:"border-b","data-sentry-element":"DialogHeader","data-sentry-source-file":"DownloadLogsButton.tsx",children:[(0,n.jsxs)(ac.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"DownloadLogsButton.tsx",children:["Download logs as ",null==c?void 0:c.toLocaleUpperCase()]}),(0,n.jsx)(ac.rr,{"data-sentry-element":"DialogDescription","data-sentry-source-file":"DownloadLogsButton.tsx",children:"Export your logs with the currently applied filters"})]}),(0,n.jsxs)(ac.OO,{className:"flex flex-col gap-y-2","data-sentry-element":"DialogSection","data-sentry-source-file":"DownloadLogsButton.tsx",children:[(0,n.jsxs)("div",{className:"flex justify-between gap-x-2",children:[(0,n.jsx)("p",{className:"text-sm mb-2",children:"Result limit for export"}),(0,n.jsxs)(au.l6,{value:s,onValueChange:o,"data-sentry-element":"Select_Shadcn_","data-sentry-source-file":"DownloadLogsButton.tsx",children:[(0,n.jsx)(au.bq,{className:"w-24","data-sentry-element":"SelectTrigger_Shadcn_","data-sentry-source-file":"DownloadLogsButton.tsx",children:(0,n.jsx)(au.yv,{"data-sentry-element":"SelectValue_Shadcn_","data-sentry-source-file":"DownloadLogsButton.tsx"})}),(0,n.jsxs)(au.gC,{"data-sentry-element":"SelectContent_Shadcn_","data-sentry-source-file":"DownloadLogsButton.tsx",children:[(0,n.jsx)(au.eb,{value:"100","data-sentry-element":"SelectItem_Shadcn_","data-sentry-source-file":"DownloadLogsButton.tsx",children:"100"}),(0,n.jsx)(au.eb,{value:"500","data-sentry-element":"SelectItem_Shadcn_","data-sentry-source-file":"DownloadLogsButton.tsx",children:"500"}),(0,n.jsx)(au.eb,{value:"1000","data-sentry-element":"SelectItem_Shadcn_","data-sentry-source-file":"DownloadLogsButton.tsx",children:"1000"})]})]})]}),!("date"in t)&&(0,n.jsxs)("div",{className:"flex justify-between gap-x-2",children:[(0,n.jsx)("p",{className:"text-sm mb-2",children:"Duration to retrieve"}),(0,n.jsxs)(au.l6,{value:i,onValueChange:d,children:[(0,n.jsx)(au.bq,{className:"w-36",children:(0,n.jsx)(au.yv,{})}),(0,n.jsxs)(au.gC,{children:[(0,n.jsx)(au.eb,{value:"1",children:"1 hour ago"}),(0,n.jsx)(au.eb,{value:"12",children:"12 hours ago"}),(0,n.jsx)(au.eb,{value:"24",children:"24 hours ago"})]})]})]})]}),(0,n.jsxs)(ac.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"DownloadLogsButton.tsx",children:[(0,n.jsx)(B.$,{type:"default",disabled:g,onClick:()=>u(void 0),"data-sentry-element":"Button","data-sentry-source-file":"DownloadLogsButton.tsx",children:"Cancel"}),(0,n.jsx)(B.$,{type:"primary",loading:g,onClick:()=>{if(!a)return console.error("Project ref is required");let e="date"in t;m({projectRef:a,search:t,limit:Number(s),hoursAgo:e?void 0:Number(i)})},"data-sentry-element":"Button","data-sentry-source-file":"DownloadLogsButton.tsx",children:"Export"})]})]})})]})};var ag=a(55006);let ap=e=>{let{logs:t=[]}=e;return t&&0!==t.length?(0,n.jsx)("div",{className:"flex flex-col h-full overflow-auto","data-sentry-component":"LogsList","data-sentry-source-file":"LogsList.tsx",children:(0,n.jsx)("div",{className:"text-sm font-mono",children:t.map(e=>{let t=new Date(Number(e.timestamp)/1e3),a=e.event_message.split("\n").filter(e=>e.length>0);return(0,n.jsx)("div",{className:"group py-1.5 px-4 border-b border-border last:border-0",children:(0,n.jsxs)("div",{className:"flex items-start gap-5",children:[(0,n.jsxs)("div",{className:"flex flex-row items-center gap-5 flex-shrink-0",children:[(0,n.jsx)(t0,{date:t,className:"flex-shrink-0"}),(0,n.jsx)(tX,{value:e.level,level:e.level,className:"min-w-20 flex-shrink-0"})]}),(0,n.jsxs)("div",{className:"w-full grow relative mt-1 whitespace-pre-wrap break-all pl-2 text-[0.75rem] flex-shrink-0",children:[a.map((e,t)=>(0,n.jsx)("pre",{className:"font-mono w-full",children:e},"message-".concat(t))),(0,n.jsx)(ag.A,{iconOnly:!0,type:"default",text:e.event_message,className:"absolute top-[5px] right-2 z-10 opacity-0 group-hover:opacity-100 transition"})]})]})},e.id)})})}):(0,n.jsx)("div",{className:"flex flex-col items-center justify-center h-full p-6",children:(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:"No function logs found"})})},af=e=>{var t,a,s,l,o,i;let{selectedRow:d}=e,[c,u]=(0,r.useState)(!0);return(null==d||null==(t=d.original)?void 0:t.logs)&&d.original.logs.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(tS.WM,{withHandle:!0,disabled:!c}),(0,n.jsx)(tS.wV,{order:2,defaultSize:1,maxSize:50,minSize:c?16:12,className:(0,w.cn)(c?"h-min-16 h-max-32":"!h-12 max-h-12"),children:(0,n.jsxs)("div",{className:"h-full flex flex-col overflow-hidden",children:[(0,n.jsxs)("div",{className:"min-h-12 flex justify-between items-center px-5",children:[(0,n.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,n.jsx)("h3",{className:"text-sm font-medium",children:"Event logs"}),(0,n.jsx)("span",{className:"text-muted-foreground text-xs bg-muted rounded-md px-1.5 py-0.5",children:(null==d||null==(a=d.original)?void 0:a.logs)&&Array.isArray(null==d||null==(s=d.original)?void 0:s.logs)?null==d||null==(o=d.original)||null==(l=o.logs)?void 0:l.length:0})]}),(0,n.jsx)(B.$,{type:"default",onClick:()=>u(!c),icon:(0,n.jsx)(tY.A,{className:(0,w.cn)("w-4 h-4",c?"rotate-0":"rotate-180")}),children:c?"Close":"Open"})]}),c&&(0,n.jsx)("div",{className:"flex-grow overflow-auto border-t",children:(0,n.jsx)(ap,{logs:null==d||null==(i=d.original)?void 0:i.logs})})]})})]})},ax={postgrest:{pathFilter:"%/rest/%"},auth:{pathFilter:"%/auth/%"},"edge-function":{pathFilter:"%/functions/%"},storage:{pathFilter:"%/storage/%"}},ah=(e,t)=>(ax[t],"\n  select \n      id,\n      el.timestamp as timestamp,\n      '".concat(t,"' as log_type,\n      CAST(edge_logs_response.status_code AS STRING) as status,\n      CASE\n        WHEN edge_logs_response.status_code BETWEEN 200 AND 299 THEN 'success'\n        WHEN edge_logs_response.status_code BETWEEN 400 AND 499 THEN 'warning'\n        WHEN edge_logs_response.status_code >= 500 THEN 'error'\n        ELSE 'success'\n      END as level,\n      \n      -- Request data\n      edge_logs_request.path as request_path,\n      edge_logs_request.host as request_host, \n      edge_logs_request.method as request_method,\n      edge_logs_request.url as request_url,\n      edge_logs_request.search as request_search,\n      \n      -- Response data\n      edge_logs_response.origin_time as response_origin_time,\n      edge_logs_response_headers.content_type as response_content_type,\n      edge_logs_response_headers.cf_cache_status as response_cache_status,\n      \n      -- Client location data\n      edge_logs_cf.continent as client_continent,\n      edge_logs_cf.country as client_country, \n      edge_logs_cf.city as client_city,\n      edge_logs_cf.region as client_region,\n      edge_logs_cf.regionCode as client_region_code,\n      edge_logs_cf.latitude as client_latitude,\n      edge_logs_cf.longitude as client_longitude, \n      edge_logs_cf.timezone as client_timezone,\n      \n      -- Network data\n      edge_logs_cf.httpProtocol as network_protocol,\n      edge_logs_cf.colo as network_datacenter,\n      \n      -- Request headers\n      edge_logs_request_headers.user_agent as headers_user_agent,\n      edge_logs_request_headers.x_client_info as headers_x_client_info,\n      edge_logs_request_headers.x_forwarded_proto as headers_x_forwarded_proto,\n      edge_logs_request_headers.x_real_ip as headers_x_real_ip,\n      edge_logs_request_headers.referer as headers_referer,\n      \n      -- Auth data\n      authorization_payload.role as api_role,\n      COALESCE(sb.auth_user, null) as auth_user,\n      \n      -- JWT Key Authentication (old keys)\n      CASE\n          WHEN apikey_payload.algorithm = 'HS256' AND \n               apikey_payload.issuer = 'supabase' AND \n               apikey_payload.role IN ('anon', 'service_role')\n          THEN apikey_payload.role\n          WHEN apikey_payload IS NOT NULL THEN '<unrecognized>'\n          ELSE NULL\n      END as jwt_key_role,\n      \n      apikey_payload.signature_prefix as jwt_key_prefix,\n      \n      -- API Key Authentication (new keys from sb.apikey[0].apikey[0])\n      CASE \n          WHEN sb_apikey_inner.prefix LIKE '%publishable%' THEN 'anon'\n          WHEN sb_apikey_inner.prefix LIKE '%secret%' THEN 'service_role'\n          WHEN sb_apikey_inner.prefix IS NOT NULL THEN 'unknown'\n          ELSE NULL\n      END as api_key_role,\n      \n      sb_apikey_inner.prefix as api_key_prefix,\n      sb_apikey_inner.error as api_key_error,\n      sb_apikey_inner.hash as api_key_hash,\n      \n      -- User Authorization \n      authorization_payload.role as authorization_role,\n      null as user_id,\n      null as user_email,\n      \n      -- Cloudflare Network Info\n      edge_logs_response_headers.cf_ray as cf_ray,\n      edge_logs_request_headers.cf_ipcountry as cf_country,\n      edge_logs_cf.colo as cf_datacenter,\n      edge_logs_request_headers.cf_connecting_ip as client_ip,\n      \n      -- JWT data\n      apikey_payload.role as jwt_apikey_role,\n      apikey_payload.algorithm as jwt_apikey_algorithm, \n      apikey_payload.expires_at as jwt_apikey_expires_at,\n      apikey_payload.issuer as jwt_apikey_issuer,\n      apikey_payload.signature_prefix as jwt_apikey_signature_prefix,\n      null as jwt_apikey_key_id,\n      null as jwt_apikey_session_id,\n      apikey_payload.subject as jwt_apikey_subject,\n      \n      authorization_payload.role as jwt_auth_role,\n      authorization_payload.algorithm as jwt_auth_algorithm,\n      authorization_payload.expires_at as jwt_auth_expires_at, \n      authorization_payload.issuer as jwt_auth_issuer,\n      authorization_payload.signature_prefix as jwt_auth_signature_prefix,\n      authorization_payload.key_id as jwt_auth_key_id,\n      authorization_payload.session_id as jwt_auth_session_id,\n      authorization_payload.subject as jwt_auth_subject,\n      \n      -- Storage specific data (included for all but only populated for storage)\n      edge_logs_response_headers.sb_gateway_mode as storage_edge_gateway_mode,\n      edge_logs_response_headers.sb_gateway_version as storage_edge_gateway_version,\n      edge_logs_response_headers.cf_ray as correlation_cf_ray,\n      \n      -- Raw data\n      el as raw_log_data\n      \n    from edge_logs as el\n    cross join unnest(metadata) as edge_logs_metadata\n    cross join unnest(edge_logs_metadata.request) as edge_logs_request\n    cross join unnest(edge_logs_metadata.response) as edge_logs_response\n    left join unnest(edge_logs_response.headers) as edge_logs_response_headers\n    left join unnest(edge_logs_request.headers) as edge_logs_request_headers\n    left join unnest(edge_logs_request.cf) as edge_logs_cf\n    left join unnest(edge_logs_request.sb) as sb\n    left join unnest(sb.jwt) as jwt\n    left join unnest(COALESCE(jwt.apikey, [])) as apikey\n    left join unnest(COALESCE(apikey.payload, [])) as apikey_payload\n    left join unnest(COALESCE(jwt.authorization, [])) as auth\n    left join unnest(COALESCE(auth.payload, [])) as authorization_payload\n    left join unnest(COALESCE(sb.apikey, [])) as sb_apikey_outer\n    left join unnest(COALESCE(sb_apikey_outer.apikey, [])) as sb_apikey_inner\n\nWHERE \n  el.id = '").concat(e,"'\n")),a_=e=>ah(e,"postgrest"),ay=e=>ah(e,"auth"),av=e=>"\n  select \n      fel.id as id,\n      fel.timestamp as timestamp,\n      'edge-function' as log_type,\n      CAST(fel_response.status_code AS STRING) as status,\n      CASE\n          WHEN fel_response.status_code BETWEEN 200 AND 299 THEN 'success'\n          WHEN fel_response.status_code BETWEEN 400 AND 499 THEN 'warning'\n          WHEN fel_response.status_code >= 500 THEN 'error'\n          ELSE 'success'\n      END as level,\n      \n      -- Request data\n      fel_request.pathname as request_path,\n      fel_request.host as request_host, \n      fel_request.method as request_method,\n      fel_request.url as request_url,\n      fel_request.search as request_search,\n      fel_request.protocol as request_protocol,\n      fel_request.port as request_port,\n      \n      -- Response data (no origin_time in function_edge_logs)\n      fel_response_headers.content_type as response_content_type,\n      fel_response_headers.content_length as response_content_length,\n      fel_response_headers.date as response_date,\n      fel_response_headers.server as response_server,\n      fel_response_headers.x_sb_edge_region as response_edge_region,\n      fel_response_headers.x_sb_compute_multiplier as response_compute_multiplier,\n      fel_response_headers.x_sb_resource_multiplier as response_resource_multiplier,\n      fel_response_headers.x_served_by as response_served_by,\n      \n      -- Function specific data\n      fel_metadata.execution_id as execution_id,\n      fel_metadata.function_id as function_id,\n      fel_metadata.deployment_id as deployment_id,\n      fel_metadata.execution_time_ms as execution_time_ms,\n      fel_metadata.project_ref as project_ref,\n      fel_metadata.version as function_version,\n      \n      -- Request headers\n      fel_request_headers.user_agent as headers_user_agent,\n      fel_request_headers.x_client_info as headers_x_client_info,\n      fel_request_headers.accept as headers_accept,\n      fel_request_headers.accept_encoding as headers_accept_encoding,\n      fel_request_headers.connection as headers_connection,\n      fel_request_headers.cookie as headers_cookie,\n      fel_request_headers.host as headers_host,\n      \n      -- Auth data\n      authorization_payload.role as api_role,\n      COALESCE(sb.auth_user, null) as auth_user,\n      \n      -- JWT Key Authentication (old keys)\n      CASE\n          WHEN apikey_payload.algorithm = 'HS256' AND \n               apikey_payload.issuer = 'supabase' AND \n               apikey_payload.role IN ('anon', 'service_role')\n          THEN apikey_payload.role\n          WHEN apikey_payload IS NOT NULL THEN '<unrecognized>'\n          ELSE NULL\n      END as jwt_key_role,\n      \n      apikey_payload.signature_prefix as jwt_key_prefix,\n      \n      -- API Key Authentication (new keys from sb.apikey[0].apikey[0])\n      CASE \n          WHEN sb_apikey_inner.prefix LIKE '%publishable%' THEN 'anon'\n          WHEN sb_apikey_inner.prefix LIKE '%secret%' THEN 'service_role'\n          WHEN sb_apikey_inner.prefix IS NOT NULL THEN 'unknown'\n          ELSE NULL\n      END as api_key_role,\n      \n      sb_apikey_inner.prefix as api_key_prefix,\n      sb_apikey_inner.error as api_key_error,\n      sb_apikey_inner.hash as api_key_hash,\n      \n      -- User Authorization \n      authorization_payload.role as authorization_role,\n      null as user_id,\n      null as user_email,\n      \n      -- JWT data\n      apikey_payload.role as jwt_apikey_role,\n      apikey_payload.algorithm as jwt_apikey_algorithm, \n      apikey_payload.expires_at as jwt_apikey_expires_at,\n      apikey_payload.issuer as jwt_apikey_issuer,\n      apikey_payload.signature_prefix as jwt_apikey_signature_prefix,\n      null as jwt_apikey_key_id,\n      null as jwt_apikey_session_id,\n      apikey_payload.subject as jwt_apikey_subject,\n      \n      authorization_payload.role as jwt_auth_role,\n      authorization_payload.algorithm as jwt_auth_algorithm,\n      authorization_payload.expires_at as jwt_auth_expires_at, \n      authorization_payload.issuer as jwt_auth_issuer,\n      authorization_payload.signature_prefix as jwt_auth_signature_prefix,\n      authorization_payload.key_id as jwt_auth_key_id,\n      authorization_payload.session_id as jwt_auth_session_id,\n      authorization_payload.subject as jwt_auth_subject,\n      \n      -- Function logs aggregation\n      function_logs_agg.function_log_count as function_log_count,\n      function_logs_agg.logs as function_logs,\n      function_logs_agg.last_event_message as last_event_message,\n      \n      -- Raw data\n      fel as raw_log_data\n      \n    from function_edge_logs as fel\n    cross join unnest(metadata) as fel_metadata\n    cross join unnest(fel_metadata.response) as fel_response\n    cross join unnest(fel_metadata.request) as fel_request\n    left join unnest(fel_response.headers) as fel_response_headers\n    left join unnest(fel_request.headers) as fel_request_headers\n    left join unnest(fel_request.sb) as sb\n    left join unnest(sb.jwt) as jwt\n    left join unnest(COALESCE(jwt.apikey, [])) as apikey\n    left join unnest(COALESCE(apikey.payload, [])) as apikey_payload\n    left join unnest(COALESCE(jwt.authorization, [])) as auth\n    left join unnest(COALESCE(auth.payload, [])) as authorization_payload\n    left join unnest(COALESCE(sb.apikey, [])) as sb_apikey_outer\n    left join unnest(COALESCE(sb_apikey_outer.apikey, [])) as sb_apikey_inner\n    left join (\n      SELECT\n          fl_metadata.execution_id,\n          COUNT(fl.id) as function_log_count,\n          ANY_VALUE(fl.event_message) as last_event_message,\n          ARRAY_AGG(STRUCT(fl.id, fl.timestamp, fl.event_message, fl_metadata.level, fl_metadata.event_type)) as logs\n      FROM function_logs as fl\n      CROSS JOIN UNNEST(fl.metadata) as fl_metadata\n      WHERE fl_metadata.execution_id IS NOT NULL\n      GROUP BY fl_metadata.execution_id\n    ) as function_logs_agg on fel_metadata.execution_id = function_logs_agg.execution_id\n\nWHERE \n  fel.id = '".concat(e,"'\n"),ab=e=>ah(e,"storage"),aj=e=>"\n  select \n      pgl.id as id,\n      pgl.timestamp as timestamp,\n      'postgres' as log_type,\n      pgl_parsed.sql_state_code as status,\n      CASE\n          WHEN pgl_parsed.error_severity = 'LOG' THEN 'success'\n          WHEN pgl_parsed.error_severity = 'WARNING' THEN 'warning'\n          WHEN pgl_parsed.error_severity = 'FATAL' THEN 'error'\n          WHEN pgl_parsed.error_severity = 'ERROR' THEN 'error'\n          ELSE 'success'\n      END as level,\n      \n      -- Database connection details\n      pgl_parsed.database_name as database_name,\n      pgl_parsed.user_name as database_user,\n      pgl_parsed.connection_from as connection_from,\n      pgl_metadata.host as database_host,\n      \n      -- Query/Operation details\n      pgl_parsed.command_tag as command_tag,\n      pgl_parsed.backend_type as backend_type,\n      pgl_parsed.query_id as query_id,\n      \n      -- Session details\n      pgl_parsed.session_id as session_id,\n      pgl_parsed.process_id as process_id,\n      pgl_parsed.virtual_transaction_id as virtual_transaction_id,\n      pgl_parsed.transaction_id as transaction_id,\n      pgl_parsed.session_start_time as session_start_time,\n      pgl_parsed.session_line_num as session_line_num,\n      \n      -- Error/Status details\n      pgl_parsed.error_severity as error_severity,\n      pgl_parsed.sql_state_code as sql_state_code,\n      pgl.event_message as event_message,\n      \n      -- Timing\n      pgl_parsed.timestamp as operation_timestamp,\n      \n      -- Raw data\n      pgl as raw_log_data\n      \n    from postgres_logs as pgl\n    cross join unnest(pgl.metadata) as pgl_metadata\n    cross join unnest(pgl_metadata.parsed) as pgl_parsed\n    \nWHERE \n  pgl.id = '".concat(e,"'\n");async function aN(e,t){let{projectRef:a,logId:n,type:s,search:r}=e;if(!a)throw Error("projectRef is required");if(!n)throw Error("logId is required");if(!s)throw Error("type is required");let l="";switch(s){case"postgrest":l=a_(n);break;case"auth":l=ay(n);break;case"edge-function":l=av(n);break;case"storage":l=ab(n);break;case"postgres":l=aj(n);break;default:throw Error("Invalid type")}let{isoTimestampStart:o,isoTimestampEnd:i}=e6(r),{data:d,error:c}=await (0,e1.bE)("/platform/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:a}},body:{iso_timestamp_start:o,iso_timestamp_end:i,sql:l},signal:t});return c&&(0,e1.H4)(c),d}let aw=function(e){let{projectRef:t,logId:a,type:n,search:s}=e,{enabled:r=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,eH.I)(e4.serviceFlow(t,s,a),e=>{let{signal:r}=e;return aN({projectRef:t,logId:a,type:n,search:s},r)},{enabled:r&&void 0!==t,...e3,...l})};var aE=a(80586),aS=a(55501),aD=a(34531);let aT=(e,t)=>{let a=null==t?void 0:t.storage_metadata;if(a)return a;let n=null==e?void 0:e.metadata;return n||{}},aC=e=>{if(!e)return"";let t=e.split("?")[0].split("#")[0].split("/");return t[t.length-1]||""},ak=e=>{try{return new Date(e).toLocaleString()}catch(t){return e}},aA=[{id:"host",label:"Host",getValue:(e,t)=>(null==t?void 0:t.request_host)||(null==t?void 0:t.host)||(null==e?void 0:e.host)},{id:"method",label:"Method",getValue:(e,t)=>(null==t?void 0:t.request_method)||(null==t?void 0:t.method)||(null==e?void 0:e.method)},{id:"pathname",label:"Path",getValue:(e,t)=>(null==t?void 0:t.request_path)||(null==t?void 0:t.pathname)||(null==e?void 0:e.pathname)},{id:"user_agent",label:"Client",getValue:(e,t)=>{let a=null==t?void 0:t.headers_user_agent;return a?a.length>50?a.substring(0,50)+"...":a:null},requiresEnrichedData:!0}],aL=[{id:"api_key_prefix_full",label:"API Key Prefix",getValue:(e,t)=>(null==t?void 0:t.api_key_prefix)||null,requiresEnrichedData:!0},{id:"postgres_role",label:"Postgres Role",getValue:(e,t)=>null==t?void 0:t.jwt_key_role,requiresEnrichedData:!0},{id:"api_key_error",label:"API Key Error",getValue:(e,t)=>null==t?void 0:t.api_key_error,requiresEnrichedData:!0},{id:"api_key_hash",label:"API Key Hash",getValue:(e,t)=>{let a=null==t?void 0:t.api_key_hash;return a?"".concat(a.substring(0,12),"..."):null},requiresEnrichedData:!0},{id:"authorization_role",label:"Postgres Role",getValue:(e,t)=>null==t?void 0:t.authorization_role,requiresEnrichedData:!0}],aI=[{id:"auth_user",label:"Auth User",getValue:(e,t)=>(null==t?void 0:t.auth_user)||(null==e?void 0:e.auth_user)},{id:"user_email",label:"User Email",getValue:(e,t)=>null==t?void 0:t.user_email,requiresEnrichedData:!0}],aR=[{id:"client_continent",label:"Continent",getValue:(e,t)=>null==t?void 0:t.client_continent,requiresEnrichedData:!0},{id:"client_region",label:"Region",getValue:(e,t)=>null==t?void 0:t.client_region,requiresEnrichedData:!0},{id:"client_timezone",label:"Timezone",getValue:(e,t)=>null==t?void 0:t.client_timezone,requiresEnrichedData:!0},{id:"x_real_ip",label:"Real IP",getValue:(e,t)=>null==t?void 0:t.headers_x_real_ip,requiresEnrichedData:!0},{id:"client_ip",label:"Client IP",getValue:(e,t)=>null==t?void 0:t.client_ip,requiresEnrichedData:!0}],aF=[{id:"jwt_auth_key_id",label:"Key ID",getValue:(e,t)=>(null==t?void 0:t.jwt_auth_key_id)||(null==t?void 0:t.jwt_apikey_key_id),requiresEnrichedData:!0},{id:"jwt_auth_session_id",label:"Session ID",getValue:(e,t)=>(null==t?void 0:t.jwt_auth_session_id)||(null==t?void 0:t.jwt_apikey_session_id),requiresEnrichedData:!0},{id:"jwt_auth_subject",label:"Subject",getValue:(e,t)=>(null==t?void 0:t.jwt_auth_subject)||(null==t?void 0:t.jwt_apikey_subject),requiresEnrichedData:!0},{id:"jwt_auth_issuer",label:"Issuer",getValue:(e,t)=>(null==t?void 0:t.jwt_auth_issuer)||(null==t?void 0:t.jwt_apikey_issuer),requiresEnrichedData:!0},{id:"jwt_auth_algorithm",label:"Algorithm",getValue:(e,t)=>(null==t?void 0:t.jwt_auth_algorithm)||(null==t?void 0:t.jwt_apikey_algorithm),requiresEnrichedData:!0},{id:"jwt_auth_expires_at",label:"Expires At",getValue:(e,t)=>{let a=(null==t?void 0:t.jwt_auth_expires_at)||(null==t?void 0:t.jwt_apikey_expires_at);if(!a)return null;try{return new Date(1e3*a).toLocaleString()}catch(e){return a}},requiresEnrichedData:!0}],aq=[{id:"network_protocol",label:"Protocol",getValue:(e,t)=>null==t?void 0:t.network_protocol,requiresEnrichedData:!0},{id:"cf_datacenter",label:"Datacenter",getValue:(e,t)=>(null==t?void 0:t.network_datacenter)||(null==t?void 0:t.cf_datacenter),requiresEnrichedData:!0},{id:"cache_status",label:"Cache Status",getValue:(e,t)=>null==t?void 0:t.response_cache_status,requiresEnrichedData:!0},{id:"cf_ray",label:"CF-Ray",getValue:(e,t)=>null==t?void 0:t.cf_ray,requiresEnrichedData:!0},{id:"x_client_info",label:"SDK",getValue:(e,t)=>null==t?void 0:t.headers_x_client_info,requiresEnrichedData:!0},{id:"x_forwarded_proto",label:"Forwarded Proto",getValue:(e,t)=>null==t?void 0:t.headers_x_forwarded_proto,requiresEnrichedData:!0}],aH=[{id:"status",label:"Status",getValue:(e,t)=>(null==t?void 0:t.status)||(null==e?void 0:e.status)},{id:"postgres_role",label:"Postgres Role",getValue:(e,t)=>null==t?void 0:t.api_role,requiresEnrichedData:!0},{id:"response_time",label:"Response Time",getValue:(e,t)=>{let a=(null==t?void 0:t.response_origin_time)||(null==e?void 0:e.response_time_ms);return a?"".concat(a,"ms"):null},requiresEnrichedData:!0}],aP=[{id:"query_params",label:"Query",getValue:(e,t)=>null==t?void 0:t.request_search,requiresEnrichedData:!0},{id:"content_type",label:"Content Type",getValue:(e,t)=>null==t?void 0:t.response_content_type,requiresEnrichedData:!0},{id:"message",label:"Message",getValue:(e,t)=>null==t?void 0:t.message,requiresEnrichedData:!0}],aO=[{id:"auth_path",label:"Auth Path",getValue:(e,t)=>(null==t?void 0:t.path)||(null==t?void 0:t.request_path)||(null==e?void 0:e.path),requiresEnrichedData:!0},{id:"log_id",label:"Log ID",getValue:(e,t)=>{let a=(null==e?void 0:e.id)||(null==t?void 0:t.id);return a?"".concat(a.substring(0,8),"..."):null}},{id:"referer",label:"Referer",getValue:(e,t)=>(null==t?void 0:t.headers_referer)||null,requiresEnrichedData:!0}],aV=[{id:"status",label:"Status",getValue:(e,t)=>(null==t?void 0:t.status)||(null==e?void 0:e.status)},{id:"function_path",label:"Function Path",getValue:(e,t)=>(null==t?void 0:t.path)||(null==t?void 0:t.request_path)||(null==e?void 0:e.path)||(null==t?void 0:t.request_url),requiresEnrichedData:!1},{id:"execution_time",label:"Execution Time",getValue:(e,t)=>{let a=(null==t?void 0:t.execution_time_ms)||(null==e?void 0:e.execution_time_ms);return a?"".concat(a,"ms"):null},requiresEnrichedData:!1},{id:"execution_id",label:"Execution ID",getValue:(e,t)=>{let a=(null==t?void 0:t.execution_id)||(null==e?void 0:e.execution_id);return a?"".concat(a.substring(0,8),"..."):null},requiresEnrichedData:!1}],aM=[{id:"function_id",label:"Function ID",getValue:(e,t)=>{let a=(null==t?void 0:t.function_id)||(null==e?void 0:e.function_id);return a?"".concat(a.substring(0,8),"..."):null},requiresEnrichedData:!1},{id:"execution_region",label:"Execution Region",getValue:(e,t)=>(null==t?void 0:t.execution_region)||(null==e?void 0:e.execution_region)||null,requiresEnrichedData:!1},{id:"function_log_count",label:"Function Logs",getValue:(e,t)=>{let a=(null==t?void 0:t.function_log_count)||(null==e?void 0:e.function_log_count)||(null==e?void 0:e.log_count);return a?"".concat(a," logs"):"No logs"},requiresEnrichedData:!1},{id:"method",label:"Method",getValue:(e,t)=>(null==t?void 0:t.method)||(null==e?void 0:e.method),requiresEnrichedData:!1},{id:"user_agent",label:"User Agent",getValue:(e,t)=>{let a=(null==t?void 0:t.headers_user_agent)||(null==e?void 0:e.headers_user_agent);return a?a.length>30?"".concat(a.substring(0,30),"..."):a:null},requiresEnrichedData:!1}],az=[{id:"status",label:"Status",getValue:(e,t)=>(null==t?void 0:t.status)||(null==e?void 0:e.status)},{id:"filename",label:"File Name",getValue:(e,t)=>{let a=(null==t?void 0:t.path)||(null==t?void 0:t.request_path)||(null==e?void 0:e.path);return a?aC(a):null},requiresEnrichedData:!1},{id:"content_type_size",label:"Type & Size",getValue:(e,t)=>{let a=(null==t?void 0:t.status)||(null==e?void 0:e.status),n=a&&Number(a)>=400;if(404===a||"404"===a)return"Object deleted";if(n)return"Error ".concat(a);let s=aT(e,t),r=null==s?void 0:s.mimetype,l=null==s?void 0:s.size,o=r||(null==t?void 0:t.response_content_type)||(null==t?void 0:t.storage_request_content_type),i=l||((null==t?void 0:t.storage_content_length)?parseInt(t.storage_content_length):null);return o&&i?"".concat(o," - ").concat((0,aD.z3)(i)):o?o:i?(0,aD.z3)(i):"Unknown type"},requiresEnrichedData:!0},{id:"response_time",label:"Response Time",getValue:(e,t)=>{let a=(null==t?void 0:t.response_origin_time)||(null==e?void 0:e.response_time_ms);return a?"".concat(a,"ms"):null},requiresEnrichedData:!0}],aW=[{id:"storage_path",label:"Storage Path",getValue:(e,t)=>{let a=(null==t?void 0:t.path)||(null==t?void 0:t.request_path)||(null==e?void 0:e.path),n=null==a?void 0:a.match(/\/storage\/v1\/object\/([^\/]+)\/(.+)/);if(n){let[,e,t]=n;return"".concat(e,"/").concat(t)}return a},requiresEnrichedData:!1},{id:"last_modified",label:"Last Modified",getValue:(e,t)=>{let a=(null==t?void 0:t.status)||(null==e?void 0:e.status),n=a&&Number(a)>=400;if(404===a||"404"===a)return"Object deleted";if(n)return"Unavailable";let s=aT(e,t),r=(null==s?void 0:s.updated_at)||(null==e?void 0:e.updated_at)||(null==t?void 0:t.updated_at),l=(null==t?void 0:t.storage_last_modified)||r;return l?ak(l):null},requiresEnrichedData:!0},{id:"etag",label:"ETag",getValue:(e,t)=>{let a=(null==t?void 0:t.status)||(null==e?void 0:e.status),n=a&&Number(a)>=400;if(404===a||"404"===a)return"Object deleted";if(n)return"Unavailable";let s=null==t?void 0:t.storage_etag;return s?"".concat(s.substring(0,12),"..."):null},requiresEnrichedData:!0},{id:"content_disposition",label:"Content Disposition",getValue:(e,t)=>{let a=(null==t?void 0:t.status)||(null==e?void 0:e.status),n=a&&Number(a)>=400;return 404===a||"404"===a?"Object deleted":n?"Unavailable":(null==t?void 0:t.storage_content_disposition)||null},requiresEnrichedData:!0},{id:"method",label:"Method",getValue:(e,t)=>(null==t?void 0:t.method)||(null==e?void 0:e.method),requiresEnrichedData:!1},{id:"user_agent",label:"User Agent",getValue:(e,t)=>{let a=(null==t?void 0:t.headers_user_agent)||(null==e?void 0:e.headers_user_agent);return a?a.length>30?"".concat(a.substring(0,30),"..."):a:null},requiresEnrichedData:!1}],aB=[{id:"status",label:"Status",getValue:(e,t)=>(null==t?void 0:t.status)||(null==e?void 0:e.status)},{id:"command_tag",label:"Command",getValue:(e,t)=>(null==t?void 0:t.command_tag)||(null==e?void 0:e.command_tag),requiresEnrichedData:!0},{id:"database_name",label:"Database",getValue:(e,t)=>(null==t?void 0:t.database_name)||(null==e?void 0:e.database_name),requiresEnrichedData:!0},{id:"database_user",label:"User",getValue:(e,t)=>(null==t?void 0:t.database_user)||(null==e?void 0:e.database_user),requiresEnrichedData:!0}],aU=[{id:"backend_type",label:"Backend Type",getValue:(e,t)=>(null==t?void 0:t.backend_type)||(null==e?void 0:e.backend_type),requiresEnrichedData:!0},{id:"connection_from",label:"Connection From",getValue:(e,t)=>(null==t?void 0:t.connection_from)||(null==e?void 0:e.connection_from),requiresEnrichedData:!0},{id:"session_id",label:"Session ID",getValue:(e,t)=>{let a=(null==t?void 0:t.session_id)||(null==e?void 0:e.session_id);return a?"".concat(a.substring(0,12),"..."):null},requiresEnrichedData:!0},{id:"process_id",label:"Process ID",getValue:(e,t)=>(null==t?void 0:t.process_id)||(null==e?void 0:e.process_id),requiresEnrichedData:!0},{id:"query_id",label:"Query ID",getValue:(e,t)=>{let a=(null==t?void 0:t.query_id)||(null==e?void 0:e.query_id);return a?String(a):null},requiresEnrichedData:!0},{id:"transaction_id",label:"Transaction ID",getValue:(e,t)=>{let a=(null==t?void 0:t.transaction_id)||(null==e?void 0:e.transaction_id);return a?String(a):null},requiresEnrichedData:!0},{id:"virtual_transaction_id",label:"Virtual TX ID",getValue:(e,t)=>(null==t?void 0:t.virtual_transaction_id)||(null==e?void 0:e.virtual_transaction_id),requiresEnrichedData:!0},{id:"session_start_time",label:"Session Started",getValue:(e,t)=>{let a=(null==t?void 0:t.session_start_time)||(null==e?void 0:e.session_start_time);return a?new Date(a).toLocaleString():null},requiresEnrichedData:!0}];var aG=a(45866),aK=a(41914),aY=a(62967),a$=a(99846),aQ=a(95043),aJ=a(40395),aX=a(27818),aZ=a(91020),a0=a(24465),a2=a(29012);function a1(e){let{fieldValue:t,filterFields:a,value:s,children:l,className:o,table:i,onKeyDown:d,...c}=e,{copy:u,isCopied:m}=function(){let[e,t]=(0,r.useState)(null);return{text:e,copy:(0,r.useCallback)(async function(e){var a;let{timeout:n,withToast:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{timeout:3e3,withToast:!1};if(!(null==(a=navigator)?void 0:a.clipboard))return console.warn("Clipboard not supported"),!1;try{return await navigator.clipboard.writeText(e),t(e),n&&setTimeout(()=>{t(null)},n),s&&ar.oR.success("Copied to clipboard"),!0}catch(e){return console.warn("Copy failed",e),t(null),!1}},[]),isCopied:null!==e}}(),g=a.find(e=>e.value===t),p=i.getColumn(t.toString());return g&&p?(0,n.jsxs)(ad.rI,{"data-sentry-element":"DropdownMenu","data-sentry-component":"DataTableSheetRowAction","data-sentry-source-file":"DataTableSheetRowAction.tsx",children:[(0,n.jsxs)(ad.ty,{className:(0,w.cn)("rounded-md ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","relative",o),onKeyDown:e=>{"ArrowDown"===e.key&&e.preventDefault(),null==d||d(e)},...c,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"DataTableSheetRowAction.tsx",children:[l,m?(0,n.jsx)("div",{className:"absolute inset-0 bg-background/70 place-content-center",children:"Value copied"}):null]}),(0,n.jsxs)(ad.SQ,{align:"end",side:"bottom",className:"w-40","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"DataTableSheetRowAction.tsx",children:[function(){if(!g)return null;switch(g.type){case"checkbox":return(0,n.jsxs)(ad._2,{onClick:()=>{let e=null==p?void 0:p.getFilterValue(),t=(null==e?void 0:e.includes(s))?e:[...e||[],s];null==p||p.setFilterValue(t)},className:"flex items-center gap-2",children:[(0,n.jsx)(b.A,{size:16}),"Include"]});case"input":return(0,n.jsxs)(ad._2,{onClick:()=>null==p?void 0:p.setFilterValue(s),className:"flex items-center gap-2",children:[(0,n.jsx)(b.A,{size:16}),"Include"]});case"slider":return(0,n.jsxs)(ad.I,{children:[(0,n.jsxs)(ad._2,{onClick:()=>null==p?void 0:p.setFilterValue([0,s]),className:"flex items-center gap-2",children:[(0,n.jsx)(a$.A,{size:16}),"Less or equal than"]}),(0,n.jsxs)(ad._2,{onClick:()=>null==p?void 0:p.setFilterValue([s,5e3]),className:"flex items-center gap-2",children:[(0,n.jsx)(aQ.A,{size:16}),"Greater or equal than"]}),(0,n.jsxs)(ad._2,{onClick:()=>null==p?void 0:p.setFilterValue([s]),className:"flex items-center gap-2",children:[(0,n.jsx)(aJ.A,{size:16}),"Equal to"]})]});case"timerange":let e=new Date(s);return(0,n.jsxs)(ad.I,{children:[(0,n.jsxs)(ad._2,{onClick:()=>null==p?void 0:p.setFilterValue([e]),className:"flex items-center gap-2",children:[(0,n.jsx)(aX.A,{size:16}),"Exact timestamp"]}),(0,n.jsxs)(ad._2,{onClick:()=>{let t=(0,aK.A)(e),a=(0,aY.A)(e);null==p||p.setFilterValue([t,a])},className:"flex items-center gap-2",children:[(0,n.jsx)(aZ.A,{size:16}),"Same hour"]}),(0,n.jsxs)(ad._2,{onClick:()=>{let t=(0,R.default)(e),a=(0,F.default)(e);null==p||p.setFilterValue([t,a])},className:"flex items-center gap-2",children:[(0,n.jsx)(a0.A,{size:16}),"Same day"]})]});default:return null}}(),(0,n.jsx)(ad.mB,{"data-sentry-element":"DropdownMenuSeparator","data-sentry-source-file":"DataTableSheetRowAction.tsx"}),(0,n.jsxs)(ad._2,{onClick:()=>u(String(s),{timeout:1e3}),className:"flex items-center gap-2","data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"DataTableSheetRowAction.tsx",children:[(0,n.jsx)(a2.A,{size:16,"data-sentry-element":"Copy","data-sentry-source-file":"DataTableSheetRowAction.tsx"}),"Copy value"]})]})]}):null}let a4=e=>(t,a)=>{var n,s;return new Map((null==e||null==(s=e[a])||null==(n=s.rows)?void 0:n.map(e=>{let{value:t,total:a}=e;return[t,a]}))||[])},a5=e=>{switch(e){case"success":return"2xx";case"warning":return"4xx";case"error":return"5xx"}},a3=e=>{if(!e)return"success";let t=Number(e);return t>=500?"error":t>=400?"warning":t>=300?"info":t>=200?"success":t>=100?"info":"success"},a6=e=>{let{text:t,maxLength:a=50,className:s="",children:l}=e,[o,i]=(0,r.useState)(!1),d=t.length>a,c=d?t.substring(0,a)+"...":t;return d?(0,n.jsxs)(to.AM,{open:o,onOpenChange:i,"data-sentry-element":"Popover_Shadcn_","data-sentry-component":"TruncatedTextWithPopover","data-sentry-source-file":"TruncatedTextWithPopover.tsx",children:[(0,n.jsx)(to.Wv,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"TruncatedTextWithPopover.tsx",children:(0,n.jsx)("span",{className:"cursor-help ".concat(s),children:l||c})}),(0,n.jsx)(to.hl,{className:"max-w-md p-3 break-words",side:"top","data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"TruncatedTextWithPopover.tsx",children:(0,n.jsx)("div",{className:"text-sm font-mono whitespace-pre-wrap",children:t})})]}):l?(0,n.jsx)(n.Fragment,{children:l}):(0,n.jsx)("span",{className:s,children:t})},a8=e=>{let{config:t,data:a,enrichedData:s,isLoading:r,filterFields:l,table:o}=e,i=t.getValue(a,s),d=null!=i?i:"No value",c=String(d),u=t.requiresEnrichedData&&r&&!i,m=!!l.find(e=>e.value===t.id),g="status"===t.id,p="api_key_role"===t.id,f=t.maxLength||50,x=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("dt",{className:"text-[13.5px] text-foreground-light",children:t.label}),(0,n.jsx)("dd",{className:"text-right",children:u?(0,n.jsx)(ev.E,{className:"h-4 w-24"}):g&&"N/A"!==d?(0,n.jsx)(tX,{value:d,level:a3(d),className:"text-xs"}):p&&"N/A"!==d?(0,n.jsx)(a6,{text:c,maxLength:f,className:"px-2 py-1 text-xs font-mono border border-border rounded bg-surface-100"}):"N/A"!==d?(0,n.jsx)(a6,{text:c,maxLength:f,className:"text-sm font-mono ".concat(m?"text-foreground cursor-pointer hover:underline":"text-foreground")}):(0,n.jsx)("span",{className:"text-sm font-mono ".concat(m?"text-foreground cursor-pointer hover:underline":"text-foreground"," text-foreground-light"),children:d})})]});return m&&!u&&"N/A"!==d?(0,n.jsx)(a1,{fieldValue:t.id,filterFields:l,value:c,table:o,className:"flex justify-between items-center py-1 px-2  rounded hover:bg-accent/50 cursor-pointer w-full hover:bg-surface-400",children:x}):(0,n.jsx)("div",{className:"flex justify-between items-center py-1 px-2","data-sentry-component":"BlockField","data-sentry-source-file":"BlockField.tsx",children:x})};var a9=a(55966);let a7=e=>{let{title:t,fields:a,data:s,enrichedData:l,isLoading:o,filterFields:i,table:d,defaultOpen:c=!1}=e,[u,m]=(0,r.useState)(c);return(0,n.jsx)("div",{className:"border-t border-border","data-sentry-component":"CollapsibleSection","data-sentry-source-file":"CollapsibleSection.tsx",children:(0,n.jsxs)(a9.Nt,{open:u,onOpenChange:m,"data-sentry-element":"Collapsible","data-sentry-source-file":"CollapsibleSection.tsx",children:[(0,n.jsx)(a9.R6,{asChild:!0,"data-sentry-element":"CollapsibleTrigger","data-sentry-source-file":"CollapsibleSection.tsx",children:(0,n.jsx)(B.$,{type:"text",size:"tiny",className:"w-full justify-start py-1 px-2 h-auto text-xs font-medium text-foreground-light hover:text-foreground","data-sentry-element":"Button","data-sentry-source-file":"CollapsibleSection.tsx",children:(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[u?(0,n.jsx)(tY.A,{size:12}):(0,n.jsx)(aQ.A,{size:12}),(0,n.jsx)("span",{children:t})]})})}),(0,n.jsx)(a9.Ke,{className:"transition-all data-[state=closed]:animate-collapsible-up data-[state=open]:animate-collapsible-down pt-1","data-sentry-element":"CollapsibleContent","data-sentry-source-file":"CollapsibleSection.tsx",children:a.map(e=>(0,n.jsx)(a8,{config:e,data:s,enrichedData:l,isLoading:o,filterFields:i,table:d},e.id))})]})})};var ne=a(2119);let nt=e=>{let{label:t,value:a,expandButton:s}=e;return(0,n.jsxs)("div",{className:"flex justify-between items-center py-1 px-2","data-sentry-component":"FieldRow","data-sentry-source-file":"FieldWithSeeMore.tsx",children:[(0,n.jsxs)("dt",{className:"flex items-center gap-2 text-[13.5px] text-foreground-light",children:[(0,n.jsx)("span",{children:t}),s]}),(0,n.jsx)("dd",{className:"text-right",children:a})]})},na=e=>{let{primaryField:t,additionalFields:a,data:s,enrichedData:l,isLoading:o,filterFields:i,table:d,showValueAsBadge:c=!1}=e,[u,m]=(0,r.useState)(!1),g=a.some(e=>e.getValue(s,l)&&"N/A"!==e.getValue(s,l)),p=t.getValue(s,l),f=t.requiresEnrichedData&&o&&!p,x="api_key_role"===t.id,h=()=>f?(0,n.jsx)(ev.E,{className:"h-4 w-24"}):x&&p&&"N/A"!==p?(0,n.jsx)("span",{className:"border border-border rounded px-2 py-1 bg-surface-100 text-xs font-mono text-foreground",children:p}):c&&p&&"N/A"!==p?(0,n.jsx)(ne.E,{variant:"secondary",size:"small",children:p}):(0,n.jsx)("span",{className:"text-sm font-mono text-foreground ".concat("N/A"===p?"text-foreground-light":""),"data-sentry-component":"renderValue","data-sentry-source-file":"FieldWithSeeMore.tsx",children:null!=p?p:"N/A"}),_=g?(0,n.jsx)(a9.R6,{asChild:!0,children:(0,n.jsx)("button",{className:"w-3 h-3 flex items-center justify-center selection:font-mono text-foreground-lighter text-xs hover:text-foreground-light bg-foreground-muted/75 rounded [&[data-state=open]>svg]:rotate-180 hover:bg-foreground-lighter",children:(0,n.jsx)(j.A,{size:10,className:"text-background-surface-400 rotate-45",strokeWidth:3})})}):void 0;return(0,n.jsx)("div",{className:"border-t border-border","data-sentry-component":"FieldWithSeeMore","data-sentry-source-file":"FieldWithSeeMore.tsx",children:g?(0,n.jsxs)(a9.Nt,{open:u,onOpenChange:m,children:[(0,n.jsx)(nt,{label:t.label,value:h(),expandButton:_}),(0,n.jsx)(a9.Ke,{className:"transition-all data-[state=closed]:animate-collapsible-up data-[state=open]:animate-collapsible-down",children:(0,n.jsx)("div",{className:"mt-1",children:a.map(e=>(0,n.jsx)(a8,{config:e,data:s,enrichedData:l,isLoading:o,filterFields:i,table:d},e.id))})})]}):(0,n.jsx)(nt,{label:t.label,value:h()})})};var nn=a(17233),ns=a(58618),nr=a(54642);let nl=e=>{let{icon:t,title:a}=e;return(0,n.jsx)("div",{className:"flex items-center gap-2 bg-surface-300 rounded p-0.5 border justify-center border-foreground-muted","data-sentry-component":"StyledIcon","data-sentry-source-file":"TimelineStep.tsx",children:(0,n.jsx)(t,{className:"w-4 h-4 text-foreground-lighter",strokeWidth:1,"data-sentry-element":"Icon","data-sentry-source-file":"TimelineStep.tsx"})})},no=e=>{let{title:t,status:a,statusText:s,children:r,isLast:l=!1}=e;return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("div",{className:"py-1 bg-surface-100/50 border-r border-t border-l rounded-t px-2",children:(0,n.jsx)("div",{children:(0,n.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:["Request started"===t&&(0,n.jsx)(nl,{icon:nn.A,title:t}),"Network"===t&&(0,n.jsx)(nl,{icon:ns.A,title:t}),"Data API"===t&&(0,n.jsx)(nl,{icon:nr.A,title:t}),"Authentication"===t&&(0,n.jsx)(nl,{icon:t5.Nj,title:t}),"Edge Function"===t&&(0,n.jsx)(nl,{icon:t5.n7,title:t}),"Storage"===t&&(0,n.jsx)(nl,{icon:t5.wc,title:t}),"Postgres"===t&&(0,n.jsx)(nl,{icon:t1.A,title:t}),"Response"===t&&(0,n.jsx)(nl,{icon:nn.A,title:t}),(0,n.jsx)("h3",{className:"text-sm text-foreground tracking-wide",children:t})]}),s&&(0,n.jsx)("span",{className:"text-xs text-foreground-light tracking-wide",children:s}),a&&(0,n.jsx)(tX,{value:a,level:a3(a),className:"text-xs"})]})})}),(0,n.jsx)("div",{className:"border rounded-b border-border",children:(0,n.jsx)("dl",{className:"space-y-0 divide-y px-1 py-1 bg-surface-100/50",children:r})}),!l&&(0,n.jsx)("div",{className:"border-l h-3 ml-5"})]})})},ni=(e,t)=>"Postgres"===e.title&&(null==t?void 0:t.log_type)!=="postgres",nd=e=>{let{title:t}=e;return(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 px-4 text-center","data-sentry-component":"BlockEmptyState","data-sentry-source-file":"Block.tsx",children:[(0,n.jsx)("div",{className:"flex items-center justify-center w-7 h-7 rounded-full bg-surface-300 mb-3",children:(0,n.jsx)(aG.A,{size:16,className:"text-foreground-light",strokeWidth:1.5,"data-sentry-element":"SquareDashedBottomCode","data-sentry-source-file":"Block.tsx"})}),(0,n.jsxs)("div",{className:"text-sm text-foreground-light mb-1",children:["No ",t.toLowerCase()," data available"]}),(0,n.jsx)("div",{className:"text-xs text-foreground-lighter",children:"This service was involved but no details were captured"})]})};function nc(e){let t=(0,r.memo)(function(t){var a,s;let{data:r,enrichedData:l,isLoading:o,isLast:i,filterFields:d,table:c}=t;return(0,n.jsx)(no,{title:e.title,isLast:i,children:ni(e,r)?(0,n.jsx)(nd,{title:e.title}):(0,n.jsxs)(n.Fragment,{children:[null==(a=e.primaryFields)?void 0:a.map(e=>(0,n.jsx)(a8,{config:e,data:r,enrichedData:l,isLoading:o,filterFields:d,table:c},e.id)),null==(s=e.sections)?void 0:s.map((e,t)=>"type"in e&&"fieldWithSeeMore"===e.type?(0,n.jsx)(na,{primaryField:e.primaryField,additionalFields:e.additionalFields,data:r,enrichedData:l,isLoading:o,filterFields:d,table:c,showValueAsBadge:e.showValueAsBadge},t):e.collapsible?(0,n.jsx)(a7,{title:e.title,fields:e.fields,data:r,enrichedData:l,isLoading:o,filterFields:d,table:c},e.title):(0,n.jsx)("div",{children:e.fields.map(e=>(0,n.jsx)(a8,{config:e,data:r,enrichedData:l,isLoading:o,filterFields:d,table:c},e.id))},e.title))]})})});return t.displayName="Block",t}let nu=nc({title:"Authentication",primaryFields:aO}),nm=nc({title:"Data API",primaryFields:aH,sections:[{title:"Response Details",fields:aP,collapsible:!0}]}),ng=nc({title:"Network",primaryFields:aA,sections:[{type:"fieldWithSeeMore",primaryField:{id:"api_key_role",label:"API Key",getValue:(e,t)=>{let a=null==t?void 0:t.api_key_prefix,n=null==t?void 0:t.jwt_key_role,s=null==t?void 0:t.authorization_role;return a?a.includes("publishable")?"publishable":a.includes("secret")?"secret":"unknown":n||s||null},requiresEnrichedData:!0},additionalFields:aL,showValueAsBadge:!0},{type:"fieldWithSeeMore",primaryField:{id:"user_id",label:"User",getValue:(e,t)=>{let a=null==t?void 0:t.user_id;return a?"".concat(a.substring(0,8),"..."):null},requiresEnrichedData:!0},additionalFields:aI},{type:"fieldWithSeeMore",primaryField:{id:"client_country",label:"Location",getValue:(e,t)=>{let a=(null==t?void 0:t.client_country)||(null==t?void 0:t.cf_country),n=null==t?void 0:t.client_city;return a&&n?"".concat(n,", ").concat(a):a||n||null},requiresEnrichedData:!0},additionalFields:aR},{title:"Authorization",fields:aF,collapsible:!0},{title:"Tech Details",fields:aq,collapsible:!0}]}),np=nc({title:"Edge Function",primaryFields:aV,sections:[{title:"Function Details",fields:aM,collapsible:!0}]}),nf=nc({title:"Storage",primaryFields:az,sections:[{title:"Storage Details",fields:aW,collapsible:!0}]}),nx=nc({title:"Postgres",primaryFields:aB,sections:[{title:"Connection & Session Details",fields:aU,collapsible:!0}]});nu.displayName="MemoizedGoTrueBlock",nm.displayName="MemoizedPostgRESTBlock",ng.displayName="MemoizedNetworkBlock",np.displayName="MemoizedEdgeFunctionBlock",nf.displayName="MemoizedStorageBlock",nx.displayName="MemoizedPostgresBlock";let nh=e=>{var t;let{selectedRow:a,enrichedData:s}=e,{table:l,rowSelection:o,isLoading:i}=I(),d=null==a?void 0:a.method,c=null==a?void 0:a.log_type,u=null==a?void 0:a.status,m=(0,r.useMemo)(()=>{let e=(null==s?void 0:s.request_path)||(null==a?void 0:a.pathname);if(e&&"/"!==e)return{text:e,isDefault:!1,isTruncatable:!1};let t=(null==s?void 0:s.event_message)||(null==a?void 0:a.event_message);return t?{text:t,isDefault:!1,isTruncatable:!0}:{text:"/",isDefault:!0,isTruncatable:!1}},[s,a]),g=null==(t=Object.keys(o))?void 0:t[0],p=(0,r.useMemo)(()=>{if(!i||g)return l.getCoreRowModel().flatRows.find(e=>e.id===g)},[g,i,l]),f=l.getCoreRowModel().flatRows.findIndex(e=>e.id===(null==p?void 0:p.id)),x=(0,r.useMemo)(()=>{var e;return null==(e=l.getCoreRowModel().flatRows[f+1])?void 0:e.id},[f,i,l]),h=(0,r.useMemo)(()=>{var e;return null==(e=l.getCoreRowModel().flatRows[f-1])?void 0:e.id},[f,i,l]),_=(0,r.useCallback)(()=>{h&&l.setRowSelection({[h]:!0})},[h,l]),y=(0,r.useCallback)(()=>{x&&l.setRowSelection({[x]:!0})},[x,l]),v=(0,r.useCallback)(()=>{l.resetRowSelection()},[l]);return(0,r.useEffect)(()=>{let e=e=>{if(!g)return;let t=document.activeElement;(null==t?void 0:t.closest('[role="menu"]'))||("ArrowUp"===e.key&&(e.preventDefault(),_()),"ArrowDown"===e.key&&(e.preventDefault(),y()))};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[g,y,_]),(0,n.jsxs)("div",{className:"flex items-center justify-between px-4 py-3","data-sentry-component":"ServiceFlowHeader","data-sentry-source-file":"ServiceFlowHeader.tsx",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3 min-w-0 flex-1 mr-6",children:[c&&(0,n.jsx)(t3,{type:c,size:16,className:"text-foreground/70"}),d&&(0,n.jsx)(ne.E,{variant:"default",className:"font-mono text-xs rounded px-1",children:d}),m.isTruncatable?(0,n.jsx)(a6,{text:m.text,maxLength:60,className:"font-mono text-sm truncate ".concat(m.isDefault?"text-foreground-muted":"text-foreground")}):(0,n.jsx)("span",{className:"font-mono text-sm truncate ".concat(m.isDefault?"text-foreground-muted":"text-foreground"),children:m.text})]}),(0,n.jsxs)("div",{className:"flex h-7 items-center gap-1",children:[u&&(0,n.jsx)(tX,{value:u,level:a3(u),className:"text-xs"}),(0,n.jsx)(ti.G,{size:"tiny",type:"text",disabled:!h,onClick:_,className:"px-1",icon:(0,n.jsx)(tK.A,{}),tooltip:{content:{text:(0,n.jsxs)("p",{children:["Navigate ",(0,n.jsx)(T,{children:"↑"})]})}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"ServiceFlowHeader.tsx"}),(0,n.jsx)(ti.G,{size:"tiny",type:"text",disabled:!x,onClick:y,className:"px-1",icon:(0,n.jsx)(tY.A,{}),tooltip:{content:{text:(0,n.jsxs)("p",{children:["Navigate ",(0,n.jsx)(T,{children:"↓"})]})}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"ServiceFlowHeader.tsx"}),(0,n.jsx)(S.w,{orientation:"vertical",className:"mx-1","data-sentry-element":"Separator","data-sentry-source-file":"ServiceFlowHeader.tsx"}),(0,n.jsx)(B.$,{size:"tiny",type:"text",onClick:v,className:"px-1",icon:(0,n.jsx)(j.A,{}),"data-sentry-element":"Button","data-sentry-source-file":"ServiceFlowHeader.tsx"})]})]})},n_=(0,r.memo)(function(e){let{data:t}=e,a=(null==t?void 0:t.timestamp)||(null==t?void 0:t.date),s=a?new Date(a).toLocaleString():null;return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center justify-between py-0 px-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 text-sm text-foreground-light",children:[(0,n.jsx)(nl,{icon:nn.A,title:"Request started"}),(0,n.jsx)("span",{children:"Request started"})]}),s&&(0,n.jsx)("span",{className:"text-sm font-mono text-foreground-light",children:s})]}),(0,n.jsx)("div",{className:"border-l h-4 ml-5"})]})});n_.displayName="MemoizedRequestStartedBlock";let ny=e=>{let{message:t,severity:a,icon:s=t1.A,serviceType:r="postgres"}=e;return(0,n.jsxs)("div",{className:"mt-3 border-t border-border pt-3","data-sentry-component":"EventMessage","data-sentry-source-file":"EventMessage.tsx",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,n.jsx)(s,{size:14,className:(e=>{switch(e){case"error":return"text-destructive";case"warning":return"text-warning";default:return"text-foreground-light"}})(a),"data-sentry-element":"Icon","data-sentry-source-file":"EventMessage.tsx"}),(0,n.jsxs)("span",{className:"text-xs font-medium text-foreground-light",children:[function(e){return e?({"edge function":"Edge Function",postgrest:"PostgREST",postgres:"Postgres",auth:"Auth",storage:"Storage"})[e.toLowerCase()]||e:""}(r)," Event",a&&(0,n.jsx)(ne.E,{variant:"error"===a?"destructive":"warning"===a?"warning":"default",className:"ml-2 text-xs",children:a.toUpperCase()})]})]}),(0,n.jsx)("div",{className:"p-3 rounded-lg border border-border bg-surface-100",children:(0,n.jsx)("div",{className:"text-xs font-mono break-all whitespace-pre-wrap leading-relaxed max-h-32 overflow-y-auto",children:t})})]})},nv=(0,r.memo)(function(e){let{data:t,enrichedData:a}=e,s="postgres"===((null==a?void 0:a.log_type)||(null==t?void 0:t.log_type)),r=(null==t?void 0:t.status)&&Number(t.status)>=400,l=(null==a?void 0:a.response_time_ms)||(null==a?void 0:a.duration_ms),o=Number(null==t?void 0:t.status),i=(null==a?void 0:a.event_message)||(null==t?void 0:t.event_message),d=null==a?void 0:a.error_severity,c=d&&["error","fatal"].includes(d.toLowerCase());return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center justify-between py-0 px-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 text-sm text-foreground-light",children:[(0,n.jsx)(nl,{icon:nn.A,title:"Response"}),(0,n.jsx)("span",{children:s?"Operation Result":"Response"})]}),s?d&&(0,n.jsx)("span",{className:"text-sm font-mono ".concat(c?"text-destructive":"text-foreground-light"),children:c?"".concat(d.toUpperCase()," Error"):"".concat(d.toUpperCase())}):(null==t?void 0:t.status)&&(0,n.jsx)("span",{className:"text-sm font-mono text-foreground-light",children:r?"".concat(t.status," Error"):"".concat(t.status," Success")})]}),s?(0,n.jsx)("div",{className:"text-xs text-foreground-light px-2 py-1",children:c?"Database operation completed with error":"Database operation completed successfully"}):l&&(0,n.jsx)("div",{className:"text-xs text-foreground-light px-2 py-1",children:r?"Error response sent to client in ".concat(l,"ms"):"Response sent to client in ".concat(l,"ms")}),s?i&&(0,n.jsx)("div",{className:"px-2",children:(0,n.jsx)(ny,{message:i,severity:d})}):r&&(0,n.jsxs)("div",{className:"px-2 py-1 mt-1",children:[(0,n.jsx)("div",{className:"text-xs font-medium text-destructive mb-1",children:"Error Details"}),(0,n.jsx)("div",{className:"text-xs text-foreground-light",children:o>=500?"Server error occurred during request processing":o>=400?"Client error - check request parameters and authentication":"Request completed with error status"})]})]})});function nb(e){var t,a,s,o,i,d,c,u,m,g,p;let{selectedRow:f,selectedRowKey:x,searchParameters:h}=e,{table:_,filterFields:y}=I(),{ref:v}=(0,l.g)(),[b,j]=(0,r.useState)("service-flow"),N=null==f?void 0:f.log_type,E="edge function"===N?"edge-function":N,S=!!E,{data:D,isLoading:T,error:C}=aw({projectRef:v,logId:null==f?void 0:f.id,type:E,search:h},{enabled:!!v&&!!(null==f?void 0:f.id)&&!!E}),k=S&&(null==D||null==(t=D.result)?void 0:t[0])?D.result[0]:f;return x?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(tS.WM,{withHandle:!0,className:"z-10"}),(0,n.jsx)(tS.wV,{id:"log-sidepanel",order:2,defaultSize:1,maxSize:40,className:(0,w.cn)("bg-dash-sidebar","z-40","border-l fixed right-0 top-0 bottom-0","md:absolute md:h-auto","xl:z-[1]","min-w-[28rem] max-w-[45rem]","xl:relative xl:border-l-0"),children:(0,n.jsxs)("div",{className:"h-full overflow-auto",children:[(0,n.jsx)(nh,{selectedRow:f,enrichedData:null==D||null==(a=D.result)?void 0:a[0]}),(0,n.jsx)("div",{className:"relative",children:(0,n.jsxs)(aE.tU,{defaultValue:"service-flow",value:b,onValueChange:j,className:"w-full h-full flex flex-col pt-2",children:[(0,n.jsxs)(aE.j7,{className:"flex gap-3 px-5",children:[S&&(0,n.jsx)(aE.Xi,{value:"service-flow",children:"Overview"}),(0,n.jsx)(aE.Xi,{value:"raw-json",children:"Raw JSON"})]}),S&&(0,n.jsx)(aE.av,{value:"service-flow",children:(0,n.jsx)("div",{className:"p-4",children:C?(0,n.jsxs)("div",{className:"text-center py-8 text-destructive",children:["Error: ",C.toString()]}):(0,n.jsx)(n.Fragment,{children:"postgres"===E?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(n_,{data:f}),(0,n.jsx)(nx,{data:f,enrichedData:null==D||null==(s=D.result)?void 0:s[0],isLoading:T,isLast:!1,filterFields:y,table:_}),(0,n.jsx)(nv,{data:f,enrichedData:null==D||null==(o=D.result)?void 0:o[0]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(n_,{data:f}),(0,n.jsx)(ng,{data:f,enrichedData:null==D||null==(i=D.result)?void 0:i[0],isLoading:T,filterFields:y,table:_}),"auth"===E?(0,n.jsx)(nu,{data:f,enrichedData:null==D||null==(d=D.result)?void 0:d[0],isLoading:T,filterFields:y,table:_}):"edge-function"===E?(0,n.jsx)(np,{data:f,enrichedData:null==D||null==(c=D.result)?void 0:c[0],isLoading:T,filterFields:y,table:_}):"storage"===E?(0,n.jsx)(nf,{data:f,enrichedData:null==D||null==(u=D.result)?void 0:u[0],isLoading:T,filterFields:y,table:_}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(nm,{data:f,enrichedData:null==D||null==(m=D.result)?void 0:m[0],isLoading:T,filterFields:y,table:_}),(0,n.jsx)(nx,{data:f,enrichedData:null==D||null==(g=D.result)?void 0:g[0],isLoading:T,filterFields:y,table:_})]}),(0,n.jsx)(nv,{data:f,enrichedData:null==D||null==(p=D.result)?void 0:p[0]})]})})})}),(0,n.jsxs)(aE.av,{value:"raw-json",className:"flex-grow overflow-auto",children:[T&&S&&(0,n.jsxs)("div",{className:"flex items-center gap-3 text-foreground-light p-3 bg-surface-100 border-b border-border",children:[(0,n.jsx)(ev.E,{className:"h-4 w-4 rounded-full animate-pulse"}),(0,n.jsx)("span",{className:"text-sm",children:"Enriching log..."})]}),(0,n.jsx)(aS.N,{language:"json",className:"max-h-[800px] overflow-auto border-none rounded-none [&_pre]:!leading-tight [&_code]:!leading-tight",children:JSON.stringify(k,null,2)})]})]})})]})})]}):null}nv.displayName="MemoizedResponseCompletedBlock";let nj=e=>{let{level:t}=e;return(0,n.jsxs)("div",{className:"mr-2 flex w-20 items-center justify-between gap-2 font-mono","data-sentry-component":"TooltipLabel","data-sentry-source-file":"TooltipLabel.tsx",children:[(0,n.jsx)("div",{className:"capitalize text-foreground/70",children:t}),(0,n.jsx)("div",{className:"text-xs text-muted-foreground/70",children:a5(t)})]})},nN={success:{label:(0,n.jsx)(nj,{level:"success"}),color:"hsl(var(--foreground-muted))"},warning:{label:(0,n.jsx)(nj,{level:"warning"}),color:"hsl(var(--warning-default))"},error:{label:(0,n.jsx)(nj,{level:"error"}),color:"hsl(var(--destructive-default))"}},nw=["GET","POST","PUT","DELETE","OPTIONS"],nE=(0,c.Cp)({parse(e){let[t,a]=e.split(".");return t||a?{id:t,desc:"desc"===a}:null},serialize:e=>"".concat(e.id,".").concat(e.desc?"desc":"asc")}),nS={level:(0,c.IN)((0,c.M1)(P),","),log_type:(0,c.IN)(c.tU,","),latency:(0,c.IN)(c.GJ,"-"),"timing.dns":(0,c.IN)(c.GJ,"-"),"timing.connection":(0,c.IN)(c.GJ,"-"),"timing.tls":(0,c.IN)(c.GJ,"-"),"timing.ttfb":(0,c.IN)(c.GJ,"-"),"timing.transfer":(0,c.IN)(c.GJ,"-"),status:(0,c.IN)(c.tU,","),regions:(0,c.IN)((0,c.M1)(["ams","fra","gru","hkg","iad","syd"]),","),method:(0,c.IN)((0,c.M1)(nw),","),host:c.tU,pathname:c.tU,date:(0,c.IN)(c.Yd,"-"),sort:nE,size:c.GJ.withDefault(40),start:c.GJ.withDefault(0),direction:(0,c.M1)(["prev","next"]).withDefault("next"),cursor:c.Yd.withDefault(new Date),live:c.cr.withDefault(!1),uuid:c.tU,id:c.tU},nD={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required","00000":"Successful Completion","01000":"Warning","0100C":"Dynamic Result Sets Returned","01008":"Implicit Zero Bit Padding","01003":"Null Value Eliminated In Set Function","01007":"Privilege Not Granted","01006":"Privilege Not Revoked","01004":"String Data Right Truncation","01P01":"Deprecated Feature","02000":"No Data","02001":"No Additional Dynamic Result Sets Returned","03000":"SQL Statement Not Yet Complete","08000":"Connection Exception","08003":"Connection Does Not Exist","08006":"Connection Failure","08001":"SQL Client Unable To Establish SQL Connection","08004":"SQL Server Rejected Establishment Of SQL Connection","08007":"Transaction Resolution Unknown","08P01":"Protocol Violation","09000":"Triggered Action Exception","0A000":"Feature Not Supported","0B000":"Invalid Transaction Initiation","0F000":"Locator Exception","0F001":"Invalid Locator Specification","0L000":"Invalid Grantor","0LP01":"Invalid Grant Operation","0P000":"Invalid Role Specification","0Z000":"Diagnostics Exception","0Z002":"Stacked Diagnostics Accessed Without Active Handler",2e4:"Case Not Found",21e3:"Cardinality Violation",22e3:"Data Exception","2202E":"Array Subscript Error",22021:"Character Not In Repertoire",22008:"Datetime Field Overflow",22012:"Division By Zero",22005:"Error In Assignment","2200B":"Escape Character Conflict",22022:"Indicator Overflow",22015:"Interval Field Overflow","2201E":"Invalid Argument For Logarithm",22014:"Invalid Argument For Ntile Function",22016:"Invalid Argument For Nth Value Function","2201F":"Invalid Argument For Power Function","2201G":"Invalid Argument For Width Bucket Function",22018:"Invalid Character Value For Cast",22007:"Invalid Datetime Format",22019:"Invalid Escape Character","2200D":"Invalid Escape Octet",22025:"Invalid Escape Sequence","22P06":"Nonstandard Use Of Escape Character",22010:"Invalid Indicator Parameter Value",22023:"Invalid Parameter Value","2201B":"Invalid Regular Expression","2201W":"Invalid Row Count In Limit Clause","2201X":"Invalid Row Count In Result Offset Clause",22009:"Invalid Time Zone Displacement Value","2200C":"Invalid Use Of Escape Character","2200G":"Most Specific Type Mismatch",22004:"Null Value Not Allowed",22002:"Null Value No Indicator Parameter",22003:"Numeric Value Out Of Range",22026:"String Data Length Mismatch",22001:"String Data Right Truncation",22011:"Substring Error",22027:"Trim Error",22024:"Unterminated C String","2200F":"Zero Length Character String","22P01":"Floating Point Exception","22P02":"Invalid Text Representation","22P03":"Invalid Binary Representation","22P04":"Bad Copy File Format","22P05":"Untranslatable Character","2200L":"Not An XML Document","2200M":"Invalid XML Document","2200N":"Invalid XML Content","2200S":"Invalid XML Comment","2200T":"Invalid XML Processing Instruction",23e3:"Integrity Constraint Violation",23001:"Restrict Violation",23502:"Not Null Violation",23503:"Foreign Key Violation",23505:"Unique Violation",23514:"Check Violation","23P01":"Exclusion Violation",24e3:"Invalid Cursor State",25e3:"Invalid Transaction State",25001:"Active SQL Transaction",25002:"Branch Transaction Already Active",25008:"Held Cursor Requires Same Isolation Level",25003:"Inappropriate Access Mode For Branch Transaction",25004:"Inappropriate Isolation Level For Branch Transaction",25005:"No Active SQL Transaction For Branch Transaction",25006:"Read Only SQL Transaction",25007:"Schema And Data Statement Mixing Not Supported","25P01":"No Active SQL Transaction","25P02":"In Failed SQL Transaction","25P03":"Idle In Transaction Session Timeout",26e3:"Invalid SQL Statement Name",27e3:"Triggered Data Change Violation",28e3:"Invalid Authorization Specification","28P01":"Invalid Password","2B000":"Dependent Privilege Descriptors Still Exist","2BP01":"Dependent Objects Still Exist","2D000":"Invalid Transaction Termination","2F000":"SQL Routine Exception","2F005":"Function Executed No Return Statement","2F002":"Modifying SQL Data Not Permitted","2F003":"Prohibited SQL Statement Attempted","2F004":"Reading SQL Data Not Permitted",34e3:"Invalid Cursor Name",38e3:"External Routine Exception",38001:"Containing SQL Not Permitted",38002:"Modifying SQL Data Not Permitted",38003:"Prohibited SQL Statement Attempted",38004:"Reading SQL Data Not Permitted",39e3:"External Routine Invocation Exception",39001:"Invalid SQLSTATE Returned",39004:"Null Value Not Allowed","39P01":"Trigger Protocol Violated","39P02":"SRF Protocol Violated","39P03":"Event Trigger Protocol Violated","3B000":"Savepoint Exception","3B001":"Invalid Savepoint Specification","3D000":"Invalid Catalog Name","3F000":"Invalid Schema Name",4e4:"Transaction Rollback",40002:"Transaction Integrity Constraint Violation",40001:"Serialization Failure",40003:"Statement Completion Unknown","40P01":"Deadlock Detected",42e3:"Syntax Error Or Access Rule Violation",42601:"Syntax Error",42501:"Insufficient Privilege",42846:"Cannot Coerce",42803:"Grouping Error","42P20":"Windowing Error","42P19":"Invalid Recursion",42830:"Invalid Foreign Key",42602:"Invalid Name",42622:"Name Too Long",42939:"Reserved Name",42804:"Datatype Mismatch","42P18":"Indeterminate Datatype",42809:"Wrong Object Type","428C9":"Generated Always",42703:"Undefined Column",42883:"Undefined Function","42P01":"Undefined Table","42P02":"Undefined Parameter",42704:"Undefined Object",42701:"Duplicate Column","42P03":"Duplicate Cursor","42P04":"Duplicate Database",42723:"Duplicate Function","42P05":"Duplicate Prepared Statement","42P06":"Duplicate Schema","42P07":"Duplicate Table",42712:"Duplicate Alias",42710:"Duplicate Object",42702:"Ambiguous Column",42725:"Ambiguous Function","42P08":"Ambiguous Parameter","42P09":"Ambiguous Alias","42P10":"Invalid Column Reference",42611:"Invalid Column Definition","42P11":"Invalid Cursor Definition","42P12":"Invalid Database Definition","42P13":"Invalid Function Definition","42P14":"Invalid Prepared Statement Definition","42P15":"Invalid Schema Definition","42P16":"Invalid Table Definition","42P17":"Invalid Object Definition",44e3:"With Check Option Violation",53e3:"Insufficient Resources",53100:"Disk Full",53200:"Out Of Memory",53300:"Too Many Connections",53400:"Configuration Limit Exceeded",54e3:"Program Limit Exceeded",54001:"Statement Too Complex",54011:"Too Many Columns",54023:"Too Many Arguments",55e3:"Object Not In Prerequisite State",55006:"Object In Use","55P02":"Can't Change Runtime Param","55P03":"Lock Not Available","55P04":"Unsafe New Enum Value Usage",57e3:"Operator Intervention",57014:"Query Canceled","57P01":"Admin Shutdown","57P02":"Crash Shutdown","57P03":"Cannot Connect Now","57P04":"Database Dropped",58e3:"System Error",58030:"IO Error","58P01":"Undefined File","58P02":"Duplicate File",F0000:"Config File Error",F0001:"Lock File Exists",HV000:"FDW Error",HV005:"FDW Column Name Not Found",HV002:"FDW Dynamic Parameter Value Needed",HV010:"FDW Function Sequence Error",HV021:"FDW Inconsistent Data",HV024:"FDW Invalid Attribute Value",HV007:"FDW Invalid Column Name",HV008:"FDW Invalid Column Number",HV004:"FDW Invalid Data Type",HV006:"FDW Invalid Data Type Descriptors",HV091:"FDW Invalid Handle",HV00B:"FDW Invalid Option Index",HV00C:"FDW Invalid Option Name",HV00D:"FDW Invalid String Length Or Buffer Length",HV090:"FDW Invalid String Format",HV00A:"FDW Invalid Use Of Null Pointer",HV009:"FDW Too Many Handles",HV014:"FDW Out Of Memory",HV001:"FDW Unsupported Function",P0000:"PL/pgSQL Error",P0001:"Raise Exception",P0002:"No Data Found",P0003:"Too Many Rows",P0004:"Assert Failure",XX000:"Internal Error",XX001:"Data Corrupted",XX002:"Index Corrupted"};a(59450);let nT=[{label:"Time Range",value:"date",type:"timerange",defaultOpen:!0,commandDisabled:!0},{label:"Log Type",value:"log_type",type:"checkbox",defaultOpen:!0,options:["postgres","postgrest","auth","storage","edge function"].map(e=>({label:e,value:e})),component:e=>(0,n.jsx)("div",{className:"flex w-full items-center justify-between gap-2",children:(0,n.jsx)("span",{className:"capitalize text-foreground/70 group-hover:text-accent-foreground text-xs",children:e.label.replace("_"," ")})})},{label:"Status",value:"status",type:"checkbox",defaultOpen:!0,options:[],hasDynamicOptions:!0,component:e=>{if("boolean"==typeof e.value||void 0===e.value)return null;let t=String(e.value),a=nD[t];return(0,n.jsxs)("div",{className:"flex items-center gap-2 w-full min-w-0",children:[(0,n.jsx)("span",{className:"flex-shrink-0 text-foreground",children:t}),a&&(0,n.jsx)("span",{className:"text-[0.7rem] text-foreground-lighter truncate",title:a,children:a})]})}},{label:"Level",value:"level",type:"checkbox",defaultOpen:!0,options:P.map(e=>({label:e,value:e})),component:e=>{let t=e.value;return(0,n.jsxs)("div",{className:"flex w-full max-w-28 items-center justify-between gap-2",children:[(0,n.jsx)("span",{className:"capitalize text-foreground/70 group-hover:text-accent-foreground text-xs",children:e.label}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:(0,w.cn)("h-2.5 w-2.5 rounded-[2px]",_(t).bg)}),(0,n.jsx)("span",{className:"text-xs text-muted-foreground/70",children:a5(t)})]})]})}},{label:"Method",value:"method",type:"checkbox",defaultOpen:!0,options:nw.map(e=>({label:e,value:e})),component:e=>(0,n.jsx)("span",{className:"truncate block text-[0.75rem]",title:e.value,children:e.value})},{label:"Pathname",value:"pathname",type:"checkbox",defaultOpen:!1,options:[],hasDynamicOptions:!0,hasAsyncSearch:!1,component:e=>(0,n.jsx)("span",{className:"truncate block w-full text-[0.75rem]",title:e.value,children:e.value})}],nC=()=>{W(()=>{document.body.setAttribute("tabindex","0"),document.body.focus(),document.body.removeAttribute("tabindex")},".")},nk=e=>{let[t]=(0,c.ZA)("live",nS.live),a=(0,r.useRef)(t?new Date().getTime():void 0);return(0,r.useEffect)(()=>{t?a.current=new Date().getTime():a.current=void 0},[t]),{row:(0,r.useMemo)(()=>{if(t)return e.find(e=>!a.current||!(e.date.getTime()>a.current))},[t,e]),timestamp:a.current}},nA=()=>{var e;nC();let{ref:t}=(0,l.g)(),[a,s]=(0,c.ab)(nS),{sort:o,start:u,size:m,id:g,cursor:p,direction:f,live:_,...y}=a,v=a.id?{[a.id]:!0}:{},b=Object.entries(y).map(e=>{let[t,a]=e;return{id:t,value:a}}).filter(e=>{let{value:t}=e;return null!=t?t:void 0}),[j,E]=(0,r.useState)(0),[D,T]=(0,r.useState)(o?[o]:[]),[C,k]=(0,r.useState)(b),[A,I]=(0,r.useState)(v),[R,F]=(0,N.U)("data-table-visibility",{uuid:!1}),[q,H]=(0,N.U)("data-table-column-order",[]),P=(0,r.useMemo)(()=>Object.entries(a).reduce((e,t)=>{let[a,n]=t;return["id","live"].includes(a)||null==n||(e[a]=n),e},{}),[a]),{data:O,isLoading:M,isFetching:W,isFetchingNextPage:B,isFetchingPreviousPage:U,hasNextPage:G,refetch:K,fetchNextPage:Y,fetchPreviousPage:$}=e9({projectRef:t,search:P}),{data:Q,isLoading:J,isFetching:Z,refetch:et}=tB({projectRef:t,search:P}),{data:ea=[],isFetching:en,refetch:es}=tz({projectRef:t,search:P}),er=()=>{K(),et(),es()},el=W||Z||en,eo=W&&!B&&!U,ei=(0,r.useMemo)(()=>{var e,t;return null!=(t=null==O||null==(e=O.pages)?void 0:e.flatMap(e=>{var t;return null!=(t=e.data)?t:[]}))?t:[]},[null==O?void 0:O.pages]),ed=(0,r.useMemo)(()=>ei.filter((e,t)=>t===ei.findIndex(t=>t.id===e.id)),[ei]),ec=nk(ed),eu=null==Q?void 0:Q.totalRowCount,em=ed.length,eg=null==Q?void 0:Q.facets,ep=null==ed?void 0:ed.length,ef=(0,r.useMemo)(()=>{let e=a.level||["success","warning","error"];return Object.fromEntries(Object.entries(nN).filter(t=>{let[a]=t;return e.includes(a)}))},[a.level]),{columns:ex,columnVisibility:eh}=(0,r.useMemo)(()=>t9(ed),[ed]),e_=(0,i.N4)({data:ed,columns:ex,state:{columnFilters:C,sorting:D,columnVisibility:{...R,...eh},rowSelection:A,columnOrder:q},enableMultiRowSelection:!1,columnResizeMode:"onChange",filterFns:{inDateRange:x,arrSome:h},meta:{getRowClassName:e=>{let t=e.original.timestamp<=(ec.timestamp||-1),a=function(e){switch(e){case"success":default:return"";case"warning":return(0,w.cn)("bg-warning/5 hover:bg-warning/10 data-[state=selected]:bg-warning/20 focus-visible:bg-warning/10","dark:bg-warning/10 dark:hover:bg-warning/20 dark:data-[state=selected]:bg-warning/30 dark:focus-visible:bg-warning/20");case"error":return(0,w.cn)("bg-destructive/5 hover:bg-destructive/10 data-[state=selected]:bg-destructive/20 focus-visible:bg-destructive/10","dark:bg-error/10 dark:hover:bg-destructive/20 dark:data-[state=selected]:bg-destructive/30 dark:focus-visible:bg-destructive/20")}}(e.original.level);return(0,w.cn)(a,t?"opacity-50":"opacity-100","h-[30px]")}},getRowId:e=>e.id,onColumnVisibilityChange:F,onColumnFiltersChange:k,onRowSelectionChange:I,onSortingChange:T,onColumnOrderChange:H,getSortedRowModel:(0,d.h5)(),getCoreRowModel:(0,d.HT)(),getFilteredRowModel:(0,d.hM)(),getFacetedRowModel:(0,d.kQ)(),getFacetedUniqueValues:(0,d.oS)(),getFacetedMinMaxValues:(0,d.tX)()}),ey=null==(e=Object.keys(A))?void 0:e[0],ev=(0,r.useMemo)(()=>{if(!M&&!W||ed.length)return e_.getCoreRowModel().flatRows.find(e=>e.id===ey)},[M,W,ed.length,e_,ey]),eb=(0,r.useMemo)(()=>nT.map(e=>{let t=null==eg?void 0:eg[e.value];if(!t||["log_type","method","level"].includes(e.value))return e;let a=t.rows.map(e=>{let{value:t}=e;return{label:"".concat(t),value:t}});if("slider"===e.type){var n,s;return{...e,min:null!=(n=t.min)?n:e.min,max:null!=(s=t.max)?s:e.max,options:a}}return{...e,options:a}}),[eg]);return(0,r.useEffect)(()=>{s(eb.map(e=>{let t=C.find(t=>t.id===e.value);return t?{id:e.value,value:t.value}:{id:e.value,value:null}}).reduce((e,t)=>(e[t.id]=t.value,e),{}))},[C]),(0,r.useEffect)(()=>{s({sort:(null==D?void 0:D[0])||null})},[D]),(0,r.useEffect)(()=>{var e;if(M||W)return;let t=null==(e=Object.keys(A))?void 0:e[0];t&&!ev?(s({id:null}),I({})):t&&ev?s({id:t}):!t&&a.id&&s({id:null})},[A,ev,M,W]),(0,n.jsx)(L,{table:e_,columns:t7,filterFields:eb,columnFilters:C,sorting:D,rowSelection:A,columnOrder:q,columnVisibility:R,searchParameters:P,enableColumnOrdering:!0,isFetching:W,isLoading:M,isLoadingCounts:J,getFacetedUniqueValues:a4(eg),"data-sentry-element":"DataTableProvider","data-sentry-component":"UnifiedLogs","data-sentry-source-file":"UnifiedLogs.tsx",children:(0,n.jsx)(ee,{topBarHeight:j,"data-sentry-element":"DataTableSideBarLayout","data-sentry-source-file":"UnifiedLogs.tsx",children:(0,n.jsxs)(tS.HK,{direction:"horizontal",autoSaveId:"logs-layout","data-sentry-element":"ResizablePanelGroup","data-sentry-source-file":"UnifiedLogs.tsx",children:[(0,n.jsx)(tT,{dateRangeDisabled:{after:new Date},"data-sentry-element":"FilterSideBar","data-sentry-source-file":"UnifiedLogs.tsx"}),(0,n.jsx)(tS.WM,{withHandle:!0,className:"group-data-[expanded=false]/controls:hidden hidden md:flex","data-sentry-element":"ResizableHandle","data-sentry-source-file":"UnifiedLogs.tsx"}),(0,n.jsxs)(tS.wV,{order:2,id:"panel-right",className:"flex max-w-full flex-1 flex-col overflow-hidden","data-sentry-element":"ResizablePanel","data-sentry-source-file":"UnifiedLogs.tsx",children:[(0,n.jsxs)(z,{setTopBarHeight:E,"data-sentry-element":"DataTableHeaderLayout","data-sentry-source-file":"UnifiedLogs.tsx",children:[(0,n.jsx)(V,{placeholder:"Search logs...",searchParamsParser:nS,"data-sentry-element":"DataTableFilterCommand","data-sentry-source-file":"UnifiedLogs.tsx"}),(0,n.jsx)(tw,{renderActions:()=>[(0,n.jsx)(am,{searchParameters:P}),(0,n.jsx)(tG,{isLoading:el,onRefresh:er}),$?(0,n.jsx)(tA,{fetchPreviousPage:$,searchParamsParser:nS},"live"):null],"data-sentry-element":"DataTableToolbar","data-sentry-source-file":"UnifiedLogs.tsx"}),(0,n.jsx)(tV,{data:ea,className:(0,w.cn)("-mb-2",en&&"opacity-60 transition-opacity duration-150"),columnId:"timestamp",chartConfig:ef,"data-sentry-element":"TimelineChart","data-sentry-source-file":"UnifiedLogs.tsx"})]}),(0,n.jsx)(S.w,{"data-sentry-element":"Separator","data-sentry-source-file":"UnifiedLogs.tsx"}),(0,n.jsxs)(tS.HK,{direction:"horizontal",className:"w-full h-full","data-sentry-element":"ResizablePanelGroup","data-sentry-source-file":"UnifiedLogs.tsx",children:[(0,n.jsx)(tS.wV,{defaultSize:ey?60:100,minSize:30,className:"h-full","data-sentry-element":"ResizablePanel","data-sentry-source-file":"UnifiedLogs.tsx",children:(0,n.jsxs)(tS.HK,{direction:"vertical",className:"h-full","data-sentry-element":"ResizablePanelGroup","data-sentry-source-file":"UnifiedLogs.tsx",children:[(0,n.jsx)(tS.wV,{defaultSize:100,minSize:30,className:(0,w.cn)("bg",eo&&"opacity-60 transition-opacity duration-150"),"data-sentry-element":"ResizablePanel","data-sentry-source-file":"UnifiedLogs.tsx",children:(0,n.jsx)(X,{columns:t7,totalRows:eu,filterRows:em,totalRowsFetched:ep,fetchNextPage:Y,hasNextPage:G,renderLiveRow:e=>{var t,a;return ec.timestamp&&(null==e||null==(t=e.row)?void 0:t.original.id)===(null==ec||null==(a=ec.row)?void 0:a.id)?(0,n.jsx)(tL,{colSpan:t7.length-1}):null},setColumnOrder:H,setColumnVisibility:F,searchParamsParser:nS,"data-sentry-element":"DataTableInfinite","data-sentry-source-file":"UnifiedLogs.tsx"})}),(0,n.jsx)(af,{selectedRow:ev,"data-sentry-element":"LogsListPanel","data-sentry-source-file":"UnifiedLogs.tsx"})]},"main-logs")}),ey&&(0,n.jsx)(nb,{selectedRow:null==ev?void 0:ev.original,selectedRowKey:ey,searchParameters:P})]})]})]})})})};var nL=a(1356),nI=a(37388),nR=a(78098),nF=a(23385),nq=a(63492);let nH=()=>{let e=(0,s.useRouter)(),{ref:t}=(0,l.g)(),{hasLoaded:a}=(0,r.useContext)(l.cq),i=(0,nF.a)(),{isEnabled:d}=(0,o.nW)(),[c]=(0,N.U)(l.rS.LAST_VISITED_LOGS_PAGE,"explorer");return((0,r.useEffect)(()=>{a&&i&&!d&&e.replace("/project/".concat(t,"/logs/").concat(c))},[e,a,i,c,t,d]),(0,r.useEffect)(()=>{e.asPath.includes("/logs")&&(!nq.pe||a)&&(nq.pe&&d?e.asPath!=="/project/".concat(t,"/logs")&&e.asPath.includes("/logs/")&&e.push("/project/".concat(t,"/logs")):e.asPath==="/project/".concat(t,"/logs")&&e.push("/project/".concat(t,"/logs/explorer")))},[d,e,t,a]),d)?(0,n.jsx)(nL.A,{children:(0,n.jsx)(nR.A,{children:(0,n.jsx)(nA,{})})}):(0,n.jsx)(nL.A,{"data-sentry-element":"DefaultLayout","data-sentry-component":"LogPage","data-sentry-source-file":"index.tsx",children:(0,n.jsx)(nI.A,{"data-sentry-element":"LogsLayout","data-sentry-source-file":"index.tsx",children:(0,n.jsx)("div",{})})})};nH.getLayout=e=>e;let nP=nH},76188:(e,t,a)=>{"use strict";a.d(t,{EV:()=>d,NY:()=>u,QW:()=>c,cO:()=>l,ig:()=>m,s3:()=>o,xm:()=>i});var n=a(53434),s=a.n(n),r=a(31808);let l=2;var o=function(e){return e.LAST_10_MINUTES="Last 10 minutes",e.LAST_30_MINUTES="Last 30 minutes",e.LAST_60_MINUTES="Last 60 minutes",e.LAST_3_HOURS="Last 3 hours",e.LAST_24_HOURS="Last 24 hours",e.LAST_7_DAYS="Last 7 days",e.LAST_14_DAYS="Last 14 days",e.LAST_28_DAYS="Last 28 days",e}({});let i=[{text:"Last 10 minutes",calcFrom:()=>s()().subtract(10,"minute").toISOString(),calcTo:()=>s()().toISOString(),availableIn:["free","pro","team","enterprise"]},{text:"Last 30 minutes",calcFrom:()=>s()().subtract(30,"minute").toISOString(),calcTo:()=>s()().toISOString(),availableIn:["free","pro","team","enterprise"]},{text:"Last 60 minutes",calcFrom:()=>s()().subtract(1,"hour").toISOString(),calcTo:()=>s()().toISOString(),default:!0,availableIn:["free","pro","team","enterprise"]},{text:"Last 3 hours",calcFrom:()=>s()().subtract(3,"hour").toISOString(),calcTo:()=>s()().toISOString(),availableIn:["free","pro","team","enterprise"]},{text:"Last 24 hours",calcFrom:()=>s()().subtract(1,"day").toISOString(),calcTo:()=>s()().toISOString(),availableIn:["free","pro","team","enterprise"]},{text:"Last 7 days",calcFrom:()=>s()().subtract(7,"day").toISOString(),calcTo:()=>s()().toISOString(),availableIn:["pro","team","enterprise"]},{text:"Last 14 days",calcFrom:()=>s()().subtract(14,"day").toISOString(),calcTo:()=>s()().toISOString(),availableIn:["team","enterprise"]},{text:"Last 28 days",calcFrom:()=>s()().subtract(28,"day").toISOString(),calcTo:()=>s()().toISOString(),availableIn:["team","enterprise"]}],d={iso_timestamp_start:i[0].calcFrom(),iso_timestamp_end:i[0].calcTo()},c=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(0===e.length)return"";let a=e.map(e=>{let t=e.key.split("."),a=[t[t.length-2],t[t.length-1]].join("."),n=e.key.includes(".")?a:e.key;switch(e.compare){case"matches":return"REGEXP_CONTAINS(".concat(n,", '").concat(e.value,"')");case"is":default:return"".concat(n," = ").concat(e.value);case"!=":return"".concat(n," != ").concat(e.value);case">=":return"".concat(n," >= ").concat(e.value);case"<=":return"".concat(n," <= ").concat(e.value);case">":return"".concat(n," > ").concat(e.value);case"<":return"".concat(n," < ").concat(e.value)}}).filter(Boolean).join(" AND ");return""===a?"":t?"WHERE "+a:"AND "+a},u={[r.N.API]:{title:"API",queries:{totalRequests:{queryType:"logs",sql:e=>"\n        -- reports-api-total-requests\n        select\n          cast(timestamp_trunc(t.timestamp, hour) as datetime) as timestamp,\n          count(t.id) as count\n        FROM edge_logs t\n          cross join unnest(metadata) as m\n          cross join unnest(m.response) as response\n          cross join unnest(m.request) as request\n          cross join unnest(request.headers) as headers\n          ".concat(c(e),"\n        GROUP BY\n          timestamp\n        ORDER BY\n          timestamp ASC")},topRoutes:{queryType:"logs",sql:e=>"\n        -- reports-api-top-routes\n        select\n          request.path as path,\n          request.method as method,\n          request.search as search,\n          response.status_code as status_code,\n          count(t.id) as count\n        from edge_logs t\n          cross join unnest(metadata) as m\n          cross join unnest(m.response) as response\n          cross join unnest(m.request) as request\n          cross join unnest(request.headers) as headers\n          ".concat(c(e),"\n        group by\n          request.path, request.method, request.search, response.status_code\n        order by\n          count desc\n        limit 10\n        ")},errorCounts:{queryType:"logs",sql:e=>"\n        -- reports-api-error-counts\n        select\n          cast(timestamp_trunc(t.timestamp, hour) as datetime) as timestamp,\n          count(t.id) as count\n        FROM edge_logs t\n          cross join unnest(metadata) as m\n          cross join unnest(m.response) as response\n          cross join unnest(m.request) as request\n          cross join unnest(request.headers) as headers\n        WHERE\n          response.status_code >= 400\n        ".concat(c(e,!1),"\n        GROUP BY\n          timestamp\n        ORDER BY\n          timestamp ASC\n        ")},topErrorRoutes:{queryType:"logs",sql:e=>"\n        -- reports-api-top-error-routes\n        select\n          request.path as path,\n          request.method as method,\n          request.search as search,\n          response.status_code as status_code,\n          count(t.id) as count\n        from edge_logs t\n          cross join unnest(metadata) as m\n          cross join unnest(m.response) as response\n          cross join unnest(m.request) as request\n          cross join unnest(request.headers) as headers\n        where\n          response.status_code >= 400\n        ".concat(c(e,!1),"\n        group by\n          request.path, request.method, request.search, response.status_code\n        order by\n          count desc\n        limit 10\n        ")},responseSpeed:{queryType:"logs",sql:e=>"\n        -- reports-api-response-speed\n        select\n          cast(timestamp_trunc(t.timestamp, hour) as datetime) as timestamp,\n          avg(response.origin_time) as avg\n        FROM\n          edge_logs t\n          cross join unnest(metadata) as m\n          cross join unnest(m.response) as response\n          cross join unnest(m.request) as request\n          cross join unnest(request.headers) as headers\n          ".concat(c(e),"\n        GROUP BY\n          timestamp\n        ORDER BY\n          timestamp ASC\n      ")},topSlowRoutes:{queryType:"logs",sql:e=>"\n        -- reports-api-top-slow-routes\n        select\n          request.path as path,\n          request.method as method,\n          request.search as search,\n          response.status_code as status_code,\n          count(t.id) as count,\n          avg(response.origin_time) as avg\n        from edge_logs t\n          cross join unnest(metadata) as m\n          cross join unnest(m.response) as response\n          cross join unnest(m.request) as request\n          cross join unnest(request.headers) as headers\n        ".concat(c(e),"\n        group by\n          request.path, request.method, request.search, response.status_code\n        order by\n          avg desc\n        limit 10\n        ")},networkTraffic:{queryType:"logs",sql:e=>'\n        -- reports-api-network-traffic\n        select\n          cast(timestamp_trunc(t.timestamp, hour) as datetime) as timestamp,\n          coalesce(\n            safe_divide(\n              sum(\n                cast(coalesce(headers.content_length, "0") as int64)\n              ),\n              1000000\n            ),\n            0\n          ) as ingress_mb,\n          coalesce(\n            safe_divide(\n              sum(\n                cast(coalesce(resp_headers.content_length, "0") as int64)\n              ),\n              1000000\n            ),\n            0\n          ) as egress_mb,\n        FROM\n          edge_logs t\n          cross join unnest(metadata) as m\n          cross join unnest(m.response) as response\n          cross join unnest(m.request) as request\n          cross join unnest(request.headers) as headers\n          cross join unnest(response.headers) as resp_headers\n          '.concat(c(e),"\n        GROUP BY\n          timestamp\n        ORDER BY\n          timestamp ASC\n        ")}}},[r.N.AUTH]:{title:"",queries:{}},[r.N.STORAGE]:{title:"Storage",queries:{cacheHitRate:{queryType:"logs",sql:e=>"\n        -- reports-storage-cache-hit-rate\nSELECT\n  timestamp_trunc(timestamp, hour) as timestamp,\n  countif( h.cf_cache_status in ('HIT', 'STALE', 'REVALIDATED', 'UPDATING') ) as hit_count,\n  countif( h.cf_cache_status in ('MISS', 'NONE/UNKNOWN', 'EXPIRED', 'BYPASS', 'DYNAMIC') ) as miss_count\nfrom edge_logs f\n  cross join unnest(f.metadata) as m\n  cross join unnest(m.request) as r\n  cross join unnest(m.response) as res\n  cross join unnest(res.headers) as h\nwhere starts_with(r.path, '/storage/v1/object') and r.method = 'GET'\n  ".concat(c(e,!1),"\ngroup by timestamp\norder by timestamp desc\n")},topCacheMisses:{queryType:"logs",sql:e=>"\n        -- reports-storage-top-cache-misses\nSELECT\n  r.path as path,\n  r.search as search,\n  count(id) as count\nfrom edge_logs f\n  cross join unnest(f.metadata) as m\n  cross join unnest(m.request) as r\n  cross join unnest(m.response) as res\n  cross join unnest(res.headers) as h\nwhere starts_with(r.path, '/storage/v1/object')\n  and r.method = 'GET'\n  and h.cf_cache_status in ('MISS', 'NONE/UNKNOWN', 'EXPIRED', 'BYPASS', 'DYNAMIC')\n  ".concat(c(e,!1),"\ngroup by path, search\norder by count desc\nlimit 12\n    ")}}},[r.N.QUERY_PERFORMANCE]:{title:"Query performance",queries:{mostFrequentlyInvoked:{queryType:"db",sql:function(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return"\n        -- reports-query-performance-most-frequently-invoked\nset search_path to public, extensions;\n\nselect\n    auth.rolname,\n    statements.query,\n    statements.calls,\n    -- -- Postgres 13, 14, 15\n    statements.total_exec_time + statements.total_plan_time as total_time,\n    statements.min_exec_time + statements.min_plan_time as min_time,\n    statements.max_exec_time + statements.max_plan_time as max_time,\n    statements.mean_exec_time + statements.mean_plan_time as mean_time,\n    -- -- Postgres <= 12\n    -- total_time,\n    -- min_time,\n    -- max_time,\n    -- mean_time,\n    statements.rows / statements.calls as avg_rows".concat(n?",\n    case\n      when (lower(statements.query) like 'select%' or lower(statements.query) like 'with pgrst%')\n      then (\n        select json_build_object(\n          'has_suggestion', array_length(index_statements, 1) > 0,\n          'startup_cost_before', startup_cost_before,\n          'startup_cost_after', startup_cost_after,\n          'total_cost_before', total_cost_before,\n          'total_cost_after', total_cost_after,\n          'index_statements', index_statements\n        )\n        from index_advisor(statements.query)\n      )\n      else null\n    end as index_advisor_result":"","\n  from pg_stat_statements as statements\n    inner join pg_authid as auth on statements.userid = auth.oid\n  ").concat(t||"","\n  ").concat(a||"order by statements.calls desc","\n  limit 20")}},mostTimeConsuming:{queryType:"db",sql:function(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return"\n        -- reports-query-performance-most-time-consuming\nset search_path to public, extensions;\n\nselect\n    auth.rolname,\n    statements.query,\n    statements.calls,\n    statements.total_exec_time + statements.total_plan_time as total_time,\n    to_char(((statements.total_exec_time + statements.total_plan_time)/sum(statements.total_exec_time + statements.total_plan_time) OVER()) * 100, 'FM90D0') || '%'  AS prop_total_time".concat(n?",\n    case\n      when (lower(statements.query) like 'select%' or lower(statements.query) like 'with pgrst%')\n      then (\n        select json_build_object(\n          'has_suggestion', array_length(index_statements, 1) > 0,\n          'startup_cost_before', startup_cost_before,\n          'startup_cost_after', startup_cost_after,\n          'total_cost_before', total_cost_before,\n          'total_cost_after', total_cost_after,\n          'index_statements', index_statements\n        )\n        from index_advisor(statements.query)\n      )\n      else null\n    end as index_advisor_result":"","\n  from pg_stat_statements as statements\n    inner join pg_authid as auth on statements.userid = auth.oid\n  ").concat(t||"","\n  ").concat(a||"order by total_time desc","\n  limit 20")}},slowestExecutionTime:{queryType:"db",sql:function(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return"\n        -- reports-query-performance-slowest-execution-time\nset search_path to public, extensions;\n\nselect\n    auth.rolname,\n    statements.query,\n    statements.calls,\n    -- -- Postgres 13, 14, 15\n    statements.total_exec_time + statements.total_plan_time as total_time,\n    statements.min_exec_time + statements.min_plan_time as min_time,\n    statements.max_exec_time + statements.max_plan_time as max_time,\n    statements.mean_exec_time + statements.mean_plan_time as mean_time,\n    -- -- Postgres <= 12\n    -- total_time,\n    -- min_time,\n    -- max_time,\n    -- mean_time,\n    statements.rows / statements.calls as avg_rows".concat(n?",\n    case\n      when (lower(statements.query) like 'select%' or lower(statements.query) like 'with pgrst%')\n      then (\n        select json_build_object(\n          'has_suggestion', array_length(index_statements, 1) > 0,\n          'startup_cost_before', startup_cost_before,\n          'startup_cost_after', startup_cost_after,\n          'total_cost_before', total_cost_before,\n          'total_cost_after', total_cost_after,\n          'index_statements', index_statements\n        )\n        from index_advisor(statements.query)\n      )\n      else null\n    end as index_advisor_result":"","\n  from pg_stat_statements as statements\n    inner join pg_authid as auth on statements.userid = auth.oid\n  ").concat(t||"","\n  ").concat(a||"order by max_time desc","\n  limit 20")}},queryHitRate:{queryType:"db",sql:e=>"-- reports-query-performance-cache-and-index-hit-rate\nselect\n    'index hit rate' as name,\n    (sum(idx_blks_hit)) / nullif(sum(idx_blks_hit + idx_blks_read),0) as ratio\n  from pg_statio_user_indexes\n  union all\n  select\n    'table hit rate' as name,\n    sum(heap_blks_hit) / nullif(sum(heap_blks_hit) + sum(heap_blks_read),0) as ratio\n  from pg_statio_user_tables;"}}},[r.N.DATABASE]:{title:"database",queries:{largeObjects:{queryType:"db",sql:e=>"-- reports-database-large-objects\nSELECT\n        SCHEMA_NAME,\n        relname,\n        table_size\n      FROM\n        (SELECT\n          pg_catalog.pg_namespace.nspname AS SCHEMA_NAME,\n          relname,\n          pg_total_relation_size(pg_catalog.pg_class.oid) AS table_size\n        FROM pg_catalog.pg_class\n        JOIN pg_catalog.pg_namespace ON relnamespace = pg_catalog.pg_namespace.oid\n        ) t\n      WHERE SCHEMA_NAME NOT LIKE 'pg_%'\n      ORDER BY table_size DESC\n      LIMIT 5;"}}}},m=["total_realtime_ingress","total_rest_options_requests","total_auth_ingress","total_auth_get_requests","total_auth_post_requests","total_auth_patch_requests","total_auth_options_requests","total_storage_options_requests","total_storage_patch_requests","total_options_requests"]},95567:(e,t,a)=>{"use strict";a.d(t,{O:()=>N});var n=a(80263),s=a(53434),r=a.n(s),l=a(17233),o=a(25643),i=a(99846),d=a(95043),c=a(53239),u=a(38887),m=a.n(u),g=a(19428),p=a(2119),f=a(28625),x=a(20597),h=a(44053),_=a(52647),y=a(9681),v=a(40022),b=a(51500),j=a(58946);let N=e=>{let{onSubmit:t,helpers:a,value:s,buttonTriggerProps:u,popoverContentProps:N}=e,[w,E]=(0,c.useState)(!1);(0,c.useEffect)(()=>{if(!w){D(s.from?new Date(s.from):null),C(s.to?new Date(s.to):new Date);let e=s.from?new Date(s.from):null,t=s.to?new Date(s.to):null;A({HH:(null==e?void 0:e.getHours().toString().padStart(2,"0"))||"00",mm:(null==e?void 0:e.getMinutes().toString().padStart(2,"0"))||"00",ss:(null==e?void 0:e.getSeconds().toString().padStart(2,"0"))||"00"});let a=new Date,n=a.getHours().toString().padStart(2,"0"),r=a.getMinutes().toString().padStart(2,"0"),l=a.getSeconds().toString().padStart(2,"0");I({HH:(null==t?void 0:t.getHours().toString().padStart(2,"0"))||n,mm:(null==t?void 0:t.getMinutes().toString().padStart(2,"0"))||r,ss:(null==t?void 0:t.getSeconds().toString().padStart(2,"0"))||l})}},[w,s]);let[S,D]=(0,c.useState)(s.from?new Date(s.from):null),[T,C]=(0,c.useState)(s.to?new Date(s.to):new Date),[k,A]=(0,c.useState)({HH:(null==S?void 0:S.getHours().toString())||"00",mm:(null==S?void 0:S.getMinutes().toString())||"00",ss:(null==S?void 0:S.getSeconds().toString())||"00"}),[L,I]=(0,c.useState)({HH:(null==T?void 0:T.getHours().toString())||"23",mm:(null==T?void 0:T.getMinutes().toString())||"59",ss:(null==T?void 0:T.getSeconds().toString())||"59"}),[R,F]=(0,c.useState)(!1),[q,H]=(0,c.useState)(!1);function P(){navigator.clipboard.readText().then(e=>{try{let t=JSON.parse(e);if(!t.from||!t.to)return void console.warn("Invalid date range format in clipboard");let a=new Date(t.from),n=new Date(t.to);if(isNaN(a.getTime())||isNaN(n.getTime()))return void console.warn("Invalid date values in clipboard");D(a),C(n),A({HH:a.getHours().toString(),mm:a.getMinutes().toString(),ss:a.getSeconds().toString()}),I({HH:n.getHours().toString(),mm:n.getMinutes().toString(),ss:n.getSeconds().toString()}),H(!0)}catch(e){console.warn("Failed to parse clipboard content as date range:",e)}}).catch(e=>{console.warn("Failed to read clipboard:",e)})}function O(){if(!S||!T)return;let e=new Date(S),t=new Date(T);e.setHours(+k.HH,+k.mm,+k.ss),t.setHours(+L.HH,+L.mm,+L.ss),(0,_.l)(JSON.stringify({from:e.toISOString(),to:t.toISOString()})),F(!0)}(0,c.useEffect)(()=>{R&&setTimeout(()=>{F(!1)},2e3)},[R]),(0,c.useEffect)(()=>{q&&setTimeout(()=>{H(!1)},2e3)},[q]),(0,c.useEffect)(()=>(w&&(document.addEventListener("paste",P),document.addEventListener("copy",O)),()=>{document.removeEventListener("paste",P),document.removeEventListener("copy",O)}),[w,S,T]);let V=Math.abs(r()(S).diff(r()(T),"days"))>j.VM-1,{plan:M,isLoading:z}=(0,h.c)(),W=e=>{var t;return!(!e||!(null==(t=e.availableIn)?void 0:t.length)||e.availableIn.includes("free")||e.availableIn.includes((null==M?void 0:M.id)||"free")&&!z)};return(0,n.jsxs)(y.AM,{open:w,onOpenChange:E,"data-sentry-element":"Popover_Shadcn_","data-sentry-component":"LogsDatePicker","data-sentry-source-file":"Logs.DatePickers.tsx",children:[(0,n.jsx)(y.Wv,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"Logs.DatePickers.tsx",children:(0,n.jsx)(v.$,{type:"default",icon:(0,n.jsx)(l.A,{size:12}),...u,"data-sentry-element":"Button","data-sentry-source-file":"Logs.DatePickers.tsx",children:s.isHelper?s.text:"".concat(r()(s.from).format("DD MMM, HH:mm")," - ").concat(r()(s.to||new Date).format("DD MMM, HH:mm"))})}),(0,n.jsxs)(y.hl,{className:"flex w-full p-0",side:"bottom",align:"end",portal:!0,...N,"data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"Logs.DatePickers.tsx",children:[(0,n.jsx)(f.z6,{onValueChange:e=>{let n=a.find(t=>t.text===e);t&&n&&t({to:n.calcTo(),from:n.calcFrom(),isHelper:!0,text:n.text}),E(!1)},value:s.isHelper?s.text:"",className:"border-r p-2 flex flex-col gap-px","data-sentry-element":"RadioGroup","data-sentry-source-file":"Logs.DatePickers.tsx",children:a.map(e=>{var t;return(0,n.jsxs)(g.J,{className:(0,b.cn)("[&:has([data-state=checked])]:bg-background-overlay-hover [&:has([data-state=checked])]:text-foreground px-4 py-1.5 text-foreground-light flex items-center gap-2 hover:bg-background-overlay-hover hover:text-foreground transition-all rounded-sm text-xs w-full",{"cursor-not-allowed pointer-events-none opacity-50":e.disabled}),children:[(0,n.jsx)(f.CU,{hidden:!0,value:e.text,disabled:e.disabled,"aria-disabled":e.disabled},e.text),e.text,W(e)?(0,n.jsx)(p.E,{size:"small",variant:"outline",className:"h-5 text-[10px] text-foreground-light capitalize",children:(null==(t=e.availableIn)?void 0:t[0])||""}):null]},e.text)})}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex p-2 gap-2 items-center",children:[(0,n.jsxs)("div",{className:"flex flex-grow *:flex-grow gap-2 font-mono",children:[(0,n.jsx)(x.A,{type:"start",startTime:k,endTime:L,time:k,setTime:A,setStartTime:A,setEndTime:I,startDate:S,endDate:T,"data-sentry-element":"TimeSplitInput","data-sentry-source-file":"Logs.DatePickers.tsx"}),(0,n.jsx)(x.A,{type:"end",startTime:k,endTime:L,time:L,setTime:I,setStartTime:A,setEndTime:I,startDate:S,endDate:T,"data-sentry-element":"TimeSplitInput","data-sentry-source-file":"Logs.DatePickers.tsx"})]}),(0,n.jsx)("div",{className:"flex-shrink",children:(0,n.jsx)(v.$,{icon:(0,n.jsx)(o.A,{size:14}),type:"text",size:"tiny",className:"px-1.5",onClick:()=>{A({HH:"00",mm:"00",ss:"00"}),I({HH:"00",mm:"00",ss:"00"})},"data-sentry-element":"Button","data-sentry-source-file":"Logs.DatePickers.tsx"})})]}),(0,n.jsx)("div",{className:"p-2 border-t",children:(0,n.jsx)(m(),{inline:!0,selectsRange:!0,onChange:e=>{!function(e){let[t,a]=e;D(t),C(a)}(e)},dateFormat:"MMMM d, yyyy h:mm aa",dayClassName:()=>"cursor-pointer",startDate:S,endDate:T,renderCustomHeader:e=>{let{date:t,decreaseMonth:a,increaseMonth:s,prevMonthButtonDisabled:l,nextMonthButtonDisabled:o}=e;return(0,n.jsx)("div",{className:"flex items-center justify-between",children:(0,n.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,n.jsx)(v.$,{onClick:a,disabled:l,icon:(0,n.jsx)(i.A,{size:14,strokeWidth:2}),type:"text",size:"tiny",className:"px-1.5"}),(0,n.jsx)("span",{className:"text-sm text-foreground-light",children:r()(t).format("MMMM YYYY")}),(0,n.jsx)(v.$,{onClick:s,disabled:o,icon:(0,n.jsx)(d.A,{size:14,strokeWidth:2}),type:"text",size:"tiny",className:"px-1.5"})]})})},"data-sentry-element":"DatePicker","data-sentry-source-file":"Logs.DatePickers.tsx"})}),V&&(0,n.jsxs)("div",{className:"text-xs px-3 py-1.5 border-y bg-warning-300 text-warning-foreground border-warning-500 text-warning-600",children:["Large ranges may result in memory errors for ",(0,n.jsx)("br",{})," big projects."]}),(0,n.jsxs)("div",{className:"flex items-center justify-end gap-2 p-2 border-t",children:[S&&T?(0,n.jsx)(v.$,{type:"text",size:"tiny",onClick:O,className:(0,b.cn)({"text-brand-600":R||q}),children:R?"Copied!":q?"Pasted!":"Copy range"}):null,(0,n.jsx)(v.$,{type:"default",onClick:()=>{D(new Date),C(new Date)},"data-sentry-element":"Button","data-sentry-source-file":"Logs.DatePickers.tsx",children:"Today"}),(0,n.jsx)(v.$,{onClick:function(){let e=S||new Date,a=T||new Date,n=new Date(e.setHours(+k.HH,+k.mm,+k.ss)),s=new Date(a.setHours(+L.HH,+L.mm,+L.ss));t({from:n.toISOString(),to:s.toISOString(),isHelper:!1}),E(!1)},"data-sentry-element":"Button","data-sentry-source-file":"Logs.DatePickers.tsx",children:"Apply"})]})]})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[89,726,4280,3730,2981,6110,386,7661,5599,8445,4024,3019,2310,8274,7803,9146,5549,5007,4017,8398,4560,7795,3895,4444,7182,279,3435,2314,7686,8821,2690,1356,5756,8098,7388,6593,636,8792],()=>t(12150)),_N_E=e.O()}]);